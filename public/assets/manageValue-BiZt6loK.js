import{a7 as p,aK as A,av as T,I as Ve,A as r,am as s,b7 as V,r as De,K as Re,bu as ae,b8 as Me,aa as o,a9 as l,u as n,a8 as m,ap as S,aF as ne,aL as v,aG as $,aw as Ue,aS as C,aE as le,bv as oe,aA as se,at as Fe,au as Ke,aR as Le,ai as je,B as Pe,aT as Ge,b9 as He,aU as We,bd as Je,by as Qe,b3 as Xe,ba as Ye,aM as Ze,bE as et,ct as tt,bF as at,a$ as nt,bj as lt}from"./vendor-DM0AKlTY.js";import{_ as ot,B as st,a as it}from"./TableAction.vue_vue_type_script_setup_true_lang-D3KvrId0.js";import{_ as rt}from"./search2-line-D3IeQ0cz.js";import{_ as ct}from"./plus-DuQ3M88b.js";import{I as c}from"./Icon-xQFpegxF.js";import{u as pt}from"./useLocale-dxhRIZfv.js";import{u as ut}from"./useTransition-Dfer0qTM.js";import{c as dt,a as bt,d as mt}from"./index-C5WsbIcI.js";import{u as vt}from"./useAppInject-BpVc4Z3r.js";import{a as ie,b as _t,e as re,_ as gt,h as ft}from"./editEnv.vue_vue_type_script_setup_true_lang-DZ434Tsg.js";import"./clickOutside-DMn9Tffw.js";import"./download-simple-bold-CSMrWrgq.js";import"./question-circle-outlined-BY_ocw0L.js";import"./propTypes-BWpnk_hf.js";import"./more-horiz-vhULLMBK.js";const yt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},ht=T("path",{fill:"currentColor",d:"m7.825 13l4.9 4.9q.3.3.288.7t-.313.7q-.3.275-.7.288t-.7-.288l-6.6-6.6q-.15-.15-.213-.325T4.426 12t.063-.375t.212-.325l6.6-6.6q.275-.275.688-.275t.712.275q.3.3.3.713t-.3.712L7.825 11H19q.425 0 .713.288T20 12t-.288.713T19 13z"},null,-1),kt=[ht];function xt(K,D){return p(),A("svg",yt,[...kt])}const wt={name:"material-symbols-arrow-back-rounded",render:xt},Ct={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Tt=T("path",{fill:"currentColor",d:"m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z"},null,-1),St=[Tt];function $t(K,D){return p(),A("svg",Ct,[...St])}const Bt={name:"material-symbols-chevron-left-rounded",render:$t},zt={key:1,style:{"text-align":"center","font-weight":"600"}},It={style:{"vertical-align":"-5px",padding:"0 2px"}},Ot={style:{"text-align":"center","font-weight":"600"}},At={key:2},Et={class:"table-toolbar-right-icon"},qt={style:{color:"var(--app-primary-color)"}},Nt=Ve({__name:"manageValue",emits:["ok"],setup(K,{expose:D,emit:ce}){const pe=ce,{getIsMobile:u}=vt(),{getLocale:ue}=pt(),{message:b,confirm:L}=dt(),{t}=bt(),j=r("fade-slide");ut(j);const R=r(),P=r(),G=r([]),g=r([]),H=r(!1),B=r(!1),W=r(),de=r([{label:()=>s(V,{style:{color:"var(--app-error-color)"}},{default:()=>t("page.env.table.action.delete.button")}),key:"delete",icon:()=>s(c,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{ye()}}}]),_=De({title:"",show:!1,model:{}}),{show:E,title:M}=Re(_),be=[{type:"selection",key:"selection",width:46},{title:t("page.env.table.title.sort"),key:"sort",align:"center",titleAlign:"center",width:88,sorter:!0,defaultSortOrder:!1,render(e){return s(ae,{size:"small",bordered:!1,style:"font-weight: 600"},{default:()=>e.sort})}},{title:t("page.env.table.title.value"),key:"value",resizable:!0,render(e){return s("span",{style:{fontFamily:"var(--app-font-family-mono)"}},String(e.value||""))}},{title:t("page.env.table.title.remark"),key:"remark",resizable:!0,width:200},{title:t("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:u.value?void 0:"right",renderFilterIcon:()=>s(c,{icon:"ic:round-filter-list",style:"vertical-align: baseline"},{}),render(e){return s(ae,{type:e.enable===1?"success":"error",bordered:!1,style:ue.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?t("common.active"):t("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:t("common.active"),value:1},{label:t("common.inactive"),value:0}],filter(){}}],J=(e,a)=>{switch(e){case"edit":return{icon:"mdi-square-edit-outline",tooltip:t("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:Q.bind(null,a)};case"changeStatus":return{icon:a.enable===1?"tabler-variable-off":"tabler-variable",tooltip:a.enable===1?t("page.env.table.action.disable.button"):t("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:X.bind(null,a)}}},me={title:t("page.env.table.title.action"),key:"action",titleAlign:u.value?"center":"left",width:u.value?68:140,fixed:"right",render(e){const a={edit:{label:t("page.env.table.action.edit"),key:"edit",icon:()=>s(c,{icon:"mdi:square-edit-outline",style:"vertical-align: baseline"},{}),props:{onClick:Q.bind(null,e)}},delete:{label:()=>s(V,{style:{color:"var(--app-error-color)"}},{default:()=>t("page.env.table.action.delete.button")}),key:"delete",icon:()=>s(c,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:ve.bind(null,e)}},changeStatus:{label:e.enable===1?t("page.env.table.action.disable.button"):t("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>s(c,{icon:e.enable===1?"tabler:variable-off":"tabler:variable",style:"vertical-align: baseline"},{}),props:{onClick:X.bind(null,e)}},sort:{label:t("page.env.table.action.sort.title"),key:"sort",icon:()=>s(c,{icon:"mdi:sort",style:"vertical-align: baseline"},{}),children:[{label:t("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>s(c,{icon:"material-symbols:arrow-upward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:z.bind(null,e,"up")}},{label:t("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>s(c,{icon:"material-symbols:arrow-downward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:z.bind(null,e,"down")}},{label:t("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>s(c,{icon:"material-symbols:text-select-move-up-rounded",style:"vertical-align: baseline"},{}),props:{onClick:z.bind(null,e,"top")}},{label:t("page.env.table.action.sort.moveBottom"),key:"sortMoveBottom",icon:()=>s(c,{icon:"material-symbols:text-select-move-down-rounded",style:"vertical-align: baseline"},{}),props:{onClick:z.bind(null,e,"bottom")}},{label:t("page.env.table.action.sort.moveSpecify"),key:"sortMoveSpecify",icon:()=>s(c,{icon:"ic:round-numbers",style:"vertical-align: baseline"},{}),props:{onClick:z.bind(null,e,"specify")}}]},export:{label:t("page.env.table.action.export"),key:"export",icon:()=>s(c,{icon:"mdi:content-copy",style:"vertical-align: baseline"},{}),props:{iconProps:{size:"16"},onClick:_e.bind(null,e)}}};let d;return u.value?d={style:"button",actions:[],dropDownActions:[a.edit,a.changeStatus,a.export,a.sort,a.delete]}:d={style:"button",actions:[J("edit",e),J("changeStatus",e)],dropDownActions:[a.export,a.sort,a.delete]},s(ot,d)}},Q=async e=>{R.value?.open("composite_value",e)},ve=e=>{L.error({title:t("page.env.table.action.delete.title"),content:t("page.env.table.action.delete.confirm"),icon:()=>s(c,{icon:"fe:trash",style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:t("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{await ie({id:e.id}),b.success(t("page.env.table.message.delete.ok"))}catch{b.error(t("page.env.table.message.delete.fail"))}finally{y()}},negativeButtonProps:{ghost:!1,tertiary:!0}})},X=async e=>{try{const a=Object.assign({},e,{enable:e.enable===0?1:0});await _t(a),b.success(e.enable===1?t("page.env.table.message.disable.ok"):t("page.env.table.message.enable.ok"),{duration:1500}),e.enable===0?e.enable=1:e.enable=0}catch{b.error(e.enable===1?t("page.env.table.message.disable.fail"):t("page.env.table.message.enable.fail"))}},z=async(e,a)=>{const{id:d,sort:x}=e;try{let w;switch(a){case"up":w={id:d,order:x+(h.value==="0"?-1:1)};break;case"down":w={id:d,order:x+(h.value==="0"?1:-1)};break;case"top":w=Object.assign({id:d},h.value==="0"?{order:1}:{moveToEnd:!0});break;case"bottom":w=Object.assign({id:d},h.value==="0"?{moveToEnd:!0}:{order:1});break;case"specify":I.value=!0,q.value=d,f.value=x;return;default:return}await re(w),b.success(t("page.env.table.message.sort.ok")),y()}catch{}},_e=async e=>{Me().copy(`export ${_.title}="${e.value}"`).then(()=>{b.success(t("common.copyOk"))}).catch(()=>{b.error(t("common.copyFail"))})},I=r(!1),f=r(null),q=r(null),ge=()=>s(c,{icon:"ic:round-numbers",style:"vertical-align: baseline"},{}),fe=async()=>{try{await re({id:q.value,order:f.value}),b.success(t("page.env.table.message.sort.ok")),y()}catch{}finally{q.value=null,f.value=null}},Y=()=>{I.value=!1,f.value=null,q.value=null},ye=()=>{L.error({title:t("page.env.table.action.delete.batchTitle"),content:t("page.env.table.action.delete.batchConfirm"),icon:()=>s(c,{icon:"fe:trash",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=g.value.map(a=>Number(a));await ie({id:e}),b.success(t("page.env.table.message.delete.ok"))}catch{b.error(t("page.env.table.message.delete.fail"))}finally{y()}},negativeButtonProps:{ghost:!1,tertiary:!0}})},y=()=>{setTimeout(()=>{P.value?.reload()},250),g.value=[]},U=()=>{B.value=!0,y(),B.value=!1},Z=()=>{k.value="",y()},he=e=>{G.value=e.enable},N=r("sort"),h=r("0"),ke=async e=>{switch(e.order){case"ascend":N.value=e.columnKey,h.value="0";break;case"descend":N.value=e.columnKey,h.value="1";break;case!1:N.value="sort",h.value="0";break}y()},k=r(""),xe=async e=>{const a={page:e.page,size:e.size,group_id:_.model.id,search:k.value||"",enable:G.value.join(","),orderBy:N.value,order:h.value};return await ft(a)},we=(e={})=>{const a={id:null,type:"",description:"",tag_list:"",enable:1,separator:"",envs:0};_.model=je(a),Object.assign(_.model,e),_.title=_.model.type||"未知变量名",_.show=!0},O=async e=>{switch(e){case"createValue":R.value?.open("composite_value",null,_.model.id);break;case"backEnvTable":E.value=!1,pe("ok");break;case"showSearchBar":H.value=!0,Pe().then(()=>{W.value?.focus()});break}};return D({open:we}),(e,a)=>{const d=Bt,x=Ge,w=He,Ce=We,Te=ct,F=rt,ee=Je,Se=Qe,te=it,$e=Xe,Be=Ye,ze=Ze,Ie=et,Oe=wt,Ae=tt,Ee=at,qe=nt,Ne=lt;return p(),A(Le,null,[o(Ee,{show:n(E),"onUpdate:show":a[8]||(a[8]=i=>$(E)?E.value=i:null),height:"calc(var(--vh) * 100)",width:"100%",placement:"right",to:"#env-table-drawer-target","trap-focus":!1,"block-scroll":!1,"auto-focus":!1,"mask-closable":!1},{default:l(()=>[o(Ie,{closable:!1,"header-style":"display: none","body-content-style":"padding: 0"},{header:l(()=>[]),default:l(()=>[o(ze,{bordered:!1,style:{height:"100%","background-color":"var(--app-background-color)"},"header-style":{padding:n(u)?"0 10px":"20px 24px 20px 24px"},"content-style":{height:"100%",padding:n(u)?"10px":"0 24px 20px 24px"}},{header:l(()=>[o(Ce,{style:{"align-items":"center"}},{default:l(()=>[n(u)?ne("",!0):(p(),m(n(S),{key:0,strong:"",secondary:"",focusable:!1,style:{padding:"0 8px"},onClick:a[0]||(a[0]=i=>O("backEnvTable"))},{icon:l(()=>[o(x,{size:28},{default:l(()=>[o(d,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})),n(u)?(p(),m(w,{key:2,style:{height:"100%","max-width":"190px"}},{tooltip:l(()=>[T("span",Ot,v(n(M)),1)]),default:l(()=>[T("span",It,v(n(M)),1)]),_:1})):(p(),A("span",zt,v(n(M)),1))]),_:1})]),default:l(()=>[o(n(st),{ref_key:"tableRef",ref:P,"checked-row-keys":n(g),"onUpdate:checkedRowKeys":a[6]||(a[6]=i=>$(g)?g.value=i:null),class:"env-sub-table","table-id":"ENV_SUB","pagination-behavior-on-filter":"first",columns:be,request:xe,"row-key":i=>`${i.id}`,"action-column":me,"onUpdate:filters":he,"onUpdate:sorter":ke},Ue({tableTitle:l(()=>[o(n(le),{wrap:!1},{default:l(()=>[n(u)?(p(),m(n(S),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 6px"},focusable:!1,onClick:a[2]||(a[2]=i=>O("createValue"))},{icon:l(()=>[o(Te)]),_:1})):(p(),m(n(S),{key:0,type:"primary",size:"small",style:{height:"32px"},focusable:!1,onClick:a[1]||(a[1]=i=>O("createValue"))},{default:l(()=>[C(v(n(t)("page.env.table.newValue")),1)]),_:1})),n(u)?(p(),m(ee,{key:3,value:n(k),"onUpdate:value":a[5]||(a[5]=i=>$(k)?k.value=i:null),loading:n(B)||void 0,size:"small",clearable:"",placeholder:n(t)("page.env.table.search.placeholder"),"on-clear":Z,onKeyup:oe(U,["enter"])},{prefix:l(()=>[o(F)]),_:1},8,["value","loading","placeholder"])):(p(),A("div",At,[n(H)?(p(),m(se,{key:1,name:n(j),mode:"default",appear:""},{default:l(()=>[o(Se,{style:{height:"32px"}},{default:l(()=>[o(ee,{ref_key:"searchBarInputRef",ref:W,value:n(k),"onUpdate:value":a[4]||(a[4]=i=>$(k)?k.value=i:null),disabled:n(B),loading:n(B)||void 0,size:"small",clearable:"",placeholder:n(t)("page.env.table.search.placeholder"),"on-clear":Z,onKeyup:oe(U,["enter"])},{prefix:l(()=>[o(F)]),_:1},8,["value","disabled","loading","placeholder"]),o(n(S),{strong:"",secondary:"",type:"primary",size:"small",style:{height:"32px"},onClick:U},{default:l(()=>[C(v(n(t)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(p(),m(n(S),{key:0,strong:"",secondary:"",size:"small",style:{padding:"0 8px",height:"32px"},focusable:!1,onClick:a[3]||(a[3]=i=>O("showSearchBar"))},{icon:l(()=>[o(F)]),_:1}))]))]),_:1})]),toolbar:l(()=>[Fe(o(se,{name:"fade-slide-left",mode:"out-in",appear:""},{default:l(()=>[o(n(le),{wrap:!1},{default:l(()=>[o(Be,{size:"small",trigger:"click",options:n(de)},{default:l(()=>[n(u)?(p(),m($e,{key:1,trigger:"hover"},{trigger:l(()=>[T("div",Et,[o(x,{size:"20"},{default:l(()=>[o(te)]),_:1})])]),default:l(()=>[T("span",null,v(n(t)("page.env.table.action.batchAction")),1)]),_:1})):(p(),m(n(S),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px","border-radius":"10px"},focusable:!1},{icon:l(()=>[o(te)]),default:l(()=>[C(" "+v(n(t)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[Ke,n(g).length]])]),_:2},[n(g).length&&!n(u)?{name:"info",fn:l(()=>[o(n(V),null,{default:l(()=>[C(v(n(t)("common.selected")),1)]),_:1}),C("  "),T("span",qt,v(n(g).length),1),C("  "),o(n(V),null,{default:l(()=>[C(v(n(t)("common.item")),1)]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["header-style","content-style"])]),_:1}),n(u)?(p(),m(Ae,{key:0,left:20,bottom:20,onClick:a[7]||(a[7]=i=>O("backEnvTable"))},{default:l(()=>[o(x,null,{default:l(()=>[o(Oe)]),_:1})]),_:1})):ne("",!0)]),_:1},8,["show"]),o(Ne,{show:n(I),"onUpdate:show":a[10]||(a[10]=i=>$(I)?I.value=i:null),preset:"dialog",style:{width:"360px"},"auto-focus":!1,"mask-closable":!1,icon:ge,title:n(t)("page.env.table.action.sort.moveSpecifyTitle"),"positive-text":n(t)("common.okText"),"negative-text":n(t)("common.cancelText"),"on-close":Y,"positive-button-props":{disabled:!n(f)},"negative-button-props":{ghost:!1,tertiary:!0},onNegativeClick:a[11]||(a[11]=i=>Y()),onPositiveClick:a[12]||(a[12]=i=>fe())},{default:l(()=>[o(qe,{value:n(f),"onUpdate:value":a[9]||(a[9]=i=>$(f)?f.value=i:null),clearable:"",min:1,max:99999,style:{"margin-top":"5px"}},null,8,["value"])]),_:1},8,["show","title","positive-text","negative-text","positive-button-props"]),o(gt,{ref_key:"editEnv",ref:R,onOk:y},null,512)],64)}}}),Xt=mt(Nt,[["__scopeId","data-v-188d4029"]]);export{Xt as default};
