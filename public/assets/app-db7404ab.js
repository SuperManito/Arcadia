import{_ as Ne}from"./app-ccbb8a55.js";import{_ as De,B as Be,a as Ie}from"./app-b5c1cc18.js";import{_ as $e}from"./app-6ee071f1.js";import{_ as Ee}from"./app-9ba543d4.js";import{G as Oe,bx as Re,by as Fe,y as p,at as i,b9 as A,bl as H,aA as w,bm as le,n as K,aL as G,bz as Ue,a6 as m,a7 as v,a8 as o,a9 as s,F as t,aJ as N,aG as oe,an as Le,aS as qe,aI as ie,am as Pe,aq as M,al as O,aT as h,aH as k,bn as se,aj as Ve,ak as He,b2 as Ke,b0 as Ge,bo as Me,bp as je,be as Je,bq as We,aU as Qe,b5 as Xe,bb as Ye,aM as Ze,bu as ea}from"./vendor-f4e37609.js";import{_ as aa}from"./app-6d4bea4d.js";import ta from"./app-e4d05cb1.js";import{d as re,a as ce,c as pe,b as ue,s as na,e as la,g as oa,f as ia}from"./app-e2c5a80a.js";import{I as u}from"./app-89768b9a.js";import{u as sa}from"./app-34fc42c0.js";import{b as ra,d as ca}from"./app-516cf0fd.js";import{u as pa}from"./app-758bfed7.js";import{u as ua}from"./app-32d007d4.js";import"./app-dbd1102e.js";import"./app-e921add8.js";import"./app-3b782c1f.js";import"./app-5b984881.js";import"./app-4688b2b4.js";import"./app-2939b295.js";import"./app-3378d39a.js";import"./vendor-5db0929b.js";const da={key:3},ba={class:"table-toolbar-right-icon"},ma={style:{color:"var(--app-primary-color)"}},Fa=Oe({__name:"index",setup(va){const{getIsMobile:b}=sa(),{t:a}=ra(),{getLocale:j}=ua(),de=j.value==="zh_CN"?Re:Fe,{message:f,confirm:R}=ca(),J=p("fade-slide");pa(J);const d=p("ordinary"),be=p([{type:"ordinary",name:a("page.env.type.ordinary")},{type:"composite",name:a("page.env.type.composite")}]),W=p([]),Q=p(),g=p([]),X=p(!1),S=p(!1),y=p(""),Y=p(),T=p([]),D=p(""),B=p(""),F={padding:"2px",borderRadius:"3px",lineHeight:"1",color:"var(--app-foreground-color)",background:"var(--app-primary-color)"},U=p(),I=p(),me=p([{label:()=>i(A,{style:{color:"var(--app-info-color)"}},{default:()=>a("page.env.table.action.enable.button")}),key:"enable",icon:()=>i(u,{icon:"tabler:variable",color:"var(--app-info-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{ae(!0)}}},{label:a("page.env.table.action.disable.button"),key:"disable",icon:()=>i(u,{icon:"tabler:variable-off",style:"vertical-align: baseline"},{}),props:{onClick:()=>{ae(!1)}}},{label:()=>i(A,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>i(u,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{_e()}}}]),ve=[{type:"selection",key:"selection",width:42},{title:a("page.env.table.title.type"),key:"type",resizable:!0,width:280,render(e){return i(H,{patterns:T.value,highlightStyle:F,text:e.type,style:{fontFamily:"var(--app-font-family-mono)"}})}},{title:a("page.env.table.title.value"),key:"value",resizable:!0,render(e){if(e.envs===void 0)return i(H,{patterns:T.value,highlightStyle:F,text:e.value,style:{fontFamily:"var(--app-font-family-mono)"}});const n=e.envs;return i(w,{strong:!0,secondary:!0,size:"small",focusable:!0,onClick:()=>I.value?.open(e)},{default:()=>a("page.env.table.manageItems",[n])})}},{title:a("page.env.table.title.tag_list"),key:"tag_list",resizable:!0,width:200,render(e){try{const n=e.tag_list;if(!n)return"";const l=JSON.parse(n||"['']");if(!Array.isArray(l))return"";const r=[];if(l.forEach(x=>{const{label:_,color:z}=x;r.push(i(le,{bordered:!1,color:{color:K(z).setAlpha(.12).toHex8String(),borderColor:K(z).toHexString(),textColor:K(z).toHexString()}},{default:()=>_}))}),r.length>0)return i(G,{style:"gap: 4px"},{default:()=>r})}catch{}return""}},{title:a("page.env.table.title.description"),key:"description",resizable:!0,width:200,render(e){return i(H,{patterns:T.value,highlightStyle:F,text:e.description})}},{title:a("page.env.table.title.update_time"),key:"update_time",align:"center",width:170,render(e){return e.update_time?Date.now()-new Date(e.update_time).getTime()<1e3*60*60?Ue(new Date(e.update_time),{addSuffix:!0,locale:de}):e.update_time:a("page.env.table.update_time.never")},sorter:!0,defaultSortOrder:!1},{title:a("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:b.value?void 0:"right",renderFilterIcon:()=>i(u,{icon:"ic:round-filter-list",style:"vertical-align: baseline"},{}),render(e){return i(le,{type:e.enable===1?"success":"error",bordered:!1,style:j.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?a("common.active"):a("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:a("common.active"),value:1},{label:a("common.inactive"),value:0}],filter(){}}];function $(e,n){switch(e){case"edit":return{icon:"mdi-square-edit-outline",tooltip:a("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:Z.bind(null,n)};case"changeStatus":return{icon:n.enable===1?"tabler-variable-off":"tabler-variable",tooltip:n.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:ee.bind(null,n)};case"manage":return{icon:"mdi-database-cog-outline",tooltip:a("page.env.table.action.manage"),quaternary:!0,focusable:!1,onClick:()=>I.value?.open(n)}}}const fe={title:a("page.env.table.title.action"),key:"action",titleAlign:b.value?"center":"left",width:b.value?68:140,fixed:"right",render(e){const n=d.value==="composite",l={edit:{label:a("page.env.table.action.edit"),key:"edit",icon:()=>i(u,{icon:"mdi:square-edit-outline",style:"vertical-align: baseline"},{}),props:{onClick:Z.bind(null,e)}},delete:{label:()=>i(A,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>i(u,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:ge.bind(null,e)}},changeStatus:{label:e.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>i(u,{icon:e.enable===1?"tabler:variable-off":"tabler:variable",style:"vertical-align: baseline"},{}),props:{onClick:ee.bind(null,e)}},manage:{label:a("page.env.table.action.manage"),key:"manage",icon:()=>i(u,{icon:"mdi:database-cog-outline",style:"vertical-align: baseline"},{}),props:{onClick:()=>I.value?.open(e)}},sort:{label:a("page.env.table.action.sort.title"),key:"sort",icon:()=>i(u,{icon:"mdi:sort",style:"vertical-align: baseline"},{}),children:[{label:a("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>i(u,{icon:"material-symbols:arrow-upward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:L.bind(null,e,"up")}},{label:a("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>i(u,{icon:"material-symbols:arrow-downward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:L.bind(null,e,"down")}},{label:a("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>i(u,{icon:"material-symbols:text-select-move-up-rounded",style:"vertical-align: baseline"},{}),props:{onClick:L.bind(null,e,"top")}}]},export:{label:a("page.env.table.action.export"),key:"export",icon:()=>i(u,{icon:"mdi:content-copy",style:"vertical-align: baseline"},{}),props:{iconProps:{size:"16"},onClick:ye.bind(null,e)}}};let r;return n?b.value?r={style:"button",actions:[],dropDownActions:[l.edit,l.manage,l.changeStatus,l.sort,l.delete]}:r={style:"button",actions:[$("edit",e),$("manage",e)],dropDownActions:[l.changeStatus,l.sort,l.delete]}:b.value?r={style:"button",actions:[],dropDownActions:[l.edit,l.changeStatus,l.export,l.sort,l.delete]}:r={style:"button",actions:[$("edit",e),$("changeStatus",e)],dropDownActions:[l.export,l.sort,l.delete]},i(De,r)}};async function Z(e){U.value?.open(d.value,e)}function ge(e){R.error({title:a("page.env.table.action.delete.title"),content:a("page.env.table.action.delete.confirm"),icon:()=>i(u,{icon:"fe:trash",style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{d.value==="composite"?await re({id:e.id}):await ce({id:e.id}),f.success(a("page.env.table.message.delete.ok"))}catch{f.error(a("page.env.table.message.delete.fail"))}finally{C()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}async function ee(e){try{const n={id:e.id,enable:e.enable===0?1:0};d.value==="composite"?await pe(n):await ue(n),f.success(e.enable===1?a("page.env.table.message.disable.ok"):a("page.env.table.message.enable.ok"),{duration:1500}),e.enable=e.enable===0?1:0}catch{f.error(e.enable===1?a("page.env.table.message.disable.fail"):a("page.env.table.message.enable.fail"))}}async function ye(e){f.info(`export ${e.type}="${e.value}"`,{keepAliveOnHover:!0,duration:3e3})}async function L(e,n){const l=d.value==="composite",{id:r,sort:x}=e;try{let _;switch(n){case"up":_={id:r,order:x+1};break;case"down":_={id:r,order:x-1};break;case"top":_={id:r,moveToEnd:!0};break;default:return}l?await na(_):await la(_),f.success(a("page.env.table.message.sort.ok")),C()}catch{}}function _e(){R.error({title:a("page.env.table.action.delete.batchTitle"),content:a("page.env.table.action.delete.batchConfirm"),icon:()=>i(u,{icon:"fe:trash",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=g.value.map(l=>Number(l));d.value==="composite"?await re({id:e}):await ce({id:e}),f.success(a("page.env.table.message.delete.ok"))}catch{f.error(a("page.env.table.message.delete.fail"))}finally{C()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function ae(e){R.info({title:a(`page.env.table.action.${e?"enable":"disable"}.batchTitle`),content:a(`page.env.table.action.${e?"enable":"disable"}.batchConfirm`),icon:()=>i(u,{icon:e?"tabler:variable":"tabler:variable-off",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{d.value==="composite"?await pe({id:g.value.map(l=>Number(l)),enable:e?1:0}):await ue({id:g.value.map(l=>Number(l)),enable:e?1:0}),f.success(a(`page.env.table.message.${e?"enable":"disable"}.ok`))}catch{f.error(a(`page.env.table.message.${e?"enable":"disable"}.fail`))}finally{C()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function C(){setTimeout(()=>{Q.value?.reload()},250),g.value=[]}function q(){S.value=!0,C(),S.value=!1}function E(){y.value="",T.value=[],C()}function he(e){W.value=e.enable}async function ke(e){switch(e.order){case"ascend":D.value=e.columnKey,B.value="0";break;case"descend":D.value=e.columnKey,B.value="1";break;case!1:D.value="",B.value="";break}C()}async function Ce(e){const n=d.value==="composite";let l;const r={page:e.page,size:e.size,search:y.value||"",enable:W.value.join(","),orderBy:D.value,order:B.value};return n?l=await oa(r):l=await ia(r),y.value&&(T.value=[String(y.value)]),l}async function P(e){switch(e){case"createEnv":U.value?.open(d.value);break;case"showSearchBar":X.value=!0,Ke().then(()=>{Y.value?.focus()});break}}return(e,n)=>{const l=ea,r=Ge,x=Ee,_=Me,z=je,V=$e,te=Je,xe=We,ne=Ie,we=Qe,Se=Xe,Te=Ye,ze=Ze,Ae=Ne;return m(),v(Ae,{"content-full":"","no-header":""},{default:o(()=>[s(ze,{id:"env-table-drawer-target",bordered:!t(b),style:{height:"100%"},"header-style":t(b)?{padding:"0 10px"}:{},"content-style":{padding:t(b)?"6px 10px 10px 10px":"12px 18px"}},{header:o(()=>[t(b)?(m(),v(r,{key:0,value:t(d),"onUpdate:value":[n[0]||(n[0]=c=>N(d)?d.value=c:null),E],type:"segment",size:"small",animated:""},{default:o(()=>[(m(!0),oe(qe,null,Le(t(be),c=>(m(),v(l,{key:c.type,name:c.type},{default:o(()=>[h(k(c.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["value"])):ie("",!0)]),default:o(()=>[s(t(Be),{ref_key:"tableRef",ref:Q,"checked-row-keys":t(g),"onUpdate:checkedRowKeys":n[7]||(n[7]=c=>N(g)?g.value=c:null),"table-id":"ENV","pagination-behavior-on-filter":"first",columns:ve,request:Ce,"row-key":c=>`${c.id}`,"action-column":fe,"onUpdate:filters":he,"onUpdate:sorter":ke},Pe({tableTitle:o(()=>[s(t(G),{wrap:!1},{default:o(()=>[t(b)?(m(),v(t(w),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 5px"},focusable:!1,onClick:n[2]||(n[2]=c=>P("createEnv"))},{icon:o(()=>[s(x)]),_:1})):(m(),v(t(w),{key:0,type:"primary",focusable:!1,onClick:n[1]||(n[1]=c=>P("createEnv"))},{default:o(()=>[h(k(t(a)("page.env.table.new")),1)]),_:1})),t(b)?ie("",!0):(m(),v(z,{key:2,value:t(d),"onUpdate:value":n[3]||(n[3]=c=>N(d)?d.value=c:null),variant:"default-filled",onChange:E},{default:o(()=>[s(_,{value:"ordinary",style:{height:"30px"}},{default:o(()=>[h(k(t(a)("page.env.type.ordinary")),1)]),_:1}),s(_,{value:"composite",style:{height:"30px"}},{default:o(()=>[h(k(t(a)("page.env.type.composite")),1)]),_:1})]),_:1},8,["value"])),t(b)?(m(),v(te,{key:4,value:t(y),"onUpdate:value":n[6]||(n[6]=c=>N(y)?y.value=c:null),loading:t(S)||void 0,size:"small",clearable:"",placeholder:t(a)("page.env.table.search.placeholder"),onClear:E,onKeyup:se(q,["enter"])},{prefix:o(()=>[s(V)]),_:1},8,["value","loading","placeholder"])):(m(),oe("div",da,[t(X)?(m(),v(M,{key:1,name:t(J),mode:"default",appear:""},{default:o(()=>[s(xe,null,{default:o(()=>[s(te,{ref_key:"searchBarInputRef",ref:Y,value:t(y),"onUpdate:value":n[5]||(n[5]=c=>N(y)?y.value=c:null),disabled:t(S),loading:t(S)||void 0,clearable:"",placeholder:t(a)("page.env.table.search.placeholder"),onClear:E,onKeyup:se(q,["enter"])},{prefix:o(()=>[s(V)]),_:1},8,["value","disabled","loading","placeholder"]),s(t(w),{strong:"",secondary:"",type:"primary",onClick:q},{default:o(()=>[h(k(t(a)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(m(),v(t(w),{key:0,strong:"",secondary:"",style:{padding:"0 8px"},focusable:!1,onClick:n[4]||(n[4]=c=>P("showSearchBar"))},{icon:o(()=>[s(V)]),_:1}))]))]),_:1})]),toolbar:o(()=>[Ve(s(M,{name:"fade-slide-left",mode:"out-in",appear:""},{default:o(()=>[s(t(G),{wrap:!1},{default:o(()=>[s(Te,{size:"small",trigger:"click",options:t(me)},{default:o(()=>[t(b)?(m(),v(Se,{key:1,trigger:"hover"},{trigger:o(()=>[O("div",ba,[s(we,{size:"20"},{default:o(()=>[s(ne)]),_:1})])]),default:o(()=>[O("span",null,k(t(a)("page.env.table.action.batchAction")),1)]),_:1})):(m(),v(t(w),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px"},focusable:!1},{icon:o(()=>[s(ne)]),default:o(()=>[h(" "+k(t(a)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[He,t(g).length]])]),_:2},[t(g).length&&!t(b)?{name:"info",fn:o(()=>[s(M,{name:"fade",mode:"out-in",appear:""},{default:o(()=>[O("div",null,[s(t(A),null,{default:o(()=>[h(k(t(a)("common.selected")),1)]),_:1}),n[8]||(n[8]=h("  ")),O("span",ma,k(t(g).length),1),n[9]||(n[9]=h("  ")),s(t(A),null,{default:o(()=>[h(k(t(a)("common.item")),1)]),_:1})])]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["bordered","header-style","content-style"]),s(aa,{ref_key:"editEnv",ref:U,onOk:C},null,512),s(ta,{ref_key:"manageValue",ref:I,onOk:C},null,512)]),_:1})}}});export{Fa as default};
