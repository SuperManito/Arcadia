import{_ as fe}from"./plus-DuQ3M88b.js";import{a7 as s,aK as S,av as q,I as be,A as oe,r as ye,K as he,u as e,a8 as r,a9 as t,aa as a,aF as P,aS as c,aL as v,ax as se,aR as ue,aG as U,ai as ke,aT as we,bd as xe,bn as $e,bz as Ce,a_ as Me,bA as ze,bB as Ee,ap as Ue,cF as Ie,by as Te,aE as Le,bb as Be,bo as Ve,aM as Ae,bj as Pe,b9 as Se,aU as Oe,bE as Re,bF as Ne,n as D,bu as Fe}from"./vendor-DM0AKlTY.js";import{Z as w,c as je,h as qe,a as Ge,af as re}from"./index-C5WsbIcI.js";import{u as He}from"./useAppInject-BpVc4Z3r.js";const De={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Je=q("path",{fill:"currentColor",d:"M17 14h2v3h3v2h-3v3h-2v-3h-3v-2h3zm-6 2L2 9l9-7l9 7zm0 2.54l1-.79V18c0 .71.12 1.39.35 2L11 21.07l-9-7l1.62-1.26z"},null,-1),Ke=[Je];function Ze(p,i){return s(),S("svg",De,[...Ke])}const Qe={name:"mdi-layers-plus",render:Ze},We={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Xe=q("path",{fill:"currentColor",d:"M4.63 10.27L3 9l9-7l7.94 6.17l-7.44 7.44l-.5.39zM10 18.94v-.83l.59-.58l.04-.03l-6.01-4.69L3 14.07l7 5.43zm11.7-6.36l-1.28-1.28a.55.55 0 0 0-.77 0l-1 1l2.05 2.05l1-1a.55.55 0 0 0 0-.77M12 21h2.06l6.05-6.07l-2.05-2.05L12 18.94z"},null,-1),Ye=[Xe];function et(p,i){return s(),S("svg",We,[...Ye])}const tt={name:"mdi-layers-edit",render:et},rt=({page:p,size:i,search:I="",enable:T="",orderBy:x="",order:b=""},L="message")=>w.get({url:`/env/pageItem?page=${p}&size=${i}&group_id=0&search=${I}&enable=${T}&orderBy=${x}&order=${b}`},{errorMessageMode:L}),it=({page:p,size:i,search:I="",enable:T="",orderBy:x="",order:b=""},L="message")=>w.get({url:`/env/page?page=${p}&size=${i}&search=${I}&enable=${T}&orderBy=${x}&order=${b}`},{errorMessageMode:L}),pt=({page:p,size:i,group_id:I,search:T="",enable:x="",orderBy:b="",order:L=""},o="message")=>w.get({url:`/env/pageItem?page=${p}&size=${i}&group_id=${I}&search=${T}&enable=${x}&orderBy=${b}&order=${L}`},{errorMessageMode:o}),ie=(p,i="message")=>w.post({url:"/env/save",data:p},{errorMessageMode:i}),pe=(p,i="message")=>w.post({url:"/env/saveItem",data:p},{errorMessageMode:i}),dt=(p,i="message")=>w.delete({url:"/env/delete",data:p},{errorMessageMode:i}),mt=(p,i="message")=>w.delete({url:"/env/deleteItem",data:p},{errorMessageMode:i}),_t=(p,i="message")=>w.put({url:"/env/order",data:p},{errorMessageMode:i}),vt=(p,i="message")=>w.put({url:"/env/orderItem",data:p},{errorMessageMode:i}),lt={style:{"vertical-align":"-5px",padding:"0 2px"}},gt=be({__name:"editEnv",emits:["ok"],setup(p,{expose:i,emit:I}){const T=I,{getIsMobile:x}=He(),{message:b}=je(),{getThemeColor:L}=qe(),{t:o}=Ge(),y=oe([]),G=oe(null),f=ye({title:"",type:"ordinary",show:!1,model:{},rules:{type:{required:!0,message:o("page.env.table.form.message.no_type"),trigger:["input","blur"]},enable:{required:!0},separator:{required:!1},value:{message:o("page.env.table.form.message.no_value"),trigger:["input","blur"]}},tagLabel:"",tagColor:L.value,showAddTagPopover:!1,isCompositeEnvValue:!1}),{title:H,type:B,show:$,model:u,rules:J,tagLabel:h,tagColor:C,showAddTagPopover:k,isCompositeEnvValue:V}=he(f),N={onkeydown(m){if(m.key==="Enter")return b.warning(o("page.env.table.form.message.no_enter")),!1}},K=()=>new Promise(m=>{G.value?.validate(async l=>{if(!l)try{const _=f.model,M=f.type==="composite",z=f.type==="composite_value";_.id||delete _.id,M&&delete _.envs,z?_.tag_list="":_.tag_list=y.value.length>0?JSON.stringify(y.value):"",_.id?(M?await ie(_):await pe(_),b.success(o("page.env.table.message.edit.ok"))):(M?await ie(_):await pe(_),b.success(o("page.env.table.message.new.ok"))),T("ok"),m(!0),x&&($.value=!1)}catch(_){throw new Error(_)}m(!1)}).catch(()=>{})}),Z=()=>{if(!h.value||!C.value){b.warning(o("page.env.editEnv.needInputTagContentMsg"));return}if(y.value.length>0){for(const m of y.value)if(m.label===h.value){b.warning(o("page.env.editEnv.tagExistedMsg"));return}}y.value.push({label:h.value,color:C.value}),h.value="",k.value=!1},Q=m=>{y.value.splice(m,1)},W=m=>({color:D(m).setAlpha(.12).toHex8String(),borderColor:D(m).toHexString(),textColor:D(m).toHexString()});return i({open:(m,l={},_=0)=>{const M=m==="composite";V.value=m==="composite_value",V.value?f.title=o(`page.env.table.${l?.id?"editValue":"newValue"}`):f.title=o(`page.env.table.${l?.id?"edit":"new"}`);const z=Object.assign({id:null,type:"",description:"",tag_list:"",enable:1},M?{separator:"",envs:0}:{group_id:m==="composite_value"?_:0,remark:"",value:"",sort:0});f.model=ke(z),Object.assign(f.model,l);try{y.value=[];const g=JSON.parse(f.model.tag_list||"['']");Array.isArray(g)&&g.forEach(d=>{!d.label||!d.color||y.value.push(d)})}catch{f.model.tag_list=""}f.type=m,f.show=!0}}),(m,l)=>{const _=tt,M=Qe,z=we,g=xe,d=$e,E=Ce,F=Me,j=ze,X=Ee,Y=Fe,ee=fe,A=Ue,te=Ie,le=Te,O=Le,ae=Be,ne=Ve,de=Ae,me=Pe,_e=Se,ve=Oe,ge=Re,ce=Ne;return e(x)?(s(),r(ce,{key:1,show:e($),"onUpdate:show":l[24]||(l[24]=n=>U($)?$.value=n:null),height:"calc(var(--vh) * 100)",width:"100vw",placement:"right","auto-focus":!1,"mask-closable":!1},{default:t(()=>[a(ge,{closable:"","header-style":"height: 60px; padding: 16px 12px","body-content-style":"padding: 4px 12px","footer-style":"padding: 16px 24px"},{header:t(()=>[a(ve,{style:{gap:"4px"}},{default:t(()=>[a(z,{size:26,color:"var(--app-primary-color)"},{default:t(()=>[e(u).id?(s(),r(_,{key:0,style:{"vertical-align":"0"}})):(s(),r(M,{key:1,style:{"vertical-align":"0"}}))]),_:1}),a(_e,{style:{height:"100%","max-width":"260px"}},{tooltip:t(()=>[q("span",null,v(e(H)),1)]),default:t(()=>[q("span",lt,v(e(H)),1)]),_:1})]),_:1})]),footer:t(()=>[a(O,null,{default:t(()=>[a(A,{tertiary:"",focusable:!1,onClick:l[23]||(l[23]=n=>$.value=!1)},{default:t(()=>[c(v(e(o)("common.cancelText")),1)]),_:1}),a(A,{type:"primary",focusable:!1,onClick:K},{default:t(()=>[c(v(e(o)("common.okText")),1)]),_:1})]),_:1})]),default:t(()=>[a(ne,{ref_key:"formRef",ref:G,model:e(u),rules:e(J),style:{"padding-top":"1em"}},{default:t(()=>[e(V)?P("",!0):(s(),r(d,{key:0,label:e(o)("page.env.table.title.type"),path:"type"},{default:t(()=>[a(g,{value:e(u).type,"onUpdate:value":l[12]||(l[12]=n=>e(u).type=n),maxlength:"200",clearable:""},null,8,["value"])]),_:1},8,["label"])),e(B)==="composite"?(s(),r(X,{key:1,"x-gap":"12",cols:3},{default:t(()=>[a(j,{span:2},{default:t(()=>[a(d,{label:e(o)("page.env.table.title.enable"),path:"enable"},{default:t(()=>[a(F,{value:e(u).enable,"onUpdate:value":l[13]||(l[13]=n=>e(u).enable=n),animated:"",type:"segment",size:"small",style:{height:"34px"}},{default:t(()=>[(s(),r(E,{key:1,name:1},{default:t(()=>[c(v(e(o)("common.active")),1)]),_:1})),(s(),r(E,{key:0,name:0},{default:t(()=>[c(v(e(o)("common.inactive")),1)]),_:1}))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),a(j,{span:1},{default:t(()=>[a(d,{label:e(o)("page.env.table.title.separator"),path:"separator"},{default:t(()=>[a(g,{value:e(u).separator,"onUpdate:value":l[14]||(l[14]=n=>e(u).separator=n),placeholder:e(o)("page.env.table.none"),style:{width:"100%"},"input-props":N},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})):(s(),r(d,{key:2,label:e(o)("page.env.table.title.enable"),path:"enable"},{default:t(()=>[a(F,{value:e(u).enable,"onUpdate:value":l[15]||(l[15]=n=>e(u).enable=n),animated:"",type:"segment",size:"small",style:{height:"34px"}},{default:t(()=>[(s(),r(E,{key:1,name:1},{default:t(()=>[c(v(e(o)("common.active")),1)]),_:1})),(s(),r(E,{key:0,name:0},{default:t(()=>[c(v(e(o)("common.inactive")),1)]),_:1}))]),_:1},8,["value"])]),_:1},8,["label"])),e(B)!=="composite"?(s(),r(d,{key:3,label:e(o)("page.env.table.title.value"),path:"value"},{default:t(()=>[a(g,{value:e(u).value,"onUpdate:value":l[16]||(l[16]=n=>e(u).value=n),type:"textarea","input-props":N},null,8,["value"])]),_:1},8,["label"])):P("",!0),e(V)?(s(),r(d,{key:5,label:e(o)("page.env.table.title.remark"),path:"remark"},{default:t(()=>[a(g,{value:e(u).remark,"onUpdate:value":l[18]||(l[18]=n=>e(u).remark=n)},null,8,["value"])]),_:1},8,["label"])):(s(),r(d,{key:4,label:e(o)("page.env.table.title.description"),path:"description"},{default:t(()=>[a(g,{value:e(u).description,"onUpdate:value":l[17]||(l[17]=n=>e(u).description=n)},null,8,["value"])]),_:1},8,["label"])),e(B)!=="composite_value"?(s(),r(d,{key:6,label:e(o)("page.env.table.title.tag_list"),path:"tag_list"},{default:t(()=>[a(O,null,{default:t(()=>[(s(!0),S(ue,null,se(e(y),(n,R)=>(s(),S("div",{key:R,class:"tag-item"},[a(Y,{color:W(n.color),bordered:!1,closable:"",onClose:()=>Q(R)},{default:t(()=>[c(v(n.label),1)]),_:2},1032,["color","onClose"])]))),128)),a(ae,{show:e(k),"onUpdate:show":l[22]||(l[22]=n=>U(k)?k.value=n:null),trigger:"click"},{trigger:t(()=>[a(A,{dashed:"",focusable:!1,style:{height:"28px",padding:"0 6px"},onClick:l[19]||(l[19]=n=>k.value=!0)},{icon:t(()=>[a(z,{depth:3},{default:t(()=>[a(ee,{style:{"vertical-align":"0"}})]),_:1})]),_:1})]),default:t(()=>[a(O,{wrap:!1},{default:t(()=>[a(le,{size:"small"},{default:t(()=>[a(te,{value:e(C),"onUpdate:value":l[20]||(l[20]=n=>U(C)?C.value=n:null),size:"small",swatches:e(re),"render-label":()=>null,modes:["hex"],"show-alpha":!1,style:{width:"28px",height:"100%"}},null,8,["value","swatches"]),a(g,{value:e(h),"onUpdate:value":l[21]||(l[21]=n=>U(h)?h.value=n:null),size:"small",style:{width:"120px"}},null,8,["value"])]),_:1}),a(A,{size:"small",focusable:!1,onClick:Z},{default:t(()=>[c(v(e(o)("component.modal.okText")),1)]),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["label"])):P("",!0)]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show"])):(s(),r(me,{key:0,show:e($),"onUpdate:show":l[11]||(l[11]=n=>U($)?$.value=n:null),preset:"dialog","auto-focus":!1,"mask-closable":!1,title:e(H),"positive-text":e(o)("common.okText"),"negative-text":e(o)("common.cancelText"),"negative-button-props":{ghost:!1,tertiary:!0},style:{width:"460px"},onPositiveClick:K},{icon:t(()=>[a(z,{size:28},{default:t(()=>[e(u).id?(s(),r(_,{key:0,style:{"vertical-align":"0"}})):(s(),r(M,{key:1,style:{"vertical-align":"0"}}))]),_:1})]),default:t(()=>[a(de,{bordered:!1,style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[a(ne,{ref_key:"formRef",ref:G,model:e(u),rules:e(J),"label-width":"auto","require-mark-placement":"right-hanging",style:{"padding-top":"1em"}},{default:t(()=>[e(V)?P("",!0):(s(),r(d,{key:0,label:e(o)("page.env.table.title.type"),path:"type"},{default:t(()=>[a(g,{value:e(u).type,"onUpdate:value":l[0]||(l[0]=n=>e(u).type=n),maxlength:"200",clearable:""},null,8,["value"])]),_:1},8,["label"])),e(B)==="composite"?(s(),r(X,{key:1,"x-gap":"12",cols:3},{default:t(()=>[a(j,{span:2},{default:t(()=>[a(d,{label:e(o)("page.env.table.title.enable"),path:"enable"},{default:t(()=>[a(F,{value:e(u).enable,"onUpdate:value":l[1]||(l[1]=n=>e(u).enable=n),animated:"",type:"segment",size:"small",style:{height:"34px"}},{default:t(()=>[(s(),r(E,{key:1,name:1},{default:t(()=>[c(v(e(o)("common.active")),1)]),_:1})),(s(),r(E,{key:0,name:0},{default:t(()=>[c(v(e(o)("common.inactive")),1)]),_:1}))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),a(j,{span:1},{default:t(()=>[a(d,{label:e(o)("page.env.table.title.separator"),path:"separator"},{default:t(()=>[a(g,{value:e(u).separator,"onUpdate:value":l[2]||(l[2]=n=>e(u).separator=n),placeholder:e(o)("page.env.table.none"),style:{width:"100%"},"input-props":N},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})):(s(),r(d,{key:2,label:e(o)("page.env.table.title.enable"),path:"enable"},{default:t(()=>[a(F,{value:e(u).enable,"onUpdate:value":l[3]||(l[3]=n=>e(u).enable=n),animated:"",type:"segment",size:"small",style:{height:"34px"}},{default:t(()=>[(s(),r(E,{key:1,name:1},{default:t(()=>[c(v(e(o)("common.active")),1)]),_:1})),(s(),r(E,{key:0,name:0},{default:t(()=>[c(v(e(o)("common.inactive")),1)]),_:1}))]),_:1},8,["value"])]),_:1},8,["label"])),e(B)!=="composite"?(s(),r(d,{key:3,label:e(o)("page.env.table.title.value"),path:"value"},{default:t(()=>[a(g,{value:e(u).value,"onUpdate:value":l[4]||(l[4]=n=>e(u).value=n),type:"textarea","input-props":N},null,8,["value"])]),_:1},8,["label"])):P("",!0),e(V)?(s(),r(d,{key:5,label:e(o)("page.env.table.title.remark"),path:"remark"},{default:t(()=>[a(g,{value:e(u).remark,"onUpdate:value":l[6]||(l[6]=n=>e(u).remark=n)},null,8,["value"])]),_:1},8,["label"])):(s(),r(d,{key:4,label:e(o)("page.env.table.title.description"),path:"description"},{default:t(()=>[a(g,{value:e(u).description,"onUpdate:value":l[5]||(l[5]=n=>e(u).description=n)},null,8,["value"])]),_:1},8,["label"])),e(B)!=="composite_value"?(s(),r(d,{key:6,label:e(o)("page.env.table.title.tag_list"),path:"tag_list"},{default:t(()=>[a(O,null,{default:t(()=>[(s(!0),S(ue,null,se(e(y),(n,R)=>(s(),S("div",{key:R,class:"tag-item"},[a(Y,{color:W(n.color),bordered:!1,closable:"",onClose:()=>Q(R)},{default:t(()=>[c(v(n.label),1)]),_:2},1032,["color","onClose"])]))),128)),a(ae,{show:e(k),"onUpdate:show":l[10]||(l[10]=n=>U(k)?k.value=n:null),trigger:"click"},{trigger:t(()=>[a(A,{dashed:"",style:{height:"28px",padding:"0 6px"},onClick:l[7]||(l[7]=n=>k.value=!0)},{icon:t(()=>[a(z,{depth:3},{default:t(()=>[a(ee,{style:{"vertical-align":"0"}})]),_:1})]),_:1})]),default:t(()=>[a(O,{wrap:!1},{default:t(()=>[a(le,{size:"small"},{default:t(()=>[a(te,{value:e(C),"onUpdate:value":l[8]||(l[8]=n=>U(C)?C.value=n:null),size:"small",swatches:e(re),"render-label":()=>null,modes:["hex"],"show-alpha":!1,style:{width:"28px",height:"100%"}},null,8,["value","swatches"]),a(g,{value:e(h),"onUpdate:value":l[9]||(l[9]=n=>U(h)?h.value=n:null),size:"small",style:{width:"120px"}},null,8,["value"])]),_:1}),a(A,{size:"small",focusable:!1,onClick:Z},{default:t(()=>[c(v(e(o)("component.modal.okText")),1)]),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["label"])):P("",!0)]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show","title","positive-text","negative-text"]))}}});export{gt as _,mt as a,pe as b,_t as c,dt as d,vt as e,rt as f,it as g,pt as h,ie as s};
