import{_ as Z}from"./app-18f65c91.js";import{b as ee,d as ae,_ as ne}from"./app-16ee8ad9.js";import{_ as te}from"./app-8042bedb.js";import{_ as oe}from"./app-2356d3e8.js";import{M as U,a as le,_ as se}from"./app-6ef178c4.js";import{aJ as ie,a3 as m,aC as re,ah as de,G as ce,y as r,B as j,aM as ue,aN as pe,a4 as v,a5 as l,a6 as n,F as e,aF as C,af as fe,ag as _e,am as H,aP as me,aD as ge,bg as ve,aQ as he,aR as ye,aw as be,aH as ke,aS as xe,aI as we}from"./vendor-191e7315.js";import{s as Ce,a as $,c as ze,e as Se,I as De,g as Fe,b as Ie}from"./app-d3fc3aa7.js";import{h as z,u as S}from"./app-de22de5f.js";import{u as Pe}from"./app-9adaac50.js";import"./app-d8a29f50.js";import"./app-fd53326f.js";import"./vendor-2714f153.js";import"./app-9f5af7f8.js";import"./app-f9713fa5.js";import"./app-6595fc31.js";const Be={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ne(A,c){return m(),re("svg",Be,c[0]||(c[0]=[de("path",{fill:"currentColor",d:"M10 18H6v-2h4zm0-4H6v-2h4zm0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1zm10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2zm-4 6h-2v-2h2zm0 4h-2v-2h2z"},null,-1)]))}const Ee=ie({name:"mdi-file-compare",render:Ne}),We=ce({__name:"index",setup(A){const{getIsMobile:c}=Pe(),{t:u}=ee(),{message:B}=ae(),D=r([]),F=r([]),N=r({}),d=r(""),p=r(""),h=r(),k=r({content:"",language:""}),q=r(c.value?13:15),b=r(""),G=r(!c.value),x=r(!1),I=r(!1),y=r(!1);async function E(a){switch(a){case"save":x.value=!0;const t=e(h).getValue();try{await Ce({content:t,path:d.value}),B.success(u("editor.main.savedSuccess"))}finally{x.value=!1}break}}async function J(){y.value=!0;const a=await $({}),t=O(a);D.value=t;const i=await $({}),f=O(i);F.value=f,y.value=!1}function O(a){const t=f=>{f.length&&f.forEach(o=>{if(o.type===0)Object.assign(o,{key:o.path,label:o.title,prefix:()=>ze(o.title)}),t(o.children),o.children.length||(Object.assign(o,{children:null}),o.prefix=Se());else{const g=o.name;if(g){const w=g.substring(g.lastIndexOf(".")+1),_=Ie[w]||{};Object.assign(o,{key:o.path,label:g,language:_.language||"plaintext",disabled:_.disabled||!1,prefix:()=>_.icon||De})}}})};t(a);const i=f=>f.filter(o=>o.children?(o.children=i(o.children),!0):!o.disabled);return a=i(a),a}async function T(a,t){I.value=!0;const i=await Fe({path:encodeURI(a.key)});if(i)switch(t){case"config":k.value={content:i,language:a.language};break;case"sample":b.value=i;break}else{switch(t){case"config":break;case"sample":b.value="";break}B.info(u("page.diff.fileContentIsEmptyMsg"))}I.value=!1}function V({option:a}){return{async onClick(){!a.children&&!a.disabled&&(N.value=a,await T(a,"config"))}}}function M({option:a}){return{async onClick(){!a.children&&!a.disabled&&(N.value=a,await T(a,"sample"))}}}return j(d,a=>{a||(k.value={content:"",language:""})}),j(p,a=>{a||(b.value="")}),ue(async()=>{await J()}),pe(()=>{h.value&&h.value.dispose()}),(a,t)=>{const i=ve,f=Ee,o=he,g=ye,w=se,_=be,R=oe,L=ke,Q=te,W=xe,K=ne,X=we,Y=Z;return m(),v(Y,{"content-full":"","no-header":""},{default:l(()=>[n(X,{bordered:!e(c),style:{height:"100%","word-break":"unset"},segmented:{content:!0},"header-style":"padding: 10px","content-style":"padding: 0"},{header:l(()=>[e(c)?(m(),v(g,{key:1,vertical:"",style:{"padding-right":"8px"}},{default:l(()=>[n(i,{value:e(p),"onUpdate:value":t[2]||(t[2]=s=>C(p)?p.value=s:null),size:"small",loading:e(y),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(u)("page.diff.selectSourceFilePlaceholder"),options:e(F),"override-default-node-click-behavior":e(z),"node-props":M,"on-update:expanded-keys":e(S)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"]),n(i,{value:e(d),"onUpdate:value":t[3]||(t[3]=s=>C(d)?d.value=s:null),size:"small",loading:e(y),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(u)("page.diff.selectDestinationFilePlaceholder"),options:e(D),"override-default-node-click-behavior":e(z),"node-props":V,"on-update:expanded-keys":e(S)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1})):(m(),v(g,{key:0},{default:l(()=>[n(i,{value:e(p),"onUpdate:value":t[0]||(t[0]=s=>C(p)?p.value=s:null),size:"small",style:{"min-width":"260px",width:"fit-content"},"show-path":"",loading:e(y),"consistent-menu-width":!1,clearable:"",placeholder:e(u)("page.diff.selectSourceFilePlaceholder"),options:e(F),"override-default-node-click-behavior":e(z),"node-props":M,"on-update:expanded-keys":e(S)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"]),n(o,{size:24,depth:3},{default:l(()=>[n(f,{style:{"vertical-align":"-0.25em"}})]),_:1}),n(i,{value:e(d),"onUpdate:value":t[1]||(t[1]=s=>C(d)?d.value=s:null),size:"small",style:{"min-width":"260px",width:"fit-content"},"show-path":"",loading:e(y),"consistent-menu-width":!1,clearable:"",placeholder:e(u)("page.diff.selectDestinationFilePlaceholder"),options:e(D),"override-default-node-click-behavior":e(z),"node-props":V,"on-update:expanded-keys":e(S)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1}))]),"header-extra":l(()=>[fe(n(H,{name:"fade",mode:"out-in",appear:""},{default:l(()=>[e(c)?(m(),v(L,{key:1,vertical:""},{default:l(()=>[n(_,{strong:"",secondary:"",size:"small",style:{padding:"6px"},disabled:!e(d),loading:e(x),focusable:!1,onClick:t[5]||(t[5]=s=>E("save"))},{icon:l(()=>[n(R)]),_:1},8,["disabled","loading"]),n(e(U),{editor:e(h),"diff-mode":""},{trigger:l(({show:s,toggleShow:P})=>[n(_,{strong:"",secondary:"",size:"small",type:s?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:P},{default:l(()=>[n(o,{size:"18"},{default:l(()=>[n(w,{style:{"vertical-align":"baseline"}})]),_:1})]),_:2},1032,["type","onClick"])]),_:1},8,["editor"])]),_:1})):(m(),v(L,{key:0},{default:l(()=>[n(e(U),{editor:e(h),"diff-mode":""},{trigger:l(({show:s,toggleShow:P})=>[n(_,{strong:"",size:"small",quaternary:!s,tertiary:s,type:s?"primary":"default",style:{padding:"6px"},focusable:!1,onClick:P},{default:l(()=>[n(o,{size:"18"},{default:l(()=>[n(w,{style:{"vertical-align":"baseline"}})]),_:1})]),_:2},1032,["quaternary","tertiary","type","onClick"])]),_:1},8,["editor"]),n(_,{strong:"",type:"primary",size:"small",disabled:!e(d),loading:e(x),focusable:!1,onClick:t[4]||(t[4]=s=>E("save"))},{icon:l(()=>[n(R)]),default:l(()=>[me(" "+ge(e(u)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1}))]),_:1},512),[[_e,e(d)&&e(p)]])]),default:l(()=>[n(H,{name:"fade",mode:"out-in",appear:"",style:{"border-bottom-left-radius":"6px","border-bottom-right-radius":"6px"}},{default:l(()=>[e(k).content||e(b)?(m(),v(e(le),{key:0,ref_key:"editorRef",ref:h,value:e(k),"origin-value":e(b),"diff-mode":"","render-side-by-side":e(G),"font-size":e(q)},null,8,["value","origin-value","render-side-by-side","font-size"])):(m(),v(W,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(u)("common.selectFileEmptyDesc")},{icon:l(()=>[n(o,null,{default:l(()=>[n(Q)]),_:1})]),_:1},8,["description"]))]),_:1}),n(K,{show:e(I)},null,8,["show"])]),_:1},8,["bordered"])]),_:1})}}});export{We as default};
