import{a7 as b,aK as D,av as w,i as tt,p as nt,I as re,cu as ot,cv as st,cw as lt,A as E,r as Re,aI as _e,c9 as at,K as De,t as X,u as n,ai as ie,a6 as Ce,cc as Ae,a8 as x,a9 as u,aa as f,aS as j,aL as F,ax as Se,aR as Ve,aT as he,cp as Fe,aE as it,ap as Me,cx as ct,bb as Te,b3 as ve,at as ke,bI as xe,cy as rt,cz as ut,cr as dt,G as $e,h as $,bd as mt,a$ as ft,co as pt,bL as _t,cA as gt,am as me,cB as Ne,o as He,B as ht,s as vt,au as Ee,aF as Z,aJ as W,cC as bt,aP as Oe,cD as yt,c0 as Ct,bY as kt,O as Q,aw as ge,ay as wt,ba as Be,aV as St,bD as $t,ab as Ke,ac as zt,as as Lt,cE as Pt}from"./vendor-CVUNLYN4.js";import{a as ze,d as Le,a0 as ye,a1 as H,a2 as we,a3 as le,a4 as ce,a5 as je,a6 as Ue,a7 as qe,f as Nt,_ as Et}from"./index-BW0Kz9QR.js";import{C as It,g as Rt,_ as Dt,a as At}from"./clickOutside-JY6MVw26.js";import{_ as Vt}from"./download-simple-bold-CPvWvumI.js";import{_ as Ft}from"./question-circle-outlined-tr4rZkhQ.js";import{u as Pe}from"./useAppInject-Dal6O7k8.js";import{p as fe}from"./propTypes-CYyueTg3.js";import{_ as Mt}from"./more-horiz-C-LS9eeq.js";import{I as We}from"./Icon-ljQHnwJa.js";const Tt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},xt=w("path",{fill:"currentColor",d:"M9 9h6v6H9m-2 2h10V7H7m8-2h2V3h-2m0 18h2v-2h-2m4-2h2v-2h-2m0-6h2V7h-2m0 14a2 2 0 0 0 2-2h-2m0-6h2v-2h-2m-8 10h2v-2h-2M9 3H7v2h2M3 17h2v-2H3m2 6v-2H3a2 2 0 0 0 2 2M19 3v2h2a2 2 0 0 0-2-2m-6 0h-2v2h2M3 9h2V7H3m4 14h2v-2H7m-4-6h2v-2H3m0-6h2V3a2 2 0 0 0-2 2"},null,-1),Ht=[xt];function Ot(e,t){return b(),D("svg",Tt,[...Ht])}const Po={name:"mdi-select-all",render:Ot},Bt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Kt=w("path",{fill:"currentColor",d:"M2.39 1.73L1.11 3l3.1 3.1c-.13.29-.21.59-.21.9v10c0 2.21 3.59 4 8 4c2.3 0 4.38-.5 5.84-1.27l3 3l1.27-1.27zM6 9.64c.76.43 1.7.78 2.76 1.01L12.11 14H12c-2.42 0-4.7-.6-6-1.55zM12 19c-3.87 0-6-1.5-6-2v-2.23c1.61.78 3.72 1.23 6 1.23c.68 0 1.34-.05 2-.13l2.34 2.36c-1.01.42-2.47.77-4.34.77M8.64 5.44L7.06 3.86C8.42 3.33 10.13 3 12 3c4.42 0 8 1.79 8 4v9.8l-2-2v-.03v.01l-1.55-1.53c.6-.22 1.13-.49 1.55-.8V9.64c-1.03.58-2.39 1.01-3.94 1.22L12.19 9C15.94 8.94 18 7.5 18 7s-2.13-2-6-2c-1.34 0-2.46.18-3.36.44"},null,-1),jt=[Kt];function Ut(e,t){return b(),D("svg",Bt,[...jt])}const qt={name:"mdi-database-off-outline",render:Ut},Wt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Gt=w("path",{fill:"currentColor",d:"M7 19v-2h2v2zm4 0v-2h2v2zm4 0v-2h2v2zm-8-4v-2h2v2zm4 0v-2h2v2zm4 0v-2h2v2zm-8-4V9h2v2zm4 0V9h2v2zm4 0V9h2v2zM7 7V5h2v2zm4 0V5h2v2zm4 0V5h2v2z"},null,-1),Zt=[Gt];function Jt(e,t){return b(),D("svg",Wt,[...Zt])}const Yt={name:"mdi-drag",render:Jt},Qt={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Xt=w("path",{fill:"currentColor",d:"m924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 0 0 9.3-35.2l-.9-2.6a443.7 443.7 0 0 0-79.7-137.9l-1.8-2.1a32.12 32.12 0 0 0-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 0 0-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 0 0-25.8 25.7l-15.8 85.4a351.9 351.9 0 0 0-99 57.4l-81.9-29.1a32 32 0 0 0-35.1 9.5l-1.8 2.1a446 446 0 0 0-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1c0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 0 0-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0 0 35.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0 0 25.8 25.7l2.7.5a449.4 449.4 0 0 0 159 0l2.7-.5a32.05 32.05 0 0 0 25.8-25.7l15.7-85a350 350 0 0 0 99.7-57.6l81.3 28.9a32 32 0 0 0 35.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35M788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1l74.7 63.9a370 370 0 0 1-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3l-17.9 97a377.5 377.5 0 0 1-85 0l-17.9-97.2l-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9l-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5l-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5c0-15.3 1.2-30.6 3.7-45.5l6.5-40l-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2l31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3l17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97l38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8l92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176m79.2 255.2A111.6 111.6 0 0 1 512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 0 1 400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390s58 11.6 79.2 32.8A111.6 111.6 0 0 1 624 502c0 29.9-11.7 58-32.8 79.2"},null,-1),en=[Xt];function tn(e,t){return b(),D("svg",Qt,[...en])}const nn={name:"ant-design-setting-outlined",render:tn},Ge=Symbol("s-table");function on(e){nt(Ge,e)}function Ze(){return tt(Ge)}const{t:sn}=ze(),ln=re({name:"ColumnSetting",components:{SlickList:ot,SlickItem:st},directives:{handle:lt},setup(){const e=Ze(),t=E([]),p=E([]),l=Re({selection:!1,checkAll:!0,checkList:[],defaultCheckList:[]});_e(()=>{e.getColumns().filter(o=>o.type!=="selection").length&&v()});function v(){const a=_(),o=a.map(r=>r.key);l.checkList=o,l.defaultCheckList=o;const s=a;t.value.length||(t.value=ie(s),p.value=ie(s))}function g(a){a.length?l.checkAll=!0:l.checkAll=!1,i(a)}function i(a){e.setColumns(a)}function _(){const a=[];return e.getColumns().filter(o=>o.key!=="action"&&o.title!=="操作"&&o.type!=="selection").forEach(o=>{a.push({...o})}),a}function L(){l.checkList=[...l.defaultCheckList],l.checkAll=!0;const o=e.getCacheColumns().filter(s=>s?.type!=="selection").map(s=>({...s}));i(o),t.value=o}function c(a){const o=e.getCacheColumns(!0);a?(i(o),l.checkList=o):(i([]),l.checkList=[])}function m(){document.body.style.cursor="move"}function C(){const a=X(n(t));t.value=a,i(a),document.body.style.cursor=""}at(()=>{document.body.style.cursor=""});function I(a){const o=e.getCacheColumns();a||o.splice(0,1),i(o)}return{t:sn,...De(l),columnsList:t,onChange:g,onCheckAll:c,onSelection:I,resetColumns:L,dragEnd:C,dragStart:m}}}),an={class:"cursor-pointer table-toolbar-right-icon"},cn={class:"table-toolbar-inner"},rn={class:"drag-icon"};function un(e,t,p,l,v,g){const i=nn,_=he,L=Fe,c=it,m=Me,C=Yt,I=xe,a=Ce("SlickItem"),o=Ce("SlickList"),s=ct,r=Te,h=ve,k=Ae("handle");return b(),x(h,{trigger:"hover"},{trigger:u(()=>[w("div",an,[f(r,{trigger:"click",width:230,class:"toolbar-popover",placement:"bottom-end","content-style":"padding: 4px 0","footer-style":"padding: 8px 0 0 0"},{trigger:u(()=>[f(_,{size:18},{default:u(()=>[f(i)]),_:1})]),header:u(()=>[f(c,{justify:"space-between",size:"small",class:"table-toolbar-inner-popover-title"},{default:u(()=>[f(c,null,{default:u(()=>[f(L,{value:e.checkAll,"onUpdate:value":[t[0]||(t[0]=y=>e.checkAll=y),e.onCheckAll],size:"small",round:!1,style:{height:"22px"}},null,8,["value","onUpdate:value"]),j(" "+F(e.t("component.table.settingColumnShow")),1)]),_:1})]),_:1})]),footer:u(()=>[f(m,{secondary:"",type:"primary",block:"",size:"small",onClick:e.resetColumns},{default:u(()=>[j(F(e.t("component.table.settingColumnReset")),1)]),_:1},8,["onClick"])]),default:u(()=>[w("div",cn,[f(s,{value:e.checkList,"onUpdate:value":[t[2]||(t[2]=y=>e.checkList=y),e.onChange]},{default:u(()=>[f(o,{list:e.columnsList,"onUpdate:list":[t[1]||(t[1]=y=>e.columnsList=y),e.dragEnd],"use-drag-handle":"","lock-to-container-edges":"","lock-offset":[8,8],axis:"y","lock-axis":"y","helper-class":"shadow","dragged-settling-duration":150,onSortStart:e.dragStart},{default:u(()=>[(b(!0),D(Ve,null,Se(e.columnsList,(y,S)=>(b(),x(a,{key:y.key,index:S,class:"table-toolbar-inner-checkbox"},{default:u(()=>[ke((b(),D("span",rn,[f(C,{class:"text-18px text-$app-text-color-2"})])),[[k]]),f(I,{value:y.key,label:y.title},null,8,["value","label"])]),_:2},1032,["index"]))),128))]),_:1},8,["list","onSortStart","onUpdate:list"])]),_:1},8,["value","onUpdate:value"])])]),_:1})])]),default:u(()=>[w("span",null,F(e.t("component.table.settingColumn")),1)]),_:1})}const Je=Le(ln,[["render",un]]),dn={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},mn=w("path",{fill:"currentColor",d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8m0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8M610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 0 0-11.3 0L403.6 366.3a7.23 7.23 0 0 0 5.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378z"},null,-1),fn=[mn];function pn(e,t){return b(),D("svg",dn,[...fn])}const _n={name:"ant-design-column-height-outlined",render:pn},gn={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},hn=w("path",{fill:"currentColor",d:"m909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92C290 92 102.3 279.5 102 511.5C101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1c1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 0 0-10.1 4.8c-1.8 5-3.8 10-5.9 14.9c-17.3 41-42.1 77.8-73.7 109.4A344.8 344.8 0 0 1 655.9 829c-42.3 17.9-87.4 27-133.8 27c-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 0 1 279 755.2a342.2 342.2 0 0 1-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4s68.4-56.4 109.3-73.8c42.3-17.9 87.4-27 133.8-27c46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 0 1 109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 0 0 3 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2"},null,-1),vn=[hn];function bn(e,t){return b(),D("svg",gn,[...vn])}const yn={name:"ant-design-reload-outlined",render:bn};function Cn(e,t=150,p){let l=()=>{e()};l=dt(l,t);const g=()=>{p&&p.immediate&&l(),window.addEventListener("resize",l)},i=()=>{window.removeEventListener("resize",l)};return rt(()=>{g()}),ut(()=>{i()}),[g,i]}function kn(e){const t=E(n(e).loading);$e(()=>n(e).loading,v=>{t.value=v});const p=$(()=>n(t));function l(v){t.value=v}return{getLoading:p,setLoading:l}}const wn={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Sn=w("path",{fill:"currentColor","fill-rule":"evenodd",d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.1.1 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.12.12 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.1.1 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926L224.297 857.629c-.04.041-.06.052-.083.059a.12.12 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.1.1 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512L166.371 224.297c-.041-.04-.052-.06-.059-.083a.12.12 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.1.1 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.12.12 0 0 1 .07 0Z"},null,-1),$n=[Sn];function zn(e,t){return b(),D("svg",wn,[...$n])}const Ln={name:"ant-design-close-outlined",render:zn},Pn={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Nn=w("path",{fill:"currentColor",d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5L207 474a32 32 0 0 0-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8"},null,-1),En=[Nn];function In(e,t){return b(),D("svg",Pn,[...En])}const Rn={name:"ant-design-check-outlined",render:In},Dn={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},An=w("path",{fill:"currentColor",d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8"},null,-1),Vn=w("path",{fill:"currentColor",d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 0 0-2.3 5.6m63.5 23.6L779.7 199l45.2 45.1l-360.5 359.7l-45.7 1.1z"},null,-1),Fn=[An,Vn];function Mn(e,t){return b(),D("svg",Dn,[...Fn])}const Ye={name:"ant-design-form-outlined",render:Mn};var Qe=(e=>(e.NInput="on-input",e.NInputNumber="on-input",e.NSelect="on-update:value",e.NSwitch="on-update:value",e.NCheckbox="on-update:value",e.NDatePicker="on-update:value",e.NTimePicker="on-update:value",e))(Qe||{});const J=new Map;J.set("NInput",mt);J.set("NInputNumber",ft);J.set("NSelect",pt);J.set("NSwitch",Fe);J.set("NCheckbox",xe);J.set("NDatePicker",_t);J.set("NTimePicker",gt);const Tn=({component:e="NInput",rule:t=!0,ruleMessage:p,popoverVisible:l},{attrs:v})=>{const g=J.get(e),i=me(g,v);return t?me(Te,{"display-directive":"show",show:!!l,manual:"manual"},{trigger:()=>i,default:()=>me("span",{style:{color:"red",width:"90px",display:"inline-block"}},{default:()=>p})}):i};function Ie(e){return e==="NInput"?"请输入":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":""}const xn=re({name:"EditableCell",components:{CellComponent:Tn},directives:{clickOutside:It},props:{value:{type:[String,Number,Boolean,Object],default:""},record:{type:Object},column:{type:Object,default:()=>({})},index:fe.number},setup(e){const t=Ze(),p=E(!1),l=E(),v=E(!1),g=E(""),i=E([]),_=E(e.value),L=E(e.value),c=$(()=>e.column?.editComponent||"NInput"),m=$(()=>e.column?.editRule),C=$(()=>n(g)&&n(v)),I=$(()=>{const d=n(c);return["NCheckbox","NRadio"].includes(d)}),a=$(()=>{const d=e.column?.editComponentProps??{},z=e.column?.editComponent??null,P=n(c),A={},R=n(I),q=R?"checked":"value",T=n(_);let K=R?ye(T)&&H(T)?T:!!T:T;we(K)&&P==="NDatePicker"?K=Ne(K):le(K)&&P==="NDatePicker"&&(K=K.map(ue=>Ne(ue)));const te=z?Qe[z]:void 0;return{placeholder:Ie(n(c)),...A,...He(d,"onChange"),[te]:y,[q]:K}}),o=$(()=>{const{editComponentProps:d,editValueMap:z}=e.column,P=n(_);return z&&ce(z)?z(P):n(c).includes("NSelect")?(d?.options??(n(i)||[])).find(T=>`${T.value}`==`${P}`)?.label??P:P}),s=$(()=>({width:"calc(100% - 48px)"})),r=$(()=>{const{align:d="center"}=e.column;return`edit-cell-align-${d}`}),h=$(()=>{const{editable:d}=e.record||{};return!!d});_e(()=>{L.value=e.value}),_e(()=>{const{editable:d}=e.column;(H(d)||H(n(h)))&&(p.value=!!d||n(h))});function k(){n(h)||n(e.column?.editRow)||(g.value="",p.value=!0,ht(()=>{n(l)?.focus?.()}))}async function y(d,...z){const P=n(c);d?d?.target&&Reflect.has(d.target,"value")?_.value=d.target.value:P==="NCheckbox"?_.value=d.target.checked:(we(d)||H(d)||ye(d))&&(_.value=d):_.value=d;const A=e.column?.editComponentProps?.onChange;A&&ce(A)&&A(d,...z),t.emit?.("edit-change",{column:e.column,value:n(_),record:X(e.record)}),await S()}async function S(){const{column:d,record:z}=e,{editRule:P}=d,A=n(_);if(P){if(H(P)&&!A&&!ye(A)){v.value=!0;const R=n(c);return g.value=Ie(R),!1}if(ce(P)){const R=await P(A,z);return R?(g.value=R,v.value=!0,!1):(g.value="",!0)}}return g.value="",!0}async function V(d=!0,z=!0){if(z&&!await S())return;const{column:P,index:A,record:R}=e;if(!R)return;const{key:q}=P,T=n(_);if(!q)return;vt(R,q,T),d&&t.emit?.("edit-end",{record:R,index:A,key:q,value:T}),p.value=!1}async function U(){e.column?.editRow||await V()}function O(){p.value=!1,_.value=L.value;const{column:d,index:z,record:P}=e,{key:A}=d;v.value=!0,g.value="",t.emit?.("edit-cancel",{record:P,index:z,key:A,value:n(_)})}function ee(){if(e.column?.editable||n(h))return;n(c).includes("NInput")&&O()}function B(d){i.value=d}function M(d,z){e.record&&(le(e.record[d])?e.record[d]?.push(z):e.record[d]=[z])}return e.record&&(M("submitCbs",V),M("validCbs",S),M("cancelCbs",O),e.column.key&&(e.record.editValueRefs||(e.record.editValueRefs={}),e.record.editValueRefs[e.column.key]=_),e.record.onCancelEdit=()=>{le(e.record?.cancelCbs)&&e.record?.cancelCbs.forEach(d=>d())},e.record.onSubmitEdit=async()=>{if(le(e.record?.submitCbs)){const d=(e.record?.validCbs||[]).map(R=>R());return(await Promise.all(d)).every(R=>!!R)?((e.record?.submitCbs||[]).forEach(R=>R(!1,!1)),t.emit?.("edit-row-end"),!0):void 0}}),{isEdit:p,handleEdit:k,currentValueRef:_,handleSubmit:V,handleChange:y,handleCancel:O,elRef:l,getComponent:c,getRule:m,onClickOutside:ee,ruleMessage:g,getRuleVisible:C,getComponentProps:a,handleOptionsChange:B,getWrapperStyle:s,getWrapperClass:r,getRowEditable:h,getValues:o,handleEnter:U}}}),Hn={class:"editable-cell"},On={class:"flex editable-cell-content"},Bn={class:"editable-cell-content-comp"},Kn={key:0,class:"editable-cell-action"};function jn(e,t,p,l,v,g){const i=Ye,_=he,L=Ce("CellComponent"),c=Rn,m=Ln,C=Ae("click-outside");return b(),D("div",Hn,[ke(w("div",{class:"editable-cell-content",onClick:t[0]||(t[0]=(...I)=>e.handleEdit&&e.handleEdit(...I))},[j(F(e.getValues)+" ",1),e.column.editRow?Z("",!0):(b(),x(_,{key:0,class:"edit-icon"},{default:u(()=>[f(i)]),_:1}))],512),[[Ee,!e.isEdit]]),ke((b(),D("div",On,[w("div",Bn,[f(L,W(e.getComponentProps,{ref:"elRef",component:e.getComponent,style:e.getWrapperStyle,"popover-visible":e.getRuleVisible,"rule-message":e.ruleMessage,rule:e.getRule,class:e.getWrapperClass,onOptionsChange:e.handleOptionsChange,onPressEnter:e.handleEnter}),null,16,["component","style","popover-visible","rule-message","rule","class","onOptionsChange","onPressEnter"])]),e.getRowEditable?Z("",!0):(b(),D("div",Kn,[f(_,{class:"mx-2 cursor-pointer"},{default:u(()=>[f(c,{onClick:e.handleSubmit},null,8,["onClick"])]),_:1}),f(_,{class:"mx-2 cursor-pointer"},{default:u(()=>[f(m,{onClick:e.handleCancel},null,8,["onClick"])]),_:1})]))])),[[Ee,e.isEdit],[C,e.onClickOutside]])])}const Un=Le(xn,[["render",jn]]);function qn(e){return(t,p)=>{const l=e.key,v=t[l];return t.onEdit=async(g,i=!1)=>(i||(t.editable=g),!g&&i?await t.onSubmitEdit?.()?(t.editable=!1,!0):!1:(!g&&!i&&t.onCancelEdit?.(),!0)),me(Un,{value:v,record:t,column:e,index:p})}}function Wn(e){const{getIsMobile:t}=Pe(),p=E(n(e).columns);let l=n(e).columns;const v=$(()=>{const o=ie(n(p));if(!o.some(s=>s.type==="selection")){const s=l.find(r=>r.type==="selection");s&&o.unshift(s)}return L(e,o),o||[]}),{hasPermission:g}=je();function i(o){const{ifShow:s}=o;let r=!0;return H(s)&&(r=s),ce(s)&&(r=s(o)),r}const _=$(()=>{const o=n(v);return ie(o).filter(r=>g(r.auth)&&i(r)).map(r=>{r.ellipsis=typeof r.ellipsis>"u"?{tooltip:{trigger:t.value?"click":"hover",contentStyle:t.value?"max-width: 300px":"max-width: 800px",placement:t.value?"bottom":void 0}}:!1;const{edit:h}=r;if(h&&(r.render=qn(r),h)){const k=r.title;r.title=()=>f(ve,null,{trigger:()=>f("span",null,[f("span",{style:{"margin-right":"5px"}},[k]),f(he,{size:14},{default:()=>[f(Ye,null,null)]})]),default:()=>"该列可编辑"})}return r})});$e(()=>n(e).columns,o=>{p.value=o,l=o});function L(o,s){const{actionColumn:r}=n(o);r&&!s.find(h=>h.key==="action")&&s.push({...r})}function c(o){const s=ie(o);if(!le(s))return;if(!s.length){p.value=[],m([]);return}const r=l.map(k=>k.key);if(!we(s[0]))p.value=s;else{const k=[];l.forEach(y=>{o.includes(y.key)&&k.push({...y})}),bt(r,s)||k.sort((y,S)=>r.indexOf(y.key)-r.indexOf(S.key)),p.value=k}const h=p.value.map(({key:k})=>k);m(h)}function m(o){const s=e.value.tableId;if(s){const r=qe+s;Ue.setLocal(r,o)}}function C(){return X(n(v)).map(s=>({...s,title:s.title,key:s.key,fixed:s.fixed||void 0}))}function I(o){return o?l.map(s=>s.key):l}function a(o,s){!o||!s||l.forEach(r=>{r.key===o&&Object.assign(r,s)})}return{getColumnsRef:v,getCacheColumns:I,setCacheColumnsField:a,setColumns:c,getColumns:C,getPageColumns:_}}const Gn={table:{apiSetting:{pageField:"page",sizeField:"size",listField:"data",totalField:"total"},defaultPageSize:10,pageSizes:[5,10,20,50,100,200,500,1e3,2e3]},upload:{apiSetting:{infoField:"data",imgField:"photo"},maxSize:2,fileType:["image/png","image/jpg","image/jpeg","image/gif","image/svg+xml"]}},{table:Zn}=Gn,{apiSetting:Jn,defaultPageSize:Yn,pageSizes:Qn}=Zn,Xn=Yn,ae=Jn,eo=Qn;function to(e,{getPaginationInfo:t,setPagination:p,setLoading:l,tableData:v},g){const i=E([]);_e(()=>{v.value=n(i)}),$e(()=>n(e).dataSource,()=>{const{dataSource:a}=n(e);a&&(i.value=a)},{immediate:!0});const _=$(()=>{const{rowKey:a}=n(e);return a||(()=>"key")}),L=$(()=>{const a=n(i);return!a||a.length===0?n(i):n(i)});async function c(a){const{request:o,pagination:s,data:r}=n(e);if(!o&&r){i.value=r;return}try{l(!0);const{pageField:h}=ae,{sizeField:k}=ae,{totalField:y}=ae,{listField:S}=ae;let V={};const{page:U=1,pageSize:O=10}=n(t);H(s)&&!s||H(t)?V={}:(V[h]=a&&a[h]||U,V[k]=O);const ee={...V},B=await o(ee),M=Math.ceil(B[y]/B[k])||0,d=B[h];M&&U>M&&(p({[h]:M,totalRows:B[y]}),c(a));const z=B[S]?B[S]:[];i.value=z,p({[h]:d,[y]:M,totalRows:B[y]}),a&&a[h]&&p({[h]:a[h]||1}),g("fetch-success",{items:n(z),resultTotal:M})}catch(h){console.error(h),g("fetch-error",h),i.value=[]}finally{l(!1)}}Oe(()=>{setTimeout(()=>{c()},16)});function m(a){i.value=a}function C(){return L.value}async function I(a){await c(a)}return{fetch:c,getRowKey:_,getDataSourceRef:L,getDataSource:C,setTableData:m,reload:I}}function no(e){const t=E({}),p=E(!0),{getIsMobile:l}=Pe(),{t:v}=ze(),g=$(()=>{const{pagination:m}=n(e);if(!n(p)||H(m)&&!m)return!1;const{totalField:C}=ae;return{pageSize:Xn,pageSizes:eo,showSizePicker:!0,showQuickJumper:!1,pageSlot:l.value?4:9,prefix(){return v("component.table.total",{total:n(t).totalRows})},...H(m)?{}:m,...n(t),pageCount:n(t)[C]}});function i(m){const C=n(g);t.value={...H(C)?{}:C,...m}}function _(){return n(g)}function L(){return n(p)}async function c(m){p.value=m}return{getPagination:_,getPaginationInfo:g,setShowPagination:c,getShowPagination:L,setPagination:i}}const oo={...yt,tableId:{type:String,default:null},defaultHideKeys:{type:[Array],default:()=>[]},title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},tableData:{type:[Object],default:()=>[]},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Boolean,Object],default:()=>{}},actionColumn:{type:Object,default:null},showAdvanced:fe.bool.def(!0),canResize:fe.bool.def(!0),resizeHeightOffset:fe.number.def(0)},{t:pe}=ze(),so=[{type:"menu",label:pe("component.table.settingDensSmall"),key:"small"},{type:"menu",label:pe("component.table.settingDensDefault"),key:"medium"},{type:"menu",label:pe("component.table.settingDensLoose"),key:"large"}],lo=re({components:{ColumnSetting:Je},props:oo,emits:["fetch-success","fetch-error","update:checked-row-keys","edit-end","edit-cancel","edit-row-end","edit-change"],setup(e,{emit:t}){const p=E(150),l=E(),v=E(),g=E(),i=E();let _;const L=E([]),c=E(),m=$(()=>({...e,...n(c)})),{getLoading:C,setLoading:I}=kn(m),{getPaginationInfo:a,setPagination:o}=no(m),{getDataSourceRef:s,getRowKey:r,reload:h}=to(m,{getPaginationInfo:a,setPagination:o,tableData:L,setLoading:I},t),{getPageColumns:k,setColumns:y,getColumns:S,getCacheColumns:V,setCacheColumnsField:U}=Wn(m),{getIsMobile:O}=Pe(),{toggle:ee,isFullscreen:B}=Ct(v,{autoExit:!0}),M=Re({showExport:!!(n(m).showExport||!O.value),tableSize:n(m).size||"medium",isColumnSetting:!1});function d(N){o({page:N}),h()}function z(N){o({page:1,pageSize:N}),h()}function P(N){M.tableSize=N}function A(){const N=l?.value,G=m.value.tableId,Y=Nt().replace(/:/g,"-").replace(/ /g,"-"),ne=G?`${G}-${Y}`:Y;N?.downloadCsv({fileName:ne,keepOriginalData:!1})}const R=$(()=>M.tableSize),q=$(()=>{const N=n(s),G=N.length&&n(ue)?`${n(p)}px`:"auto";return{...n(m),rowKey:n(r),data:N,size:n(R),remote:!0,"max-height":G}}),T=$(()=>X(n(a)));function K(N){c.value={...n(c),...N}}const te={reload:h,setColumns:y,setLoading:I,setProps:K,getColumns:S,getPageColumns:k,getCacheColumns:V,setCacheColumnsField:U,emit:t},ue=$(()=>{const{canResize:N}=n(m);return N});async function Xe(){const N=kt(l);if(!N||!n(ue))return;const G=N.querySelector(".n-data-table-thead"),{bottomIncludeBody:Y}=Rt(G),ne=64;let oe=2;const se=O.value?6:26;if(!H(T))if(_=N.querySelector(".n-data-table__pagination"),_){const{offsetHeight:et}=_;oe+=et||0}else oe+=28;let de=Y-(ne+oe+se+(e.resizeHeightOffset||0));const{maxHeight:be}=e;de=be&&be<de?be:de,p.value=de}return Cn(Xe,280,{immediate:!0}),on({...te,wrapRef:g,getBindValues:q}),Oe(()=>{const N=m.value.tableId;if(N){const G=qe+N,Y=Ue.getLocal(G);if(Y)i.value.onChange(Y);else{const ne=m.value.defaultHideKeys,oe=m.value.columns.map(({key:se})=>se).filter(se=>!ne?.includes(se));i.value.onChange(oe)}}}),{t:pe,...De(M),getIsMobile:O,getLoading:C,tableElRef:l,tableContainerRef:v,columnSettingRef:i,toggle:ee,isFullscreen:B,getBindValues:q,densityOptions:so,reload:h,densitySelect:P,exportCsv:A,updatePage:d,updatePageSize:z,getPageColumns:k,pagination:T,tableAction:te}}}),ao={key:0,class:"table-toolbar"},io={class:"flex items-center table-toolbar-left"},co={key:0,class:"table-toolbar-left-title"},ro={class:"flex items-center table-toolbar-right"},uo={class:"table-toolbar-right-icon"},mo={class:"s-table"},fo={class:"table-info"};function po(e,t,p,l,v,g){const i=Ft,_=ve,L=yn,c=he,m=_n,C=Be,I=Vt,a=Je,o=Dt,s=At,r=qt,h=St,k=$t,y=Et;return b(),D("div",{ref:"tableContainerRef",class:wt({"table-full-screen":e.isFullscreen})},[e.showAdvanced?(b(),D("div",ao,[w("div",io,[e.title?(b(),D("div",co,[j(F(e.title)+" ",1),e.titleTooltip?(b(),x(_,{key:0,trigger:"hover"},{trigger:u(()=>[f(i,{class:"text-18px text-$app-text-color-3 ml-1 cursor-pointer"})]),default:u(()=>[j(" "+F(e.titleTooltip),1)]),_:1})):Z("",!0)])):Z("",!0),Q(e.$slots,"tableTitle",{},void 0,!0)]),w("div",ro,[Q(e.$slots,"toolbar",{},void 0,!0),f(_,{trigger:"hover"},{trigger:u(()=>[w("div",{class:"table-toolbar-right-icon",onClick:t[0]||(t[0]=(...S)=>e.reload&&e.reload(...S))},[f(c,{size:18},{default:u(()=>[f(L)]),_:1})])]),default:u(()=>[w("span",null,F(e.t("component.table.refresh")),1)]),_:1}),f(_,{trigger:"hover"},{trigger:u(()=>[w("div",uo,[f(C,{value:e.tableSize,"onUpdate:value":t[1]||(t[1]=S=>e.tableSize=S),size:"small",trigger:"click","show-arrow":!0,options:e.densityOptions,onSelect:e.densitySelect},{default:u(()=>[f(c,{size:18},{default:u(()=>[f(m)]),_:1})]),_:1},8,["value","options","onSelect"])])]),default:u(()=>[w("span",null,F(e.t("component.table.settingDens")),1)]),_:1}),e.showExport?(b(),x(_,{key:0,trigger:"hover"},{trigger:u(()=>[w("div",{class:"table-toolbar-right-icon",onClick:t[2]||(t[2]=(...S)=>e.exportCsv&&e.exportCsv(...S))},[f(c,{size:18,depth:2},{default:u(()=>[f(I)]),_:1})])]),default:u(()=>[w("span",null,F(e.t("component.table.export")),1)]),_:1})):Z("",!0),f(a,{ref:"columnSettingRef"},null,512),e.getIsMobile?Z("",!0):(b(),x(_,{key:1,trigger:"hover"},{trigger:u(()=>[w("div",{class:"table-toolbar-right-icon",onClick:t[3]||(t[3]=(...S)=>e.toggle&&e.toggle(...S))},[f(c,{size:20},{default:u(()=>[e.isFullscreen?(b(),x(o,{key:0})):(b(),x(s,{key:1}))]),_:1})])]),default:u(()=>[j(" "+F(e.isFullscreen?e.t("component.table.tooltipExitFull"):e.t("component.table.tooltipEntryFull")),1)]),_:1}))])])):Z("",!0),w("div",mo,[f(k,W({ref:"tableElRef"},e.getBindValues,{columns:e.getPageColumns,pagination:e.pagination,"scroll-x":1800,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),ge({empty:u(()=>[f(h,{size:"huge"},{icon:u(()=>[f(c,null,{default:u(()=>[f(r)]),_:1})]),_:1})]),_:2},[Se(Object.keys(e.$slots),S=>({name:S,fn:u(V=>[Q(e.$slots,S,Ke(zt(V)),void 0,!0)])}))]),1040,["columns","pagination","onUpdate:page","onUpdate:pageSize"]),f(y,{show:e.getLoading},null,8,["show"]),w("div",fo,[Q(e.$slots,"info",{},void 0,!0)])])],2)}const No=Le(lo,[["render",po],["__scopeId","data-v-7845e7d8"]]),_o=re({__name:"popConfirmWrapper",props:{isWrapper:Boolean},setup(e){const t=Lt(),p=$(()=>He({showIcon:!0,...t},["title","icon"]));return(l,v)=>{const g=We,i=Pt;return e.isWrapper?(b(),x(i,Ke(W({key:0},n(p))),ge({trigger:u(()=>[Q(l.$slots,"default")]),default:u(()=>[j(" "+F(n(t).title),1)]),_:2},[n(t).icon?{name:"icon",fn:u(()=>[f(g,{icon:n(t).icon},null,8,["icon"])]),key:"0"}:void 0]),1040)):Q(l.$slots,"default",{key:1})}}}),go={class:"tableAction"},ho={class:"flex items-center justify-center py-1 px-2 space-x-2"},vo={name:"TableAction"},Eo=re({...vo,props:{actions:null,dropDownActions:null,style:{default:"button"},select:null},setup(e){const t=e,{hasPermission:p}=je(),l=t.style==="button"?"default":t.style==="text"?"primary":"default",v=t.style==="button"?void 0:t.style==="text"?!0:void 0,g=$(()=>({text:v,type:l,size:"small"})),i=$(()=>(X(t.dropDownActions)||[]).filter(c=>p(c.auth)&&L(c))),_=$(()=>(X(t.actions)||[]).filter(c=>p(c.auth)&&L(c)).map(c=>{const{popConfirm:m}=c;return{size:"small",text:v,type:l,...c,...m||{},enable:!!m}}));function L(c){const m=c.ifShow;let C=!0;return H(m)&&(C=m),ce(m)&&(C=m(c)),C}return(c,m)=>{const C=We,I=Me,a=ve,o=Mt,s=Be;return b(),D("div",go,[w("div",ho,[(b(!0),D(Ve,null,Se(n(_),({icon:r,iconProps:h,label:k,enable:y,tooltip:S,popConfirm:V,...U},O)=>(b(),x(_o,W({key:`${O}-${k}`,"is-wrapper":y,ref_for:!0},V),{default:u(()=>[S?(b(),x(a,{key:1,trigger:"hover",delay:500},{trigger:u(()=>[f(I,W({ref_for:!0},U,{style:{padding:"0 6px"}}),ge({_:2},[k?{name:"default",fn:u(()=>[j(F(k),1)]),key:"0"}:void 0,r?{name:"icon",fn:u(()=>[f(C,W({icon:r,ref_for:!0},h),null,16,["icon"])]),key:"1"}:void 0]),1040)]),default:u(()=>[j(" "+F(S),1)]),_:2},1024)):(b(),x(I,W({key:0,ref_for:!0},U,{style:{padding:"0 6px"}}),ge({_:2},[k?{name:"default",fn:u(()=>[j(F(k),1)]),key:"0"}:void 0,r?{name:"icon",fn:u(()=>[f(C,W({icon:r,ref_for:!0},h),null,16,["icon"])]),key:"1"}:void 0]),1040))]),_:2},1040,["is-wrapper"]))),128)),e.dropDownActions&&n(i).length?(b(),x(s,{key:0,trigger:"click",placement:"bottom-end",options:n(i),onSelect:e.select},{default:u(()=>[Q(c.$slots,"more",{},()=>[f(I,W(n(g),{quaternary:"",focusable:!1,style:{padding:"0 6px"}}),{icon:u(()=>[f(o)]),_:1},16)])]),_:3},8,["options","onSelect"])):Z("",!0)])])}}});export{No as B,Eo as _,Po as a};
