import{_ as Z}from"./app-6ee071f1.js";import{aN as ee,a6 as C,aG as te,al as v,G as ae,y,r as ne,J as le,F as e,a7 as z,a8 as a,a9 as n,aJ as b,aH as k,aT as O,aU as P,be as oe,bf as se,ay as ie,aM as re,bK as ce,ba as de,aV as pe,aA as ue,aL as _e,bE as fe,bF as he}from"./vendor-f4e37609.js";import{a as me,c as ve,d as ge,I as xe,b as ye}from"./app-84e2d10f.js";import{h as V,r as be,u as j}from"./app-e289ea8e.js";import{u as ke}from"./app-34fc42c0.js";import{b as we,e as Te}from"./app-516cf0fd.js";import{F as Fe}from"./app-30b30e0d.js";const Ce={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ie(U,g){return C(),te("svg",Ce,g[0]||(g[0]=[v("path",{fill:"currentColor",d:"M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35l2.09 2.09L10.35 19L7 15.65l3.35-3.35l1.28 1.26zm7.46 0L13.65 19l-1.27-1.26l2.09-2.09l-2.09-2.09l1.27-1.26z"},null,-1)]))}const Ne=ee({name:"mdi-file-code-outline",render:Ie}),Ee={class:"pb-1 mr-3"},Be={style:{"vertical-align":"-4px",padding:"0 2px"}},Le={class:"mr-2 mb-2"},De=ae({__name:"index",emits:["onConfirmSelect"],setup(U,{expose:g,emit:$}){const A=$,{t:i}=we(),{getIsMobile:I}=ke(),w=y(null),T=y([]),F=y([]),p=y(""),N=ne({show:!1,title:"",path:"",option:{}}),{show:_,title:u,path:r,option:x}=le(N);async function H(c){u.value=i("page.code.selectFileTitle");const o=await me({}),s=await M(o);T.value=s,c&&(F.value=function(d){const f=[];let l=d.replace(/[\\/]$/,"");for(;l;)l!=="/arcadia"&&f.push(l),l=l.replace(/[\\/]?[^\\/]+$/,"");return f.reverse()}(c),r.value=c,u.value=c.replace(/[\\/]$/,"").replace(/.*[\\/]/,"")),N.show=!0,r.value&&setTimeout(()=>{w.value?.scrollTo({key:r.value,position:"bottom"})},2e3)}function E(){A("onConfirmSelect",x.value),m()}function B(c,o,s){if(s.action!=="select"){L();return}const t=s.node;if(t.is_dir||t.disabled){L();return}u.value=t.label||i("page.code.selectFileTitle"),r.value=t.key,x.value=t}async function M(c){const o=s=>{s.length&&s.forEach(t=>{if(t.type===Fe.FOLDER)Object.assign(t,{key:t.path,label:t.title,is_dir:!0,can_run:!1,disabled:!1,prefix:()=>ve(t.title)}),!t.children.length||t.children.length===0?(Object.assign(t,{children:null}),t.prefix=()=>ge()):o(t.children);else{const d=t.name;if(d){const f=d.substring(d.lastIndexOf(".")+1),l=ye[f]||{};Object.assign(t,{key:t.path,label:d,is_dir:!1,language:l.language||"plaintext",can_run:l.can_run||!1,disabled:l.disabled||!l.language||!l.can_run||!1,prefix:()=>l.icon||xe})}}})};return o(c),c}async function m(){_.value=!1,setTimeout(()=>{G()},I.value?0:500)}function G(){u.value="",r.value="",x.value={}}function L(){u.value=i("page.code.selectFileTitle"),r.value="",x.value={}}return g({open:H}),(c,o)=>{const s=Ne,t=P,d=Z,f=oe,l=se,D=ie,R=re,J=ce,K=P,q=de,Q=pe,S=ue,W=_e,X=fe,Y=he;return e(I)?(C(),z(Y,{key:1,show:e(_),"onUpdate:show":o[3]||(o[3]=h=>b(_)?_.value=h:null),height:"calc(var(--vh) * 100)",width:"100vw",placement:"right","auto-focus":!1,onAfterLeave:m},{default:a(()=>[n(X,{"header-style":"height: 60px; padding: 16px 12px","body-content-style":"padding: 0; overscroll-behavior: none","footer-style":"padding: 16px 24px"},{header:a(()=>[n(Q,{style:{gap:"4px"}},{default:a(()=>[n(K,{size:28,color:"var(--app-primary-color)"},{default:a(()=>[n(s,{style:{"vertical-align":"0"}})]),_:1}),n(q,{style:{height:"100%","max-width":"260px"}},{tooltip:a(()=>[v("span",null,k(e(u)),1)]),default:a(()=>[v("span",Be,k(e(u)),1)]),_:1})]),_:1})]),footer:a(()=>[n(W,{inline:"",wrap:!1,justify:"space-between",style:{gap:"0px",width:"100%"}},{default:a(()=>[n(S,{tertiary:"",focusable:!1,style:{width:"50%","border-radius":"8px","margin-left":"-4px"},onClick:m},{default:a(()=>[O(k(e(i)("common.cancelText")),1)]),_:1}),n(S,{secondary:"",type:"primary",focusable:!1,style:{width:"50%","border-radius":"8px","margin-left":"8px"},onClick:E},{default:a(()=>[O(k(e(i)("common.okText")),1)]),_:1})]),_:1})]),default:a(()=>[n(R,{bordered:!1,class:"tree-container",style:{height:"100%","word-break":"unset"},"content-style":"display: flex; flex-direction: column; height: 100%; padding: 0.8em 0 0 0.5rem"},{default:a(()=>[v("div",Le,[n(f,{value:e(p),"onUpdate:value":o[2]||(o[2]=h=>b(p)?p.value=h:null),clearable:"",placeholder:e(i)("page.code.searchInputPlaceholder")},{prefix:a(()=>[n(d)]),_:1},8,["value","placeholder"])]),n(D,{"x-scrollable":"",class:"flex-1 pr-2",style:{height:"100%"}},{default:a(()=>[n(l,{ref_key:"fileTreeRef",ref:w,"expand-on-click":"","block-line":"",animated:!1,"default-selected-keys":[e(r)],"show-irrelevant-nodes":!1,pattern:e(p),data:e(T),"default-expanded-keys":e(F),"override-default-node-click-behavior":e(V),"on-update:expanded-keys":e(j),"on-update:selected-keys":B},null,8,["default-selected-keys","pattern","data","default-expanded-keys","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])):(C(),z(J,{key:0,show:e(_),"onUpdate:show":o[1]||(o[1]=h=>b(_)?_.value=h:null),preset:"dialog","auto-focus":!1,"mask-closable":!1,title:e(u),"positive-text":e(i)("common.okText"),"negative-text":e(i)("common.cancelText"),"positive-button-props":{disabled:!e(r)},"negative-button-props":{ghost:!1,tertiary:!0},style:{width:"600px"},"on-close":m,onNegativeClick:m,onPositiveClick:E},{icon:a(()=>[n(t,{size:26},{default:a(()=>[n(s,{style:{"vertical-align":"-0.1em"}})]),_:1})]),default:a(()=>[n(R,{bordered:!1,class:"tree-container",style:{height:"480px","word-break":"unset"},"content-style":"height: 100%; padding: 1em 0 0 0; "},{default:a(()=>[v("div",Ee,[n(f,{value:e(p),"onUpdate:value":o[0]||(o[0]=h=>b(p)?p.value=h:null),clearable:"",style:{"margin-bottom":".5em"},placeholder:e(i)("page.code.searchInputPlaceholder")},{prefix:a(()=>[n(d)]),_:1},8,["value","placeholder"])]),n(D,{"x-scrollable":"",class:"flex-1 pr-3",style:{height:"420px"}},{default:a(()=>[n(l,{ref_key:"fileTreeRef",ref:w,"expand-on-click":"","block-line":"","show-line":"",style:{height:"100%"},"default-selected-keys":[e(r)],"show-irrelevant-nodes":!1,pattern:e(p),data:e(T),"default-expanded-keys":e(F),"override-default-node-click-behavior":e(V),"render-label":e(be),"on-update:expanded-keys":e(j),"on-update:selected-keys":B},null,8,["default-selected-keys","pattern","data","default-expanded-keys","override-default-node-click-behavior","render-label","on-update:expanded-keys"])]),_:1})]),_:1})]),_:1},8,["show","title","positive-text","negative-text","positive-button-props"]))}}}),Ue=Te(De,[["__scopeId","data-v-0886a317"]]);export{Ue as S};
