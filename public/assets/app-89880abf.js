import{_ as Me}from"./app-564c9d98.js";import{az as Re,aq as Q,T as f,a5 as D,G as Oe,bk as $e,bl as Ee,A as p,ad as l,b8 as G,b9 as se,n as H,av as W,bm as Ve,S as m,V as s,aw as d,b7 as z,ak as w,W as i,ax as Fe,F as t,at as A,a6 as Le,a3 as Ue,ab as j,b2 as Pe,aN as h,as as _,aL as qe,a4 as Ke,ar as ie,ba as Ge,bb as He,bc as We,b0 as je,bd as re,aT as Je,aG as Qe,a7 as Xe,be as Ye,aW as Ze}from"./vendor-ca0e89fa.js";import{I as ea,B as aa,a as ce,b as J,e as ta,f as na,g as la,_ as oa,h as sa}from"./app-e679d563.js";import{b as $,m as ia,l as ue}from"./app-35107225.js";import{I as ra}from"./app-5d8356b8.js";import{a as E}from"./app-a04700e8.js";import{I as V,M as ca}from"./app-80447c1f.js";import{_ as ua}from"./app-15ced056.js";import{d as pe,a as de,c as be,b as fe,s as pa,e as da,g as ba,f as fa}from"./app-7cf80934.js";import{u as ma}from"./app-40fcbbd5.js";import{b as va,d as ga}from"./app-dbd4b5f0.js";import{u as ya}from"./app-29b727ba.js";import{u as ha}from"./app-8b99cbcc.js";import"./app-240cd649.js";import"./app-2bf70a96.js";import"./app-80666950.js";import"./app-78be3a52.js";import"./app-52337bf4.js";import"./app-a8b9750a.js";import"./app-4ba2ed38.js";import"./vendor-6c6d1442.js";const _a={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function ka(ve,u){return f(),Q("svg",_a,u[0]||(u[0]=[D("path",{fill:"currentColor",d:"M12 14c-2.42 0-4.7-.6-6-1.55V9.64c1.47.83 3.61 1.36 6 1.36s4.53-.53 6-1.36v2.44c.33-.05.66-.08 1-.08s.67.03 1 .08V7c0-2.21-3.58-4-8-4S4 4.79 4 7v10c0 2.21 3.59 4 8 4h.29a7.4 7.4 0 0 1-.29-2c-3.87 0-6-1.5-6-2v-2.23c1.61.78 3.72 1.23 6 1.23c.24 0 .47 0 .7-.03c.4-.83.95-1.56 1.62-2.16c-.74.12-1.52.19-2.32.19m0-9c3.87 0 6 1.5 6 2s-2.13 2-6 2s-6-1.5-6-2s2.13-2 6-2m10.7 14.6v-1l1.1-.8c.1-.1.2-.2.1-.3l-1-1.7c0-.1-.2-.1-.3-.1l-1.2.5c-.3-.2-.6-.4-.9-.5l-.2-1.3c0-.1-.1-.2-.2-.2h-2c-.2 0-.3.1-.3.2l-.2 1.3c-.3.2-.5.3-.8.5l-1.2-.5c-.1 0-.2 0-.3.1l-1 1.7c0 .1 0 .2.1.3l1.1.8v1l-1.1.8c-.1.1-.2.2-.1.3l1 1.7c.1.1.2.1.3.1l1.2-.5c.2.2.5.4.8.5l.2 1.3c.1.1.2.2.3.2h2c.1 0 .2-.1.2-.2l.2-1.3c.3-.2.5-.3.8-.5l1.2.4c.1 0 .2 0 .3-.1l1-1.7c.1-.1.1-.2 0-.2zm-3.7.9c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5s1.5.7 1.5 1.5s-.7 1.5-1.5 1.5"},null,-1)]))}const me=Re({name:"mdi-database-cog-outline",render:ka}),Ca={key:3},xa={class:"table-toolbar-right-icon"},Sa={style:{color:"var(--app-primary-color)"}},Ha=Oe({__name:"index",setup(ve){const{getIsMobile:u}=ma(),{t:a}=va(),{getLocale:X}=ha(),ge=X.value==="zh_CN"?$e:Ee,{message:v,confirm:F}=ga(),Y=p("fade-slide");ya(Y);const b=p("ordinary"),ye=p([{type:"ordinary",name:a("page.env.type.ordinary")},{type:"composite",name:a("page.env.type.composite")}]),Z=p([]),ee=p(),g=p([]),ae=p(!1),I=p(!1),y=p(""),te=p(),T=p([]),N=p(""),B=p(""),L={padding:"2px",borderRadius:"3px",lineHeight:"1",color:"var(--app-foreground-color)",background:"var(--app-primary-color)"},U=p(),M=p(),he=p([{label:()=>l(z,{style:{color:"var(--app-info-color)"}},{default:()=>a("page.env.table.action.enable.button")}),key:"enable",icon:()=>l(d,{color:"var(--app-info-color)"},{default:()=>l(E)}),props:{onClick:()=>{oe(!0)}}},{label:a("page.env.table.action.disable.button"),key:"disable",icon:()=>l(d,null,{default:()=>l(V)}),props:{onClick:()=>{oe(!1)}}},{label:()=>l(z,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>$({color:"var(--app-error-color)"}),props:{onClick:()=>{Se()}}}]),_e=[{type:"selection",key:"selection",width:42},{title:a("page.env.table.title.type"),key:"type",resizable:!0,width:280,render(e){return l(G,{patterns:T.value,highlightStyle:L,text:e.type,style:{fontFamily:"var(--app-font-family-mono)"}})}},{title:a("page.env.table.title.value"),key:"value",resizable:!0,render(e){if(e.envs===void 0)return l(G,{patterns:T.value,highlightStyle:L,text:e.value,style:{fontFamily:"var(--app-font-family-mono)"}});const n=e.envs;return l(w,{strong:!0,secondary:!0,size:"small",focusable:!0,onClick:()=>M.value?.open(e)},{default:()=>a("page.env.table.manageItems",[n])})}},{title:a("page.env.table.title.tag_list"),key:"tag_list",resizable:!0,width:200,render(e){try{const n=e.tag_list;if(!n)return"";const o=JSON.parse(n||"['']");if(!Array.isArray(o))return"";const r=[];if(o.forEach(x=>{const{label:C,color:S}=x;r.push(l(se,{bordered:!1,color:{color:H(S).setAlpha(.12).toHex8String(),borderColor:H(S).toHexString(),textColor:H(S).toHexString()}},{default:()=>C}))}),r.length>0)return l(W,{style:"gap: 4px"},{default:()=>r})}catch{}return""}},{title:a("page.env.table.title.description"),key:"description",resizable:!0,width:200,render(e){return l(G,{patterns:T.value,highlightStyle:L,text:e.description})}},{title:a("page.env.table.title.update_time"),key:"update_time",align:"center",width:170,render(e){return e.update_time?Date.now()-new Date(e.update_time).getTime()<1e3*60*60?Ve(new Date(e.update_time),{addSuffix:!0,locale:ge}):e.update_time:a("page.env.table.update_time.never")},sorter:!0,defaultSortOrder:!1},{title:a("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:u.value?void 0:"right",renderFilterIcon:()=>l(d,null,{default:()=>l(ea)}),render(e){return l(se,{type:e.enable===1?"success":"error",bordered:!1,style:X.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?a("common.active"):a("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:a("common.active"),value:1},{label:a("common.inactive"),value:0}],filter(){}}];function R(e,n){switch(e){case"edit":return{icon:l(d,{size:20},{default:()=>l(ue)}),tooltip:a("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:ne.bind(null,n)};case"changeStatus":return{icon:l(d,{size:20},{default:()=>l(n.enable===1?V:E)}),tooltip:n.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:le.bind(null,n)};case"manage":return{icon:l(d,null,{default:()=>l(me)}),tooltip:a("page.env.table.action.manage"),quaternary:!0,focusable:!1,onClick:()=>M.value?.open(n)}}}const ke={title:a("page.env.table.title.action"),key:"action",titleAlign:u.value?"center":"left",width:u.value?68:140,fixed:"right",render(e){const n=b.value==="composite",o={edit:{label:a("page.env.table.action.edit"),key:"edit",icon:()=>l(d,{size:20},{default:()=>l(ue)}),props:{onClick:ne.bind(null,e)}},delete:{label:()=>l(z,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>$({color:"var(--app-error-color)"}),props:{onClick:Ce.bind(null,e)}},changeStatus:{label:e.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>l(d,null,{default:()=>l(e.enable===1?V:E)}),props:{onClick:le.bind(null,e)}},manage:{label:a("page.env.table.action.manage"),key:"manage",icon:()=>l(d,null,{default:()=>l(me)}),props:{onClick:()=>M.value?.open(e)}},sort:{label:a("page.env.table.action.sort.title"),key:"sort",icon:()=>l(d,null,{default:()=>l(sa)}),children:[{label:a("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>l(d,null,{default:()=>l(ta)}),props:{onClick:P.bind(null,e,"up")}},{label:a("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>l(d,null,{default:()=>l(na)}),props:{onClick:P.bind(null,e,"down")}},{label:a("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>l(d,null,{default:()=>l(la)}),props:{onClick:P.bind(null,e,"top")}}]},export:{label:a("page.env.table.action.export"),key:"export",icon:()=>l(d,{size:"16"},{default:()=>l(ia)}),props:{onClick:xe.bind(null,e)}}};let r;return n?u.value?r={style:"button",actions:[],dropDownActions:[o.edit,o.manage,o.changeStatus,o.sort,o.delete]}:r={style:"button",actions:[R("edit",e),R("manage",e)],dropDownActions:[o.changeStatus,o.sort,o.delete]}:u.value?r={style:"button",actions:[],dropDownActions:[o.edit,o.changeStatus,o.export,o.sort,o.delete]}:r={style:"button",actions:[R("edit",e),R("changeStatus",e)],dropDownActions:[o.export,o.sort,o.delete]},l(oa,r)}};async function ne(e){U.value?.open(b.value,e)}function Ce(e){F.error({title:a("page.env.table.action.delete.title"),content:a("page.env.table.action.delete.confirm"),icon:()=>$({color:"var(--app-error-color)"}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{b.value==="composite"?await pe({id:e.id}):await de({id:e.id}),v.success(a("page.env.table.message.delete.ok"))}catch{v.error(a("page.env.table.message.delete.fail"))}finally{k()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}async function le(e){try{const n={id:e.id,enable:e.enable===0?1:0};b.value==="composite"?await be(n):await fe(n),v.success(e.enable===1?a("page.env.table.message.disable.ok"):a("page.env.table.message.enable.ok"),{duration:1500}),e.enable=e.enable===0?1:0}catch{v.error(e.enable===1?a("page.env.table.message.disable.fail"):a("page.env.table.message.enable.fail"))}}async function xe(e){v.info(`export ${e.type}="${e.value}"`,{keepAliveOnHover:!0,duration:3e3})}async function P(e,n){const o=b.value==="composite",{id:r,sort:x}=e;try{let C;switch(n){case"up":C={id:r,order:x+1};break;case"down":C={id:r,order:x-1};break;case"top":C={id:r,moveToEnd:!0};break;default:return}o?await pa(C):await da(C),v.success(a("page.env.table.message.sort.ok")),k()}catch{}}function Se(){F.error({title:a("page.env.table.action.delete.batchTitle"),content:a("page.env.table.action.delete.batchConfirm"),icon:()=>$({size:24,color:"var(--app-error-color)"}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=g.value.map(o=>Number(o));b.value==="composite"?await pe({id:e}):await de({id:e}),v.success(a("page.env.table.message.delete.ok"))}catch{v.error(a("page.env.table.message.delete.fail"))}finally{k()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function oe(e){F.info({title:a(`page.env.table.action.${e?"enable":"disable"}.batchTitle`),content:a(`page.env.table.action.${e?"enable":"disable"}.batchConfirm`),icon:()=>l(d,{size:24},{default:()=>l(e?E:V)}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{b.value==="composite"?await be({id:g.value.map(o=>Number(o)),enable:e?1:0}):await fe({id:g.value.map(o=>Number(o)),enable:e?1:0}),v.success(a(`page.env.table.message.${e?"enable":"disable"}.ok`))}catch{v.error(a(`page.env.table.message.${e?"enable":"disable"}.fail`))}finally{k()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function k(){setTimeout(()=>{ee.value?.reload()},250),g.value=[]}function q(){I.value=!0,k(),I.value=!1}function O(){y.value="",T.value=[],k()}function we(e){Z.value=e.enable}async function Ie(e){switch(e.order){case"ascend":N.value=e.columnKey,B.value="0";break;case"descend":N.value=e.columnKey,B.value="1";break;case!1:N.value="",B.value="";break}k()}async function Te(e){const n=b.value==="composite";let o;const r={page:e.page,size:e.size,search:y.value||"",enable:Z.value.join(","),orderBy:N.value,order:B.value};return n?o=await ba(r):o=await fa(r),y.value&&(T.value=[String(y.value)]),o}async function K(e){switch(e){case"createEnv":U.value?.open(b.value);break;case"showSearchBar":ae.value=!0,Ze().then(()=>{te.value?.focus()});break}}return(e,n)=>{const o=Ye,r=Je,x=He,C=Ge,S=je,ze=We,Ae=qe,De=Pe,Ne=Fe,Be=Me;return f(),m(Be,{"content-full":"","no-header":""},{default:s(()=>[i(Ne,{id:"env-table-drawer-target",bordered:!t(u),style:{height:"100%"},"header-style":t(u)?{padding:"0 10px"}:{},"content-style":{padding:t(u)?"6px 10px 10px 10px":"12px 18px"}},{header:s(()=>[t(u)?(f(),m(r,{key:0,value:t(b),"onUpdate:value":[n[0]||(n[0]=c=>A(b)?b.value=c:null),O],type:"segment",size:"small",animated:""},{default:s(()=>[(f(!0),Q(Qe,null,Xe(t(ye),c=>(f(),m(o,{key:c.type,name:c.type},{default:s(()=>[h(_(c.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["value"])):ie("",!0)]),default:s(()=>[i(t(aa),{ref_key:"tableRef",ref:ee,"checked-row-keys":t(g),"onUpdate:checkedRowKeys":n[7]||(n[7]=c=>A(g)?g.value=c:null),"table-id":"ENV","pagination-behavior-on-filter":"first",columns:_e,request:Te,"row-key":c=>`${c.id}`,"action-column":ke,"onUpdate:filters":we,"onUpdate:sorter":Ie},Le({tableTitle:s(()=>[i(t(W),{wrap:!1},{default:s(()=>[t(u)?(f(),m(t(w),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 5px"},focusable:!1,onClick:n[2]||(n[2]=c=>K("createEnv"))},{icon:s(()=>[i(t(ra))]),_:1})):(f(),m(t(w),{key:0,type:"primary",focusable:!1,onClick:n[1]||(n[1]=c=>K("createEnv"))},{default:s(()=>[h(_(t(a)("page.env.table.new")),1)]),_:1})),t(u)?ie("",!0):(f(),m(C,{key:2,value:t(b),"onUpdate:value":n[3]||(n[3]=c=>A(b)?b.value=c:null),variant:"default-filled",onChange:O},{default:s(()=>[i(x,{value:"ordinary",style:{height:"30px"}},{default:s(()=>[h(_(t(a)("page.env.type.ordinary")),1)]),_:1}),i(x,{value:"composite",style:{height:"30px"}},{default:s(()=>[h(_(t(a)("page.env.type.composite")),1)]),_:1})]),_:1},8,["value"])),t(u)?(f(),m(S,{key:4,value:t(y),"onUpdate:value":n[6]||(n[6]=c=>A(y)?y.value=c:null),loading:t(I)||void 0,size:"small",clearable:"",placeholder:t(a)("page.env.table.search.placeholder"),onClear:O,onKeyup:re(q,["enter"])},{prefix:s(()=>[i(t(J))]),_:1},8,["value","loading","placeholder"])):(f(),Q("div",Ca,[t(ae)?(f(),m(j,{key:1,name:t(Y),mode:"default",appear:""},{default:s(()=>[i(ze,null,{default:s(()=>[i(S,{ref_key:"searchBarInputRef",ref:te,value:t(y),"onUpdate:value":n[5]||(n[5]=c=>A(y)?y.value=c:null),disabled:t(I),loading:t(I)||void 0,clearable:"",placeholder:t(a)("page.env.table.search.placeholder"),onClear:O,onKeyup:re(q,["enter"])},{prefix:s(()=>[i(t(J))]),_:1},8,["value","disabled","loading","placeholder"]),i(t(w),{strong:"",secondary:"",type:"primary",onClick:q},{default:s(()=>[h(_(t(a)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(f(),m(t(w),{key:0,strong:"",secondary:"",style:{padding:"0 8px"},focusable:!1,onClick:n[4]||(n[4]=c=>K("showSearchBar"))},{icon:s(()=>[i(t(J))]),_:1}))]))]),_:1})]),toolbar:s(()=>[Ue(i(j,{name:"fade-slide-left",mode:"out-in",appear:""},{default:s(()=>[i(t(W),{wrap:!1},{default:s(()=>[i(De,{size:"small",trigger:"click",options:t(he)},{default:s(()=>[t(u)?(f(),m(Ae,{key:1,trigger:"hover"},{trigger:s(()=>[D("div",xa,[i(t(d),{size:"20"},{default:s(()=>[i(t(ce))]),_:1})])]),default:s(()=>[D("span",null,_(t(a)("page.env.table.action.batchAction")),1)]),_:1})):(f(),m(t(w),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px"},focusable:!1},{icon:s(()=>[i(t(ce))]),default:s(()=>[h(" "+_(t(a)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[Ke,t(g).length]])]),_:2},[t(g).length&&!t(u)?{name:"info",fn:s(()=>[i(j,{name:"fade",mode:"out-in",appear:""},{default:s(()=>[D("div",null,[i(t(z),null,{default:s(()=>[h(_(t(a)("common.selected")),1)]),_:1}),n[8]||(n[8]=h("  ")),D("span",Sa,_(t(g).length),1),n[9]||(n[9]=h("  ")),i(t(z),null,{default:s(()=>[h(_(t(a)("common.item")),1)]),_:1})])]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["bordered","header-style","content-style"]),i(ua,{ref_key:"editEnv",ref:U,onOk:k},null,512),i(ca,{ref_key:"manageValue",ref:M,onOk:k},null,512)]),_:1})}}});export{Ha as default};
