import{_ as B,C as V,a as K}from"./app-3a6dce02.js";import{az as X,aq as ee,T as u,a5 as a,G as te,r as ne,J as oe,S as _,F as t,bv as ae,a9 as N,at as I,V as e,W as n,ax as le,ar as R,as as d,av as se,aL as ie,ak as re,aw as ce,aQ as ue,aO as q,bt as pe,aN as M,b6 as _e,aY as de,bu as fe}from"./vendor-ca0e89fa.js";import{_ as ge,a as me}from"./app-4ba2ed38.js";import{g as ye,f as ve,i as he}from"./app-2733701f.js";import{u as xe}from"./app-40fcbbd5.js";import{d as we,b as ke,h as be,i as Ce}from"./app-dbd4b5f0.js";const ze={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Le(D,x){return u(),ee("svg",ze,x[0]||(x[0]=[a("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16m-7.5 12H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7M8 4v4m8 14l5-5m0 4.5V17h-4.5"},null,-1)]))}const Se=X({name:"tabler-browser-share",render:Le}),Ee={style:{"font-size":"26px"}},Fe={style:{"font-family":"var(--app-font-family-mono)"}},Te={style:{"font-size":"28px"}},$e={style:{"vertical-align":"-5px",padding:"0 2px"}},Me=te({__name:"viewSourceFile",setup(D,{expose:x}){const{message:j}=we(),{t:i}=ke(),{getIsMobile:A}=xe(),G=be(),O=ne({title:i("page.cron.table.source"),formatTitle:"",path:"",show:!1,icon:null,showFullScreen:!1,editorRef:null,editorValue:{content:"",language:"plaintext"}}),{title:m,formatTitle:w,path:y,show:r,icon:b,showFullScreen:f,editorRef:k,editorValue:g}=oe(O);async function P(s){try{y.value=typeof s.config=="object"&&s.config.source_file?s.config.source_file:s.script_path}catch{}if(y.value){m.value=y.value.split("/").pop(),w.value=m.value.replace(/\.[^/.]+$/,"");try{await U(y.value)}finally{g.value.content?r.value=!0:j.warning(i("page.cron.viewSourceFile.noScriptMsg"))}}}async function U(s){const o=await ye({path:s}),z=s.substring(s.lastIndexOf(".")+1),h=ve[z]||{};g.value={content:o,language:h.language||"plaintext"},b.value=()=>h.language?h.icon:he()}function C(s){switch(s){case"goEdit":r.value=!1,G(`${Ce.CODE_EDIT_PAGE}?path=${y.value}`);break;case"fullScreen":f.value=!f.value;break}}async function c(){r.value=!1,f.value=!1,y.value="",g.value={content:"",language:"plaintext"},setTimeout(()=>{m.value="",w.value=""},500)}return x({open:P}),(s,o)=>{const z=ge,h=me,v=ce,p=re,L=ie,S=se,F=Se,T=K,$=ue,W=le,H=ae,J=_e,Q=de,Y=fe,Z=pe;return t(A)?(u(),_(Z,{key:1,show:t(r),"onUpdate:show":o[4]||(o[4]=l=>I(r)?r.value=l:null),height:"calc(var(--vh) * 100)",width:"100vw",placement:"bottom","auto-focus":!1,"mask-closable":!1,onMaskClick:c,onAfterLeave:c},{default:e(()=>[n(Y,{"header-style":"height: 60px; padding: 16px 12px","body-content-style":"padding: 0; overscroll-behavior: none","footer-style":"padding: 16px 24px 24px 24px"},{header:e(()=>[n($,{style:{gap:"4px"}},{default:e(()=>[a("div",Te,[(u(),_(q(t(b)),{style:{"vertical-align":"-0.15em"}}))]),n(J,{style:{height:"100%","max-width":"190px"}},{tooltip:e(()=>[a("span",null,d(t(m)),1)]),default:e(()=>[a("span",$e,d(t(w)||t(m)),1)]),_:1}),t(g).content?(u(),_(Q,{key:0,style:{"padding-left":"8px"}},{default:e(()=>[n(L,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(p,{secondary:"",size:"small",focusable:!1,onClick:o[3]||(o[3]=l=>C("goEdit"))},{icon:e(()=>[n(v,{size:16},{default:e(()=>[n(F)]),_:1})]),_:1})]),default:e(()=>[a("span",null,d(t(i)("page.cron.viewSourceFile.goEditBtn")),1)]),_:1}),n(t(V),{editor:t(k)},{trigger:e(({show:l,toggleShow:E})=>[n(p,{secondary:"",type:l?"primary":"default",size:"small",focusable:!1,style:{padding:"6px"},onClick:E},{icon:e(()=>[n(v,{size:16},{default:e(()=>[n(T)]),_:1})]),_:2},1032,["type","onClick"])]),_:1},8,["editor"])]),_:1})):R("",!0)]),_:1})]),default:e(()=>[n(t(B),{ref_key:"editorRef",ref:k,value:t(g),style:{height:"100%"},"mobile-keyboard-control-widgt-props":{bottom:94}},null,8,["value"])]),footer:e(()=>[n(S,{inline:"",wrap:!1,justify:"space-between",style:{gap:"0px",width:"100%"}},{default:e(()=>[n(p,{tertiary:"",style:{width:"50%","border-radius":"8px","margin-left":"-4px"},focusable:!1,onClick:c},{default:e(()=>[M(d(t(i)("common.cancelText")),1)]),_:1}),n(p,{secondary:"",type:"primary",style:{width:"50%","border-radius":"8px","margin-left":"8px"},focusable:!1,onClick:c},{default:e(()=>[M(d(t(i)("common.okText")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])):(u(),_(H,{key:0,show:t(r),"onUpdate:show":o[2]||(o[2]=l=>I(r)?r.value=l:null),preset:"dialog","auto-focus":!1,style:N({width:t(f)?"calc(-20px + 100vw)":"1200px",maxWidth:"calc(-20px + 100vw)",background:"var(--app-background)"}),"positive-text":t(i)("common.okText"),"negative-text":t(i)("common.cancelText"),"negative-button-props":{ghost:!1,tertiary:!0},"on-close":c,"on-mask-click":c,onNegativeClick:c,onPositiveClick:c},{close:e(()=>[n(S,null,{default:e(()=>[n(L,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(p,{size:"tiny",quaternary:"",focusable:!1,style:{padding:"4px"},onClick:o[0]||(o[0]=l=>C("fullScreen"))},{icon:e(()=>[n(v,{size:20,depth:2},{default:e(()=>[t(f)?(u(),_(h,{key:1})):(u(),_(z,{key:0}))]),_:1})]),_:1})]),default:e(()=>[a("span",null,d(t(f)?t(i)("layout.header.tooltipExitFull"):t(i)("layout.header.tooltipEntryFull")),1)]),_:1}),n(p,{size:"tiny",quaternary:"",focusable:!1,style:{padding:"4px"},onClick:c},{icon:e(()=>[n(v,{size:18,depth:2},{default:e(()=>o[5]||(o[5]=[a("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},[a("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[a("g",{fill:"currentColor","fill-rule":"nonzero"},[a("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"})])])],-1)])),_:1})]),_:1})]),_:1})]),icon:e(()=>[a("div",Ee,[(u(),_(q(t(b)),{style:{"vertical-align":"-0.15em"}}))])]),header:e(()=>[n($,null,{default:e(()=>[a("span",Fe,d(t(w)||t(m)),1),t(g).content?(u(),_(S,{key:0,style:{gap:"0"}},{default:e(()=>[n(L,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(p,{quaternary:"",size:"small",focusable:!1,style:{padding:"6px"},onClick:o[1]||(o[1]=l=>C("goEdit"))},{icon:e(()=>[n(v,{size:16},{default:e(()=>[n(F)]),_:1})]),_:1})]),default:e(()=>[a("span",null,d(t(i)("page.cron.viewSourceFile.goEditBtn")),1)]),_:1}),n(t(V),{editor:t(k)},{trigger:e(({show:l,toggleShow:E})=>[n(p,{quaternary:!l,tertiary:l,type:l?"primary":"default",size:"small",focusable:!1,style:{padding:"6px"},onClick:E},{icon:e(()=>[n(v,{size:20},{default:e(()=>[n(T)]),_:1})]),_:2},1032,["quaternary","tertiary","type","onClick"])]),_:1},8,["editor"])]),_:1})):R("",!0)]),_:1})]),default:e(()=>[n(W,{bordered:!1,style:N({height:t(f)?"calc(-140px + 100vh)":"72vh",wordBreak:"unset"}),"content-style":{height:"100%",padding:"1em 0 0 0",paddingTop:"0"}},{default:e(()=>[n(t(B),{ref_key:"editorRef",ref:k,value:t(g),style:{height:"100%"}},null,8,["value"])]),_:1},8,["style"])]),_:1},8,["show","style","positive-text","negative-text"]))}}});export{Me as _};
