import{aJ as be,a3 as u,aC as q,ah as z,G as Me,bh as Pe,bi as Ke,y as c,ap as s,b5 as N,r as Le,J as je,bl as se,bj as He,a6 as o,a5 as l,F as n,a4 as m,aw as S,aE as K,aD as v,aF as B,ai as Je,aP as x,aH as ie,bm as re,am as ce,af as Ge,ag as Qe,aO as We,as as Xe,a_ as Ye,aQ as Ze,b6 as et,aR as tt,ba as at,bp as nt,b1 as lt,b7 as ot,aI as st,bx as it,cs as rt,by as ct,bK as ut,bD as pt}from"./vendor-191e7315.js";import{_ as dt,B as bt,a as mt}from"./app-f9e7f085.js";import{_ as vt}from"./app-05ca0384.js";import{_ as ft}from"./app-1a3e2845.js";import{_ as gt}from"./app-27366806.js";import{_ as _t}from"./app-9896b868.js";import{a as ue,b as pe,e as de,h as yt}from"./app-13b90414.js";import{I as r}from"./app-9f5af7f8.js";import{u as ht}from"./app-9adaac50.js";import{d as kt,b as xt,e as wt}from"./app-16ee8ad9.js";import{u as Ct}from"./app-20e510c8.js";import{u as Tt}from"./app-d9e67733.js";import"./app-863f7b38.js";import"./app-f9713fa5.js";import"./app-41e2b8bc.js";import"./app-651c5cb6.js";import"./vendor-2714f153.js";const St={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function zt(L,w){return u(),q("svg",St,w[0]||(w[0]=[z("path",{fill:"currentColor",d:"m7.825 13l4.9 4.9q.3.3.288.7t-.313.7q-.3.275-.7.288t-.7-.288l-6.6-6.6q-.15-.15-.213-.325T4.426 12t.063-.375t.212-.325l6.6-6.6q.275-.275.688-.275t.712.275q.3.3.3.713t-.3.712L7.825 11H19q.425 0 .713.288T20 12t-.288.713T19 13z"},null,-1)]))}const $t=be({name:"material-symbols-arrow-back-rounded",render:zt}),Bt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Dt(L,w){return u(),q("svg",Bt,w[0]||(w[0]=[z("path",{fill:"currentColor",d:"m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z"},null,-1)]))}const It=be({name:"material-symbols-chevron-left-rounded",render:Dt}),Ot={key:1,style:{"text-align":"center","font-weight":"600"}},Nt={style:{"vertical-align":"-5px",padding:"0 2px"}},qt={style:{"text-align":"center","font-weight":"600"}},At={key:3},Et={class:"table-toolbar-right-icon"},Rt={style:{color:"var(--app-primary-color)"}},Vt=Me({__name:"manageValue",emits:["ok"],setup(L,{expose:w,emit:me}){const ve=me,{getIsMobile:p}=ht(),{getLocale:j}=Tt(),fe=j.value==="zh_CN"?Pe:Ke,{message:d,confirm:V}=kt(),{t:a}=xt(),H=c("fade-slide");Ct(H);const F=c(),J=c(),G=c(),Q=c([]),_=c([]),W=c(!1),D=c(!1),y=c(""),X=c(),A=c("sort"),h=c("0"),I=c(!1),k=c(null),E=c(null),ge=c([{label:()=>s(N,{style:{color:"var(--app-info-color)"}},{default:()=>a("page.env.table.action.enable.button")}),key:"enable",icon:()=>s(r,{icon:"tabler:variable",color:"var(--app-info-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{ae(!0)}}},{label:a("page.env.table.action.disable.button"),key:"disable",icon:()=>s(r,{icon:"tabler:variable-off",style:"vertical-align: baseline"},{}),props:{onClick:()=>{ae(!1)}}},{label:()=>s(N,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>s(r,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{Ce()}}}]),f=Le({title:"",show:!1,model:{}}),{show:R,title:U}=je(f),_e=[{type:"selection",key:"selection",width:46},{title:a("page.env.table.title.sort"),key:"sort",align:"center",titleAlign:"center",width:88,sorter:!0,defaultSortOrder:!1,render(e){return s(se,{size:"small",bordered:!1,style:"font-weight: 600"},{default:()=>e.sort})}},{title:a("page.env.table.title.value"),key:"value",resizable:!0,render(e){return s("span",{style:{fontFamily:"var(--app-font-family-mono)"}},String(e.value||""))}},{title:a("page.env.table.title.remark"),key:"remark",resizable:!0,width:200},{title:a("page.env.table.title.update_time"),key:"update_time",align:"center",width:170,render(e){return e.update_time?Date.now()-new Date(e.update_time).getTime()<1e3*60*60?He(new Date(e.update_time),{addSuffix:!0,locale:fe}):e.update_time:a("page.env.table.update_time.never")},sorter:!0,defaultSortOrder:!1},{title:a("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:p.value?void 0:"right",renderFilterIcon:()=>s(r,{icon:"ic:round-filter-list",style:"vertical-align: baseline"},{}),render(e){return s(se,{type:e.enable===1?"success":"error",bordered:!1,style:j.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?a("common.active"):a("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:a("common.active"),value:1},{label:a("common.inactive"),value:0}],filter(){}}];function Y(e,t){switch(e){case"edit":return{icon:"mdi-square-edit-outline",tooltip:a("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:Z.bind(null,t)};case"changeStatus":return{icon:t.enable===1?"tabler-variable-off":"tabler-variable",tooltip:t.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:ee.bind(null,t)}}}const ye={title:a("page.env.table.title.action"),key:"action",titleAlign:p.value?"center":"left",width:p.value?68:140,fixed:"right",render(e){const t={edit:{label:a("page.env.table.action.edit"),key:"edit",icon:()=>s(r,{icon:"mdi:square-edit-outline",style:"vertical-align: baseline"},{}),props:{onClick:Z.bind(null,e)}},delete:{label:()=>s(N,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>s(r,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:he.bind(null,e)}},changeStatus:{label:e.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>s(r,{icon:e.enable===1?"tabler:variable-off":"tabler:variable",style:"vertical-align: baseline"},{}),props:{onClick:ee.bind(null,e)}},sort:{label:a("page.env.table.action.sort.title"),key:"sort",icon:()=>s(r,{icon:"mdi:sort",style:"vertical-align: baseline"},{}),children:[{label:a("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>s(r,{icon:"material-symbols:arrow-upward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:O.bind(null,e,"up")}},{label:a("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>s(r,{icon:"material-symbols:arrow-downward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:O.bind(null,e,"down")}},{label:a("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>s(r,{icon:"material-symbols:text-select-move-up-rounded",style:"vertical-align: baseline"},{}),props:{onClick:O.bind(null,e,"top")}},{label:a("page.env.table.action.sort.moveBottom"),key:"sortMoveBottom",icon:()=>s(r,{icon:"material-symbols:text-select-move-down-rounded",style:"vertical-align: baseline"},{}),props:{onClick:O.bind(null,e,"bottom")}},{label:a("page.env.table.action.sort.moveSpecify"),key:"sortMoveSpecify",icon:()=>s(r,{icon:"ic:round-numbers",style:"vertical-align: baseline"},{}),props:{onClick:O.bind(null,e,"specify")}}]},export:{label:a("page.env.table.action.export"),key:"export",icon:()=>s(r,{icon:"mdi:content-copy",style:"vertical-align: baseline"},{}),props:{iconProps:{size:"16"},onClick:ke.bind(null,e)}}};let b;return p.value?b={style:"button",actions:[],dropDownActions:[t.edit,t.changeStatus,t.export,t.sort,t.delete]}:b={style:"button",actions:[Y("edit",e),Y("changeStatus",e)],dropDownActions:[t.export,t.sort,t.delete]},s(dt,b)}};async function Z(e){F.value?.open("composite_value",e)}function he(e){V.error({title:a("page.env.table.action.delete.title"),content:a("page.env.table.action.delete.confirm"),icon:()=>s(r,{icon:"fe:trash",style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{await ue({id:e.id}),d.success(a("page.env.table.message.delete.ok"))}catch{d.error(a("page.env.table.message.delete.fail"))}finally{g()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}async function ee(e){try{const t={id:e.id,enable:e.enable===0?1:0};await pe(t),d.success(e.enable===1?a("page.env.table.message.disable.ok"):a("page.env.table.message.enable.ok"),{duration:1500}),e.enable=e.enable===0?1:0}catch{d.error(e.enable===1?a("page.env.table.message.disable.fail"):a("page.env.table.message.enable.fail"))}}async function O(e,t){const{id:b,sort:C}=e;try{let T;switch(t){case"up":T={id:b,order:C+(h.value==="0"?-1:1)};break;case"down":T={id:b,order:C+(h.value==="0"?1:-1)};break;case"top":T=Object.assign({id:b},h.value==="0"?{order:1}:{moveToEnd:!0});break;case"bottom":T=Object.assign({id:b},h.value==="0"?{moveToEnd:!0}:{order:1});break;case"specify":I.value=!0,E.value=b,k.value=C;return;default:return}await de(T),d.success(a("page.env.table.message.sort.ok")),g()}catch{}}async function ke(e){d.info(`export ${f.title}="${e.value}"`,{keepAliveOnHover:!0,duration:3e3})}function xe(){return s(r,{icon:"ic:round-numbers",style:"vertical-align: baseline"},{})}async function we(){try{await de({id:E.value,order:k.value}),d.success(a("page.env.table.message.sort.ok")),g()}catch{}finally{E.value=null,k.value=null}}function te(){I.value=!1,k.value=null,E.value=null}function Ce(){V.error({title:a("page.env.table.action.delete.batchTitle"),content:a("page.env.table.action.delete.batchConfirm"),icon:()=>s(r,{icon:"fe:trash",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=_.value.map(t=>Number(t));await ue({id:e}),d.success(a("page.env.table.message.delete.ok"))}catch{d.error(a("page.env.table.message.delete.fail"))}finally{g()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function ae(e){V.info({title:a(`page.env.table.action.${e?"enable":"disable"}.batchTitle`),content:a(`page.env.table.action.${e?"enable":"disable"}.batchConfirm`),icon:()=>s(r,{icon:e?"tabler:variable":"tabler:variable-off",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{await pe({id:_.value.map(t=>Number(t)),enable:e?1:0}),d.success(a(`page.env.table.message.${e?"enable":"disable"}.ok`))}catch{d.error(a(`page.env.table.message.${e?"enable":"disable"}.fail`))}finally{g()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function g(){setTimeout(()=>{G.value?.reload()},250),_.value=[]}function M(){D.value=!0,g(),D.value=!1}function ne(){y.value="",g()}function Te(e){Q.value=e.enable}async function Se(e){switch(e.order){case"ascend":A.value=e.columnKey,h.value="0";break;case"descend":A.value=e.columnKey,h.value="1";break;case!1:A.value="sort",h.value="0";break}g()}async function ze(e){const t={page:e.page,size:e.size,group_id:f.model.id,search:y.value||"",enable:Q.value.join(","),orderBy:A.value,order:h.value};return await yt(t)}function $e(e={}){const t={id:null,type:"",description:"",tag_list:"",enable:1,separator:"",envs:0};f.model=Xe(t),Object.assign(f.model,e),f.title=f.model.type||"未知变量名",f.show=!0}async function $(e){switch(e){case"createValue":F.value?.open("composite_value",null,f.model.id);break;case"importEnv":J.value?.open(f.model.id);break;case"backEnvTable":R.value=!1,ve("ok");break;case"showSearchBar":W.value=!0,Ye().then(()=>{X.value?.focus()});break}}return w({open:$e}),(e,t)=>{const b=It,C=Ze,T=et,Be=tt,De=ft,P=vt,le=at,Ie=nt,oe=mt,Oe=lt,Ne=ot,qe=st,Ae=it,Ee=$t,Re=rt,Ve=ct,Fe=ut,Ue=pt;return u(),q(We,null,[o(Ve,{show:n(R),"onUpdate:show":t[9]||(t[9]=i=>B(R)?R.value=i:null),height:"calc(var(--vh) * 100)",width:"100%",placement:"right",to:"#env-table-drawer-target","trap-focus":!1,"block-scroll":!1,"auto-focus":!1,"mask-closable":!1},{default:l(()=>[o(Ae,{closable:!1,"header-style":"display: none","body-content-style":"padding: 0"},{header:l(()=>t[14]||(t[14]=[])),default:l(()=>[o(qe,{bordered:!1,style:{height:"100%","background-color":"var(--app-background)"},"header-style":{padding:n(p)?"0 10px":"20px 24px 20px 24px"},"content-style":{height:"100%",padding:n(p)?"10px":"0 24px 20px 24px"}},{header:l(()=>[o(Be,{style:{"align-items":"center"}},{default:l(()=>[n(p)?K("",!0):(u(),m(n(S),{key:0,strong:"",secondary:"",focusable:!1,style:{padding:"0 8px"},onClick:t[0]||(t[0]=i=>$("backEnvTable"))},{icon:l(()=>[o(C,{size:28},{default:l(()=>[o(b,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})),n(p)?(u(),m(T,{key:2,style:{height:"100%","max-width":"190px"}},{tooltip:l(()=>[z("span",qt,v(n(U)),1)]),default:l(()=>[z("span",Nt,v(n(U)),1)]),_:1})):(u(),q("span",Ot,v(n(U)),1))]),_:1})]),default:l(()=>[o(n(bt),{ref_key:"tableRef",ref:G,"checked-row-keys":n(_),"onUpdate:checkedRowKeys":t[7]||(t[7]=i=>B(_)?_.value=i:null),class:"env-sub-table","table-id":"ENV_SUB","pagination-behavior-on-filter":"first",columns:_e,request:ze,"row-key":i=>`${i.id}`,"action-column":ye,"onUpdate:filters":Te,"onUpdate:sorter":Se},Je({tableTitle:l(()=>[o(n(ie),{wrap:!1},{default:l(()=>[n(p)?(u(),m(n(S),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 6px"},focusable:!1,onClick:t[2]||(t[2]=i=>$("createValue"))},{icon:l(()=>[o(De)]),_:1})):(u(),m(n(S),{key:0,type:"primary",size:"small",style:{height:"32px"},focusable:!1,onClick:t[1]||(t[1]=i=>$("createValue"))},{default:l(()=>[x(v(n(a)("page.env.table.newValue")),1)]),_:1})),n(p)?K("",!0):(u(),m(n(S),{key:2,secondary:"",size:"small",style:{height:"32px"},focusable:!1,onClick:t[3]||(t[3]=i=>$("importEnv"))},{default:l(()=>[x(v(n(a)("page.env.table.batchImport")),1)]),_:1})),n(p)?(u(),m(le,{key:4,value:n(y),"onUpdate:value":t[6]||(t[6]=i=>B(y)?y.value=i:null),loading:n(D)||void 0,size:"small",clearable:"",placeholder:n(a)("page.env.table.search.placeholder"),"on-clear":ne,onKeyup:re(M,["enter"])},{prefix:l(()=>[o(P)]),_:1},8,["value","loading","placeholder"])):(u(),q("div",At,[n(W)?(u(),m(ce,{key:1,name:n(H),mode:"default",appear:""},{default:l(()=>[o(Ie,{style:{height:"32px"}},{default:l(()=>[o(le,{ref_key:"searchBarInputRef",ref:X,value:n(y),"onUpdate:value":t[5]||(t[5]=i=>B(y)?y.value=i:null),disabled:n(D),loading:n(D)||void 0,size:"small",clearable:"",placeholder:n(a)("page.env.table.search.placeholder"),"on-clear":ne,onKeyup:re(M,["enter"])},{prefix:l(()=>[o(P)]),_:1},8,["value","disabled","loading","placeholder"]),o(n(S),{strong:"",secondary:"",type:"primary",size:"small",style:{height:"32px"},onClick:M},{default:l(()=>[x(v(n(a)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(u(),m(n(S),{key:0,strong:"",secondary:"",size:"small",style:{padding:"0 8px",height:"32px"},focusable:!1,onClick:t[4]||(t[4]=i=>$("showSearchBar"))},{icon:l(()=>[o(P)]),_:1}))]))]),_:1})]),toolbar:l(()=>[Ge(o(ce,{name:"fade-slide-left",mode:"out-in",appear:""},{default:l(()=>[o(n(ie),{wrap:!1},{default:l(()=>[o(Ne,{size:"small",trigger:"click",options:n(ge)},{default:l(()=>[n(p)?(u(),m(Oe,{key:1,trigger:"hover"},{trigger:l(()=>[z("div",Et,[o(C,{size:"20"},{default:l(()=>[o(oe)]),_:1})])]),default:l(()=>[z("span",null,v(n(a)("page.env.table.action.batchAction")),1)]),_:1})):(u(),m(n(S),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px"},focusable:!1},{icon:l(()=>[o(oe)]),default:l(()=>[x(" "+v(n(a)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[Qe,n(_).length]])]),_:2},[n(_).length&&!n(p)?{name:"info",fn:l(()=>[o(n(N),null,{default:l(()=>[x(v(n(a)("common.selected")),1)]),_:1}),t[15]||(t[15]=x("  ")),z("span",Rt,v(n(_).length),1),t[16]||(t[16]=x("  ")),o(n(N),null,{default:l(()=>[x(v(n(a)("common.item")),1)]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["header-style","content-style"])]),_:1}),n(p)?(u(),m(Re,{key:0,left:20,bottom:20,onClick:t[8]||(t[8]=i=>$("backEnvTable"))},{default:l(()=>[o(C,null,{default:l(()=>[o(Ee)]),_:1})]),_:1})):K("",!0)]),_:1},8,["show"]),o(Ue,{show:n(I),"onUpdate:show":t[11]||(t[11]=i=>B(I)?I.value=i:null),preset:"dialog",style:{width:"360px"},"auto-focus":!1,"mask-closable":!1,icon:xe,title:n(a)("page.env.table.action.sort.moveSpecifyTitle"),"positive-text":n(a)("common.okText"),"negative-text":n(a)("common.cancelText"),"on-close":te,"positive-button-props":{disabled:!n(k)},"negative-button-props":{ghost:!1,tertiary:!0},onNegativeClick:t[12]||(t[12]=i=>te()),onPositiveClick:t[13]||(t[13]=i=>we())},{default:l(()=>[o(Fe,{value:n(k),"onUpdate:value":t[10]||(t[10]=i=>B(k)?k.value=i:null),clearable:"",min:1,max:99999,style:{"margin-top":"5px"}},null,8,["value"])]),_:1},8,["show","title","positive-text","negative-text","positive-button-props"]),o(gt,{ref_key:"editEnv",ref:F,onOk:g},null,512),o(_t,{ref_key:"importEnv",ref:J,onOk:g},null,512)],64)}}}),aa=wt(Vt,[["__scopeId","data-v-7e0433cc"]]);export{aa as default};
