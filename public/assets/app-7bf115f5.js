import{_ as Z}from"./app-e7833723.js";import{b as ee,d as ne,_ as ae}from"./app-b60428ff.js";import{_ as te}from"./app-1ea894c0.js";import{_ as oe}from"./app-60231509.js";import{M as U,a as le,_ as se}from"./app-de2955b8.js";import{aN as ie,a6 as m,aG as re,al as de,G as ce,y as r,B as j,aQ as ue,aR as pe,a7 as v,a8 as l,a9 as a,F as e,aJ as C,aj as fe,ak as _e,aq as A,aT as me,aH as ge,bl as ve,aU as he,aX as ye,aA as be,aL as ke,aV as xe,aM as we}from"./vendor-c495fdf6.js";import{s as Ce,a as H,c as ze,d as Fe,I as Se,g as De,b as Be}from"./app-c86a1b95.js";import{h as z,u as F}from"./app-0f24c8a0.js";import{u as Ee}from"./app-25ce29fa.js";import{F as Ie}from"./app-30b30e0d.js";import"./app-ea00c288.js";import"./app-6e808beb.js";import"./vendor-8fb801c2.js";import"./app-f217d8bf.js";import"./app-72ae05ca.js";import"./app-33d5aac1.js";const Pe={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Te($,c){return m(),re("svg",Pe,c[0]||(c[0]=[de("path",{fill:"currentColor",d:"M10 18H6v-2h4zm0-4H6v-2h4zm0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1zm10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2zm-4 6h-2v-2h2zm0 4h-2v-2h2z"},null,-1)]))}const Ne=ie({name:"mdi-file-compare",render:Te}),Ke=ce({__name:"index",setup($){const{getIsMobile:c}=Ee(),{t:u}=ee(),{message:I}=ne(),S=r([]),D=r([]),P=r({}),d=r(""),p=r(""),h=r(),k=r({content:"",language:""}),q=r(c.value?13:15),b=r(""),G=r(!c.value),x=r(!1),B=r(!1),y=r(!1);async function T(n){switch(n){case"save":x.value=!0;const o=e(h).getValue();try{await Ce({content:o,path:d.value}),I.success(u("editor.main.savedSuccess"))}finally{x.value=!1}break}}async function J(){y.value=!0;const n=await H({}),o=N(n);S.value=o;const i=await H({}),f=N(i);D.value=f,y.value=!1}function N(n){const o=f=>{f.length&&f.forEach(t=>{if(t.type===Ie.FOLDER)Object.assign(t,{key:t.path,label:t.title,disabled:!1,is_dir:!0,prefix:()=>ze(t.title)}),!t.children.length||t.children.length===0?(Object.assign(t,{children:null}),t.prefix=()=>Fe()):o(t.children);else{const g=t.name;if(g){const w=g.substring(g.lastIndexOf(".")+1),_=Be[w]||{};Object.assign(t,{key:t.path,label:g,language:_.language||"plaintext",disabled:_.disabled||!1,is_dir:!1,prefix:()=>_.icon||Se})}}})};o(n);const i=f=>f.filter(t=>t.children?(t.children=i(t.children),!0):!t.disabled);return n=i(n),n}async function O(n,o){B.value=!0;const i=await De({path:encodeURIComponent(n.key)});if(i)switch(o){case"config":k.value={content:i,language:n.language};break;case"sample":b.value=i;break}else{switch(o){case"config":break;case"sample":b.value="";break}I.info(u("page.diff.fileContentIsEmptyMsg"))}B.value=!1}function V({option:n}){return{async onClick(){!n.children&&!n.disabled&&(P.value=n,await O(n,"config"))}}}function L({option:n}){return{async onClick(){!n.children&&!n.disabled&&(P.value=n,await O(n,"sample"))}}}return j(d,n=>{n||(k.value={content:"",language:""})}),j(p,n=>{n||(b.value="")}),ue(async()=>{await J()}),pe(()=>{h.value&&h.value.dispose()}),(n,o)=>{const i=ve,f=Ne,t=he,g=ye,w=se,_=be,R=oe,M=ke,Q=te,W=xe,X=ae,K=we,Y=Z;return m(),v(Y,{"content-full":"","no-header":""},{default:l(()=>[a(K,{bordered:!e(c),style:{height:"100%","word-break":"unset"},segmented:{content:!0},"header-style":"padding: 10px; font-weight: unset","content-style":"padding: 0"},{header:l(()=>[e(c)?(m(),v(g,{key:1,vertical:"",style:{"padding-right":"8px"}},{default:l(()=>[a(i,{value:e(p),"onUpdate:value":o[2]||(o[2]=s=>C(p)?p.value=s:null),size:"small",loading:e(y),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(u)("page.diff.selectSourceFilePlaceholder"),options:e(D),"override-default-node-click-behavior":e(z),"node-props":L,"on-update:expanded-keys":e(F)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"]),a(i,{value:e(d),"onUpdate:value":o[3]||(o[3]=s=>C(d)?d.value=s:null),size:"small",loading:e(y),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(u)("page.diff.selectDestinationFilePlaceholder"),options:e(S),"override-default-node-click-behavior":e(z),"node-props":V,"on-update:expanded-keys":e(F)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1})):(m(),v(g,{key:0},{default:l(()=>[a(i,{value:e(p),"onUpdate:value":o[0]||(o[0]=s=>C(p)?p.value=s:null),size:"small",style:{"min-width":"260px",width:"fit-content"},"show-path":"",loading:e(y),"consistent-menu-width":!1,clearable:"",placeholder:e(u)("page.diff.selectSourceFilePlaceholder"),options:e(D),"override-default-node-click-behavior":e(z),"node-props":L,"on-update:expanded-keys":e(F)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"]),a(t,{size:24,depth:3},{default:l(()=>[a(f,{style:{"vertical-align":"-0.25em"}})]),_:1}),a(i,{value:e(d),"onUpdate:value":o[1]||(o[1]=s=>C(d)?d.value=s:null),size:"small",style:{"min-width":"260px",width:"fit-content"},"show-path":"",loading:e(y),"consistent-menu-width":!1,clearable:"",placeholder:e(u)("page.diff.selectDestinationFilePlaceholder"),options:e(S),"override-default-node-click-behavior":e(z),"node-props":V,"on-update:expanded-keys":e(F)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1}))]),"header-extra":l(()=>[fe(a(A,{name:"fade",mode:"out-in",appear:""},{default:l(()=>[e(c)?(m(),v(M,{key:1,vertical:""},{default:l(()=>[a(_,{strong:"",secondary:"",size:"small",style:{padding:"6px"},disabled:!e(d),loading:e(x),focusable:!1,onClick:o[5]||(o[5]=s=>T("save"))},{icon:l(()=>[a(R)]),_:1},8,["disabled","loading"]),a(e(U),{editor:e(h),"diff-mode":""},{trigger:l(({show:s,toggleShow:E})=>[a(_,{strong:"",secondary:"",size:"small",type:s?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:E},{default:l(()=>[a(t,{size:"18"},{default:l(()=>[a(w,{style:{"vertical-align":"baseline"}})]),_:1})]),_:2},1032,["type","onClick"])]),_:1},8,["editor"])]),_:1})):(m(),v(M,{key:0},{default:l(()=>[a(e(U),{editor:e(h),"diff-mode":""},{trigger:l(({show:s,toggleShow:E})=>[a(_,{strong:"",size:"small",quaternary:!s,tertiary:s,type:s?"primary":"default",style:{padding:"6px"},focusable:!1,onClick:E},{default:l(()=>[a(t,{size:"18"},{default:l(()=>[a(w,{style:{"vertical-align":"baseline"}})]),_:1})]),_:2},1032,["quaternary","tertiary","type","onClick"])]),_:1},8,["editor"]),a(_,{strong:"",type:"primary",size:"small",disabled:!e(d),loading:e(x),focusable:!1,onClick:o[4]||(o[4]=s=>T("save"))},{icon:l(()=>[a(R)]),default:l(()=>[me(" "+ge(e(u)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1}))]),_:1},512),[[_e,e(d)&&e(p)]])]),default:l(()=>[a(A,{name:"fade",mode:"out-in",appear:"",style:{"border-bottom-left-radius":"6px","border-bottom-right-radius":"6px"}},{default:l(()=>[e(k).content||e(b)?(m(),v(e(le),{key:0,ref_key:"editorRef",ref:h,value:e(k),"origin-value":e(b),"diff-mode":"","render-side-by-side":e(G),"font-size":e(q)},null,8,["value","origin-value","render-side-by-side","font-size"])):(m(),v(W,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(u)("common.selectFileEmptyDesc")},{icon:l(()=>[a(t,null,{default:l(()=>[a(Q)]),_:1})]),_:1},8,["description"]))]),_:1}),a(X,{show:e(B)},null,8,["show"])]),_:1},8,["bordered"])]),_:1})}}});export{Ke as default};
