import{_ as ze}from"./app-18f65c91.js";import{_ as Te,B as De,a as Ae}from"./app-f9e7f085.js";import{_ as Ne}from"./app-05ca0384.js";import{_ as Be}from"./app-1a3e2845.js";import{G as Ie,bh as $e,bi as Ee,y as d,ap as i,b5 as T,aw as w,bl as ee,q as L,aH as P,bj as Oe,a3 as m,a4 as v,a5 as o,a6 as s,F as t,aF as D,aC as ae,aj as Fe,aO as Re,aE as te,ai as Ue,aP as _,aD as h,ah as V,am as ne,bm as le,af as qe,ag as Le,a_ as Pe,aY as Ve,bn as Ke,bo as Ge,ba as He,bp as Me,aQ as je,b1 as We,b7 as Je,aI as Qe,bq as Ye}from"./vendor-191e7315.js";import{_ as Xe}from"./app-27366806.js";import Ze from"./app-3065922e.js";import{d as oe,a as ie,c as se,b as re,s as ea,e as aa,g as ta,f as na}from"./app-13b90414.js";import{I as c}from"./app-9f5af7f8.js";import{u as la}from"./app-9adaac50.js";import{b as oa,d as ia}from"./app-16ee8ad9.js";import{u as sa}from"./app-20e510c8.js";import{u as ra}from"./app-d9e67733.js";import"./app-d8a29f50.js";import"./app-fd53326f.js";import"./app-863f7b38.js";import"./app-f9713fa5.js";import"./app-41e2b8bc.js";import"./app-9896b868.js";import"./app-651c5cb6.js";import"./vendor-2714f153.js";const ca={key:3},pa={class:"table-toolbar-right-icon"},ua={style:{color:"var(--app-primary-color)"}},Ea=Ie({__name:"index",setup(da){const{getIsMobile:b}=la(),{t:a}=oa(),{getLocale:K}=ra(),ce=K.value==="zh_CN"?$e:Ee,{message:f,confirm:E}=ia(),G=d("fade-slide");sa(G);const p=d("ordinary"),pe=d([{type:"ordinary",name:a("page.env.type.ordinary")},{type:"composite",name:a("page.env.type.composite")}]),H=d([]),M=d(),g=d([]),j=d(!1),S=d(!1),C=d(""),W=d(),A=d(""),N=d(""),O=d(),B=d(),ue=d([{label:()=>i(T,{style:{color:"var(--app-info-color)"}},{default:()=>a("page.env.table.action.enable.button")}),key:"enable",icon:()=>i(c,{icon:"tabler:variable",color:"var(--app-info-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{Y(!0)}}},{label:a("page.env.table.action.disable.button"),key:"disable",icon:()=>i(c,{icon:"tabler:variable-off",style:"vertical-align: baseline"},{}),props:{onClick:()=>{Y(!1)}}},{label:()=>i(T,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>i(c,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{fe()}}}]),de=[{type:"selection",key:"selection",width:54},{title:a("page.env.table.title.type"),key:"type",resizable:!0,width:280,render(e){return e.type?i("span",{style:{fontFamily:"var(--app-font-family-mono)"}},e.type):""}},{title:a("page.env.table.title.value"),key:"value",resizable:!0,render(e){if(e.envs===void 0)return e.value?i("span",{style:{fontFamily:"var(--app-font-family-mono)"}},e.value):"";const n=e.envs;return i(w,{strong:!0,secondary:!0,size:"small",focusable:!0,onClick:()=>B.value?.open(e)},{default:()=>a("page.env.table.manageItems",[n])})}},{title:a("page.env.table.title.tag_list"),key:"tag_list",resizable:!0,width:200,render(e){try{const n=e.tag_list;if(!n)return"";const l=JSON.parse(n||"['']");if(!Array.isArray(l))return"";const u=[];if(l.forEach(x=>{const{label:y,color:z}=x;u.push(i(ee,{bordered:!1,color:{color:L(z).setAlpha(.12).toHex8String(),borderColor:L(z).toHexString(),textColor:L(z).toHexString()}},{default:()=>y}))}),u.length>0)return i(P,{style:"gap: 4px"},{default:()=>u})}catch{}return""}},{title:a("page.env.table.title.description"),key:"description",resizable:!0,width:200},{title:a("page.env.table.title.update_time"),key:"update_time",align:"center",width:170,render(e){return e.update_time?Date.now()-new Date(e.update_time).getTime()<1e3*60*60?Oe(new Date(e.update_time),{addSuffix:!0,locale:ce}):e.update_time:a("page.env.table.update_time.never")},sorter:!0,defaultSortOrder:!1},{title:a("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:b.value?void 0:"right",renderFilterIcon:()=>i(c,{icon:"ic:round-filter-list",style:"vertical-align: baseline"},{}),render(e){return i(ee,{type:e.enable===1?"success":"error",bordered:!1,style:K.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?a("common.active"):a("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:a("common.active"),value:1},{label:a("common.inactive"),value:0}],filter(){}}];function I(e,n){switch(e){case"edit":return{icon:"mdi-square-edit-outline",tooltip:a("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:J.bind(null,n)};case"changeStatus":return{icon:n.enable===1?"tabler-variable-off":"tabler-variable",tooltip:n.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:Q.bind(null,n)};case"manage":return{icon:"mdi-database-cog-outline",tooltip:a("page.env.table.action.manage"),quaternary:!0,focusable:!1,onClick:()=>B.value?.open(n)}}}const be={title:a("page.env.table.title.action"),key:"action",titleAlign:b.value?"center":"left",width:b.value?68:140,fixed:"right",render(e){const n=p.value==="composite",l={edit:{label:a("page.env.table.action.edit"),key:"edit",icon:()=>i(c,{icon:"mdi:square-edit-outline",style:"vertical-align: baseline"},{}),props:{onClick:J.bind(null,e)}},delete:{label:()=>i(T,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>i(c,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:me.bind(null,e)}},changeStatus:{label:e.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>i(c,{icon:e.enable===1?"tabler:variable-off":"tabler:variable",style:"vertical-align: baseline"},{}),props:{onClick:Q.bind(null,e)}},manage:{label:a("page.env.table.action.manage"),key:"manage",icon:()=>i(c,{icon:"mdi:database-cog-outline",style:"vertical-align: baseline"},{}),props:{onClick:()=>B.value?.open(e)}},sort:{label:a("page.env.table.action.sort.title"),key:"sort",icon:()=>i(c,{icon:"mdi:sort",style:"vertical-align: baseline"},{}),children:[{label:a("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>i(c,{icon:"material-symbols:arrow-upward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:F.bind(null,e,"up")}},{label:a("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>i(c,{icon:"material-symbols:arrow-downward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:F.bind(null,e,"down")}},{label:a("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>i(c,{icon:"material-symbols:text-select-move-up-rounded",style:"vertical-align: baseline"},{}),props:{onClick:F.bind(null,e,"top")}}]},export:{label:a("page.env.table.action.export"),key:"export",icon:()=>i(c,{icon:"mdi:content-copy",style:"vertical-align: baseline"},{}),props:{iconProps:{size:"16"},onClick:ve.bind(null,e)}}};let u;return n?b.value?u={style:"button",actions:[],dropDownActions:[l.edit,l.manage,l.changeStatus,l.sort,l.delete]}:u={style:"button",actions:[I("edit",e),I("manage",e)],dropDownActions:[l.changeStatus,l.sort,l.delete]}:b.value?u={style:"button",actions:[],dropDownActions:[l.edit,l.changeStatus,l.export,l.sort,l.delete]}:u={style:"button",actions:[I("edit",e),I("changeStatus",e)],dropDownActions:[l.export,l.sort,l.delete]},i(Te,u)}};async function J(e){O.value?.open(p.value,e)}function me(e){E.error({title:a("page.env.table.action.delete.title"),content:a("page.env.table.action.delete.confirm"),icon:()=>i(c,{icon:"fe:trash",style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{p.value==="composite"?await oe({id:e.id}):await ie({id:e.id}),f.success(a("page.env.table.message.delete.ok"))}catch{f.error(a("page.env.table.message.delete.fail"))}finally{k()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}async function Q(e){try{const n={id:e.id,enable:e.enable===0?1:0};p.value==="composite"?await se(n):await re(n),f.success(e.enable===1?a("page.env.table.message.disable.ok"):a("page.env.table.message.enable.ok"),{duration:1500}),e.enable=e.enable===0?1:0}catch{f.error(e.enable===1?a("page.env.table.message.disable.fail"):a("page.env.table.message.enable.fail"))}}async function ve(e){f.info(`export ${e.type}="${e.value}"`,{keepAliveOnHover:!0,duration:3e3})}async function F(e,n){const l=p.value==="composite",{id:u,sort:x}=e;try{let y;switch(n){case"up":y={id:u,order:x+1};break;case"down":y={id:u,order:x-1};break;case"top":y={id:u,moveToEnd:!0};break;default:return}l?await ea(y):await aa(y),f.success(a("page.env.table.message.sort.ok")),k()}catch{}}function fe(){E.error({title:a("page.env.table.action.delete.batchTitle"),content:a("page.env.table.action.delete.batchConfirm"),icon:()=>i(c,{icon:"fe:trash",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=g.value.map(l=>Number(l));p.value==="composite"?await oe({id:e}):await ie({id:e}),f.success(a("page.env.table.message.delete.ok"))}catch{f.error(a("page.env.table.message.delete.fail"))}finally{k()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function Y(e){E.info({title:a(`page.env.table.action.${e?"enable":"disable"}.batchTitle`),content:a(`page.env.table.action.${e?"enable":"disable"}.batchConfirm`),icon:()=>i(c,{icon:e?"tabler:variable":"tabler:variable-off",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{p.value==="composite"?await se({id:g.value.map(l=>Number(l)),enable:e?1:0}):await re({id:g.value.map(l=>Number(l)),enable:e?1:0}),f.success(a(`page.env.table.message.${e?"enable":"disable"}.ok`))}catch{f.error(a(`page.env.table.message.${e?"enable":"disable"}.fail`))}finally{k()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function k(){setTimeout(()=>{M.value?.reload()},250),g.value=[]}function R(){S.value=!0,k(),S.value=!1}function $(){C.value="",k()}function ge(e){H.value=e.enable}async function ye(e){switch(e.order){case"ascend":A.value=e.columnKey,N.value="0";break;case"descend":A.value=e.columnKey,N.value="1";break;case!1:A.value="",N.value="";break}k()}async function _e(e){const n=p.value==="composite",l={page:e.page,size:e.size,search:C.value||"",enable:H.value.join(","),orderBy:A.value,order:N.value};return n?await ta(l):await na(l)}async function U(e){switch(e){case"createEnv":O.value?.open(p.value);break;case"showSearchBar":j.value=!0,Pe().then(()=>{W.value?.focus()});break}}return(e,n)=>{const l=Ye,u=Ve,x=Be,y=Ke,z=Ge,q=Ne,X=He,he=Me,Z=Ae,ke=je,Ce=We,xe=Je,we=Qe,Se=ze;return m(),v(Se,{"content-full":"","no-header":""},{default:o(()=>[s(we,{id:"env-table-drawer-target",bordered:!t(b),style:{height:"100%"},"header-style":t(b)?{padding:"0 10px"}:{},"content-style":{padding:t(b)?"10px":"12px 18px"}},{header:o(()=>[t(b)?(m(),v(u,{key:0,value:t(p),"onUpdate:value":[n[0]||(n[0]=r=>D(p)?p.value=r:null),$],type:"segment",size:"small",animated:""},{default:o(()=>[(m(!0),ae(Re,null,Fe(t(pe),r=>(m(),v(l,{key:r.type,name:r.type},{default:o(()=>[_(h(r.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["value"])):te("",!0)]),default:o(()=>[s(t(De),{ref_key:"tableRef",ref:M,"checked-row-keys":t(g),"onUpdate:checkedRowKeys":n[7]||(n[7]=r=>D(g)?g.value=r:null),"table-id":"ENV","pagination-behavior-on-filter":"first",columns:de,request:_e,"row-key":r=>`${r.id}`,"action-column":be,"onUpdate:filters":ge,"onUpdate:sorter":ye},Ue({tableTitle:o(()=>[s(t(P),{wrap:!1},{default:o(()=>[t(b)?(m(),v(t(w),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 6px"},focusable:!1,onClick:n[2]||(n[2]=r=>U("createEnv"))},{icon:o(()=>[s(x)]),_:1})):(m(),v(t(w),{key:0,type:"primary",size:"small",style:{height:"32px"},focusable:!1,onClick:n[1]||(n[1]=r=>U("createEnv"))},{default:o(()=>[_(h(t(a)("page.env.table.new")),1)]),_:1})),t(b)?te("",!0):(m(),v(z,{key:2,value:t(p),"onUpdate:value":n[3]||(n[3]=r=>D(p)?p.value=r:null),variant:"default-filled","on-change":$},{default:o(()=>[s(y,{value:"ordinary"},{default:o(()=>[_(h(t(a)("page.env.type.ordinary")),1)]),_:1}),s(y,{value:"composite"},{default:o(()=>[_(h(t(a)("page.env.type.composite")),1)]),_:1})]),_:1},8,["value"])),t(b)?(m(),v(X,{key:4,value:t(C),"onUpdate:value":n[6]||(n[6]=r=>D(C)?C.value=r:null),loading:t(S)||void 0,size:"small",clearable:"",placeholder:t(a)("page.env.table.search.placeholder"),"on-clear":$,onKeyup:le(R,["enter"])},{prefix:o(()=>[s(q)]),_:1},8,["value","loading","placeholder"])):(m(),ae("div",ca,[t(j)?(m(),v(ne,{key:1,name:t(G),mode:"default",appear:""},{default:o(()=>[s(he,{style:{height:"32px"}},{default:o(()=>[s(X,{ref_key:"searchBarInputRef",ref:W,value:t(C),"onUpdate:value":n[5]||(n[5]=r=>D(C)?C.value=r:null),disabled:t(S),loading:t(S)||void 0,size:"small",clearable:"",placeholder:t(a)("page.env.table.search.placeholder"),"on-clear":$,onKeyup:le(R,["enter"])},{prefix:o(()=>[s(q)]),_:1},8,["value","disabled","loading","placeholder"]),s(t(w),{strong:"",secondary:"",type:"primary",size:"small",style:{height:"32px"},onClick:R},{default:o(()=>[_(h(t(a)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(m(),v(t(w),{key:0,strong:"",secondary:"",size:"small",style:{padding:"0 8px",height:"32px"},focusable:!1,onClick:n[4]||(n[4]=r=>U("showSearchBar"))},{icon:o(()=>[s(q)]),_:1}))]))]),_:1})]),toolbar:o(()=>[qe(s(ne,{name:"fade-slide-left",mode:"out-in",appear:""},{default:o(()=>[s(t(P),{wrap:!1},{default:o(()=>[s(xe,{size:"small",trigger:"click",options:t(ue)},{default:o(()=>[t(b)?(m(),v(Ce,{key:1,trigger:"hover"},{trigger:o(()=>[V("div",pa,[s(ke,{size:"20"},{default:o(()=>[s(Z)]),_:1})])]),default:o(()=>[V("span",null,h(t(a)("page.env.table.action.batchAction")),1)]),_:1})):(m(),v(t(w),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px"},focusable:!1},{icon:o(()=>[s(Z)]),default:o(()=>[_(" "+h(t(a)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[Le,t(g).length]])]),_:2},[t(g).length&&!t(b)?{name:"info",fn:o(()=>[s(t(T),null,{default:o(()=>[_(h(t(a)("common.selected")),1)]),_:1}),n[8]||(n[8]=_("  ")),V("span",ua,h(t(g).length),1),n[9]||(n[9]=_("  ")),s(t(T),null,{default:o(()=>[_(h(t(a)("common.item")),1)]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["bordered","header-style","content-style"]),s(Xe,{ref_key:"editEnv",ref:O,onOk:k},null,512),s(Ze,{ref_key:"manageValue",ref:B,onOk:k},null,512)]),_:1})}}});export{Ea as default};
