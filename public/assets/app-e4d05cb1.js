import{aN as fe,a6 as u,aG as q,al as $,G as Ke,bx as je,by as He,y as c,at as s,b9 as D,r as Ge,J as Je,bm as re,bl as ce,bz as We,a9 as o,a8 as l,F as n,a7 as v,aA as S,aI as K,aH as m,aJ as z,am as Qe,aT as x,aL as ue,bn as pe,aq as de,aj as Xe,ak as Ye,aS as Ze,aw as et,b2 as tt,aU as at,ba as nt,aV as lt,be as ot,bq as st,b5 as it,bb as rt,aM as ct,bE as ut,bR as pt,bF as dt,bO as bt,bK as vt}from"./vendor-f4e37609.js";import{_ as mt,B as ft,a as gt}from"./app-b5c1cc18.js";import{_ as _t}from"./app-6ee071f1.js";import{_ as yt}from"./app-9ba543d4.js";import{_ as kt}from"./app-6d4bea4d.js";import{_ as ht}from"./app-2939b295.js";import{a as be,b as ve,e as me,h as xt}from"./app-e2c5a80a.js";import{I as r}from"./app-89768b9a.js";import{u as wt}from"./app-34fc42c0.js";import{d as Ct,b as Tt,e as St}from"./app-516cf0fd.js";import{u as $t}from"./app-758bfed7.js";import{u as Bt}from"./app-32d007d4.js";import"./app-3b782c1f.js";import"./app-5b984881.js";import"./app-4688b2b4.js";import"./app-3378d39a.js";import"./vendor-5db0929b.js";const zt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function It(j,w){return u(),q("svg",zt,w[0]||(w[0]=[$("path",{fill:"currentColor",d:"m7.825 13l4.9 4.9q.3.3.288.7t-.313.7q-.3.275-.7.288t-.7-.288l-6.6-6.6q-.15-.15-.213-.325T4.426 12t.063-.375t.212-.325l6.6-6.6q.275-.275.688-.275t.712.275q.3.3.3.713t-.3.712L7.825 11H19q.425 0 .713.288T20 12t-.288.713T19 13z"},null,-1)]))}const Ot=fe({name:"material-symbols-arrow-back-rounded",render:It}),Nt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Dt(j,w){return u(),q("svg",Nt,w[0]||(w[0]=[$("path",{fill:"currentColor",d:"m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z"},null,-1)]))}const qt=fe({name:"material-symbols-chevron-left-rounded",render:Dt}),At={key:1,style:{"text-align":"center","font-weight":"600"}},Et={style:{"vertical-align":"-5px",padding:"0 2px"}},Rt={style:{"text-align":"center","font-weight":"600"}},Vt={key:3},Ut={class:"table-toolbar-right-icon"},Ft={style:{color:"var(--app-primary-color)"}},Mt=Ke({__name:"manageValue",emits:["ok"],setup(j,{expose:w,emit:ge}){const _e=ge,{getIsMobile:p}=wt(),{getLocale:H}=Bt(),ye=H.value==="zh_CN"?je:He,{message:b,confirm:U}=Ct(),{t:a}=Tt(),G=c("fade-slide");$t(G);const F=c(),J=c(),W=c(),Q=c([]),y=c([]),X=c(!1),I=c(!1),f=c(""),Y=c(),A=c([]),E=c("sort"),k=c("0"),O=c(!1),h=c(null),R=c(null),Z={padding:"2px",borderRadius:"3px",lineHeight:"1",color:"var(--app-foreground-color)",background:"var(--app-primary-color)"},ke=c([{label:()=>s(D,{style:{color:"var(--app-info-color)"}},{default:()=>a("page.env.table.action.enable.button")}),key:"enable",icon:()=>s(r,{icon:"tabler:variable",color:"var(--app-info-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{le(!0)}}},{label:a("page.env.table.action.disable.button"),key:"disable",icon:()=>s(r,{icon:"tabler:variable-off",style:"vertical-align: baseline"},{}),props:{onClick:()=>{le(!1)}}},{label:()=>s(D,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>s(r,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:()=>{$e()}}}]),g=Ge({title:"",show:!1,model:{}}),{show:V,title:M}=Je(g),he=[{type:"selection",key:"selection",width:46},{title:a("page.env.table.title.sort"),key:"sort",align:"center",titleAlign:"center",width:88,sorter:!0,defaultSortOrder:!1,render(e){return s(re,{size:"small",bordered:!1,style:"font-weight: 600"},{default:()=>e.sort})}},{title:a("page.env.table.title.value"),key:"value",resizable:!0,render(e){return s(ce,{patterns:A.value,highlightStyle:Z,text:e.value,style:{fontFamily:"var(--app-font-family-mono)"}})}},{title:a("page.env.table.title.remark"),key:"remark",resizable:!0,width:200,render(e){return s(ce,{patterns:A.value,highlightStyle:Z,text:e.remark})}},{title:a("page.env.table.title.update_time"),key:"update_time",align:"center",width:170,render(e){return e.update_time?Date.now()-new Date(e.update_time).getTime()<1e3*60*60?We(new Date(e.update_time),{addSuffix:!0,locale:ye}):e.update_time:a("page.env.table.update_time.never")},sorter:!0,defaultSortOrder:!1},{title:a("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:p.value?void 0:"right",renderFilterIcon:()=>s(r,{icon:"ic:round-filter-list",style:"vertical-align: baseline"},{}),render(e){return s(re,{type:e.enable===1?"success":"error",bordered:!1,style:H.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?a("common.active"):a("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:a("common.active"),value:1},{label:a("common.inactive"),value:0}],filter(){}}];function ee(e,t){switch(e){case"edit":return{icon:"mdi-square-edit-outline",tooltip:a("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:te.bind(null,t)};case"changeStatus":return{icon:t.enable===1?"tabler-variable-off":"tabler-variable",tooltip:t.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:ae.bind(null,t)}}}const xe={title:a("page.env.table.title.action"),key:"action",titleAlign:p.value?"center":"left",width:p.value?68:140,fixed:"right",render(e){const t={edit:{label:a("page.env.table.action.edit"),key:"edit",icon:()=>s(r,{icon:"mdi:square-edit-outline",style:"vertical-align: baseline"},{}),props:{onClick:te.bind(null,e)}},delete:{label:()=>s(D,{style:{color:"var(--app-error-color)"}},{default:()=>a("page.env.table.action.delete.button")}),key:"delete",icon:()=>s(r,{icon:"fe:trash",color:"var(--app-error-color)",style:"vertical-align: baseline"},{}),props:{onClick:we.bind(null,e)}},changeStatus:{label:e.enable===1?a("page.env.table.action.disable.button"):a("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>s(r,{icon:e.enable===1?"tabler:variable-off":"tabler:variable",style:"vertical-align: baseline"},{}),props:{onClick:ae.bind(null,e)}},sort:{label:a("page.env.table.action.sort.title"),key:"sort",icon:()=>s(r,{icon:"mdi:sort",style:"vertical-align: baseline"},{}),children:[{label:a("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>s(r,{icon:"material-symbols:arrow-upward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:N.bind(null,e,"up")}},{label:a("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>s(r,{icon:"material-symbols:arrow-downward-rounded",style:"vertical-align: baseline"},{}),props:{onClick:N.bind(null,e,"down")}},{label:a("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>s(r,{icon:"material-symbols:text-select-move-up-rounded",style:"vertical-align: baseline"},{}),props:{onClick:N.bind(null,e,"top")}},{label:a("page.env.table.action.sort.moveBottom"),key:"sortMoveBottom",icon:()=>s(r,{icon:"material-symbols:text-select-move-down-rounded",style:"vertical-align: baseline"},{}),props:{onClick:N.bind(null,e,"bottom")}},{label:a("page.env.table.action.sort.moveSpecify"),key:"sortMoveSpecify",icon:()=>s(r,{icon:"ic:round-numbers",style:"vertical-align: baseline"},{}),props:{onClick:N.bind(null,e,"specify")}}]},export:{label:a("page.env.table.action.export"),key:"export",icon:()=>s(r,{icon:"mdi:content-copy",style:"vertical-align: baseline"},{}),props:{iconProps:{size:"16"},onClick:Ce.bind(null,e)}}};let d;return p.value?d={style:"button",actions:[],dropDownActions:[t.edit,t.changeStatus,t.export,t.sort,t.delete]}:d={style:"button",actions:[ee("edit",e),ee("changeStatus",e)],dropDownActions:[t.export,t.sort,t.delete]},s(mt,d)}};async function te(e){F.value?.open("composite_value",e)}function we(e){U.error({title:a("page.env.table.action.delete.title"),content:a("page.env.table.action.delete.confirm"),icon:()=>s(r,{icon:"fe:trash",style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{await be({id:e.id}),b.success(a("page.env.table.message.delete.ok"))}catch{b.error(a("page.env.table.message.delete.fail"))}finally{_()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}async function ae(e){try{const t={id:e.id,enable:e.enable===0?1:0};await ve(t),b.success(e.enable===1?a("page.env.table.message.disable.ok"):a("page.env.table.message.enable.ok"),{duration:1500}),e.enable=e.enable===0?1:0}catch{b.error(e.enable===1?a("page.env.table.message.disable.fail"):a("page.env.table.message.enable.fail"))}}async function N(e,t){const{id:d,sort:C}=e;try{let T;switch(t){case"up":T={id:d,order:C+(k.value==="0"?-1:1)};break;case"down":T={id:d,order:C+(k.value==="0"?1:-1)};break;case"top":T=Object.assign({id:d},k.value==="0"?{order:1}:{moveToEnd:!0});break;case"bottom":T=Object.assign({id:d},k.value==="0"?{moveToEnd:!0}:{order:1});break;case"specify":O.value=!0,R.value=d,h.value=C;return;default:return}await me(T),b.success(a("page.env.table.message.sort.ok")),_()}catch{}}async function Ce(e){b.info(`export ${g.title}="${e.value}"`,{keepAliveOnHover:!0,duration:3e3})}function Te(){return s(r,{icon:"ic:round-numbers",style:"vertical-align: baseline"},{})}async function Se(){try{await me({id:R.value,order:h.value}),b.success(a("page.env.table.message.sort.ok")),_()}catch{}finally{R.value=null,h.value=null}}function ne(){O.value=!1,h.value=null,R.value=null}function $e(){U.error({title:a("page.env.table.action.delete.batchTitle"),content:a("page.env.table.action.delete.batchConfirm"),icon:()=>s(r,{icon:"fe:trash",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=y.value.map(t=>Number(t));await be({id:e}),b.success(a("page.env.table.message.delete.ok"))}catch{b.error(a("page.env.table.message.delete.fail"))}finally{_()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function le(e){U.info({title:a(`page.env.table.action.${e?"enable":"disable"}.batchTitle`),content:a(`page.env.table.action.${e?"enable":"disable"}.batchConfirm`),icon:()=>s(r,{icon:e?"tabler:variable":"tabler:variable-off",size:24,style:"vertical-align: baseline"},{}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{await ve({id:y.value.map(t=>Number(t)),enable:e?1:0}),b.success(a(`page.env.table.message.${e?"enable":"disable"}.ok`))}catch{b.error(a(`page.env.table.message.${e?"enable":"disable"}.fail`))}finally{_()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function _(){setTimeout(()=>{W.value?.reload()},250),y.value=[]}function P(){I.value=!0,_(),I.value=!1}function oe(){f.value="",A.value=[],_()}function Be(e){Q.value=e.enable}async function ze(e){switch(e.order){case"ascend":E.value=e.columnKey,k.value="0";break;case"descend":E.value=e.columnKey,k.value="1";break;case!1:E.value="sort",k.value="0";break}_()}async function Ie(e){const t={page:e.page,size:e.size,group_id:g.model.id,search:f.value||"",enable:Q.value.join(","),orderBy:E.value,order:k.value},d=await xt(t);return f.value&&(A.value=[String(f.value)]),d}function Oe(e={}){const t={id:null,type:"",description:"",tag_list:"",enable:1,separator:"",envs:0};g.model=et(t),Object.assign(g.model,e),g.title=g.model.type||"未知变量名",g.show=!0}async function B(e){switch(e){case"createValue":F.value?.open("composite_value",null,g.model.id);break;case"importEnv":J.value?.open(g.model.id);break;case"backEnvTable":V.value=!1,_e("ok");break;case"showSearchBar":X.value=!0,tt().then(()=>{Y.value?.focus()});break}}return w({open:Oe}),(e,t)=>{const d=qt,C=at,T=nt,Ne=lt,De=yt,L=_t,se=ot,qe=st,ie=gt,Ae=it,Ee=rt,Re=ct,Ve=ut,Ue=Ot,Fe=pt,Me=dt,Pe=bt,Le=vt;return u(),q(Ze,null,[o(Me,{show:n(V),"onUpdate:show":t[9]||(t[9]=i=>z(V)?V.value=i:null),height:"calc(var(--vh) * 100)",width:"100%",placement:"right",to:"#env-table-drawer-target","trap-focus":!1,"block-scroll":!1,"auto-focus":!1,"mask-closable":!1},{default:l(()=>[o(Ve,{closable:!1,"header-style":"display: none","body-content-style":"padding: 0"},{header:l(()=>t[14]||(t[14]=[])),default:l(()=>[o(Re,{bordered:!1,style:{height:"100%","background-color":"var(--app-background)"},"header-style":{padding:n(p)?"0 10px":"20px 24px 20px 24px"},"content-style":{height:"100%",padding:n(p)?"10px":"0 24px 20px 24px"}},{header:l(()=>[o(Ne,{style:{"align-items":"center"}},{default:l(()=>[n(p)?K("",!0):(u(),v(n(S),{key:0,strong:"",secondary:"",focusable:!1,style:{padding:"0 8px"},onClick:t[0]||(t[0]=i=>B("backEnvTable"))},{icon:l(()=>[o(C,{size:28},{default:l(()=>[o(d,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})),n(p)?(u(),v(T,{key:2,style:{height:"100%","max-width":"190px"}},{tooltip:l(()=>[$("span",Rt,m(n(M)),1)]),default:l(()=>[$("span",Et,m(n(M)),1)]),_:1})):(u(),q("span",At,m(n(M)),1))]),_:1})]),default:l(()=>[o(n(ft),{ref_key:"tableRef",ref:W,"checked-row-keys":n(y),"onUpdate:checkedRowKeys":t[7]||(t[7]=i=>z(y)?y.value=i:null),class:"env-sub-table","table-id":"ENV_SUB","pagination-behavior-on-filter":"first",columns:he,request:Ie,"row-key":i=>`${i.id}`,"action-column":xe,"onUpdate:filters":Be,"onUpdate:sorter":ze},Qe({tableTitle:l(()=>[o(n(ue),{wrap:!1},{default:l(()=>[n(p)?(u(),v(n(S),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 5px"},focusable:!1,onClick:t[2]||(t[2]=i=>B("createValue"))},{icon:l(()=>[o(De)]),_:1})):(u(),v(n(S),{key:0,type:"primary",focusable:!1,onClick:t[1]||(t[1]=i=>B("createValue"))},{default:l(()=>[x(m(n(a)("page.env.table.newValue")),1)]),_:1})),n(p)?K("",!0):(u(),v(n(S),{key:2,secondary:"",focusable:!1,onClick:t[3]||(t[3]=i=>B("importEnv"))},{default:l(()=>[x(m(n(a)("page.env.table.batchImport")),1)]),_:1})),n(p)?(u(),v(se,{key:4,value:n(f),"onUpdate:value":t[6]||(t[6]=i=>z(f)?f.value=i:null),loading:n(I)||void 0,size:"small",clearable:"",placeholder:n(a)("page.env.table.search.placeholder"),"on-clear":oe,onKeyup:pe(P,["enter"])},{prefix:l(()=>[o(L)]),_:1},8,["value","loading","placeholder"])):(u(),q("div",Vt,[n(X)?(u(),v(de,{key:1,name:n(G),mode:"default",appear:""},{default:l(()=>[o(qe,null,{default:l(()=>[o(se,{ref_key:"searchBarInputRef",ref:Y,value:n(f),"onUpdate:value":t[5]||(t[5]=i=>z(f)?f.value=i:null),disabled:n(I),loading:n(I)||void 0,clearable:"",placeholder:n(a)("page.env.table.search.placeholder"),"on-clear":oe,onKeyup:pe(P,["enter"])},{prefix:l(()=>[o(L)]),_:1},8,["value","disabled","loading","placeholder"]),o(n(S),{strong:"",secondary:"",type:"primary",onClick:P},{default:l(()=>[x(m(n(a)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(u(),v(n(S),{key:0,strong:"",secondary:"",style:{padding:"0 8px"},focusable:!1,onClick:t[4]||(t[4]=i=>B("showSearchBar"))},{icon:l(()=>[o(L)]),_:1}))]))]),_:1})]),toolbar:l(()=>[Xe(o(de,{name:"fade-slide-left",mode:"out-in",appear:""},{default:l(()=>[o(n(ue),{wrap:!1},{default:l(()=>[o(Ee,{size:"small",trigger:"click",options:n(ke)},{default:l(()=>[n(p)?(u(),v(Ae,{key:1,trigger:"hover"},{trigger:l(()=>[$("div",Ut,[o(C,{size:"20"},{default:l(()=>[o(ie)]),_:1})])]),default:l(()=>[$("span",null,m(n(a)("page.env.table.action.batchAction")),1)]),_:1})):(u(),v(n(S),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px"},focusable:!1},{icon:l(()=>[o(ie)]),default:l(()=>[x(" "+m(n(a)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[Ye,n(y).length]])]),_:2},[n(y).length&&!n(p)?{name:"info",fn:l(()=>[o(n(D),null,{default:l(()=>[x(m(n(a)("common.selected")),1)]),_:1}),t[15]||(t[15]=x("  ")),$("span",Ft,m(n(y).length),1),t[16]||(t[16]=x("  ")),o(n(D),null,{default:l(()=>[x(m(n(a)("common.item")),1)]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["header-style","content-style"])]),_:1}),n(p)?(u(),v(Fe,{key:0,left:20,bottom:20,onClick:t[8]||(t[8]=i=>B("backEnvTable"))},{default:l(()=>[o(C,null,{default:l(()=>[o(Ue)]),_:1})]),_:1})):K("",!0)]),_:1},8,["show"]),o(Le,{show:n(O),"onUpdate:show":t[11]||(t[11]=i=>z(O)?O.value=i:null),preset:"dialog",style:{width:"360px"},"auto-focus":!1,"mask-closable":!1,icon:Te,title:n(a)("page.env.table.action.sort.moveSpecifyTitle"),"positive-text":n(a)("common.okText"),"negative-text":n(a)("common.cancelText"),"on-close":ne,"positive-button-props":{disabled:!n(h)},"negative-button-props":{ghost:!1,tertiary:!0},onNegativeClick:t[12]||(t[12]=i=>ne()),onPositiveClick:t[13]||(t[13]=i=>Se())},{default:l(()=>[o(Pe,{value:n(h),"onUpdate:value":t[10]||(t[10]=i=>z(h)?h.value=i:null),clearable:"",min:1,max:99999,style:{"margin-top":"5px"}},null,8,["value"])]),_:1},8,["show","title","positive-text","negative-text","positive-button-props"]),o(kt,{ref_key:"editEnv",ref:F,onOk:_},null,512),o(ht,{ref_key:"importEnv",ref:J,onOk:_},null,512)],64)}}}),oa=St(Mt,[["__scopeId","data-v-fe38cd40"]]);export{oa as default};
