import{G as C,h as D,y as g,a3 as S,aC as U,a6 as e,a5 as r,F as t,aP as v,aD as y,bz as B,ba as E,bB as I,bu as T,aw as q,aH as V,bv as $,bC as z}from"./vendor-d56b0496.js";import{z as F,d as M,b as O,aj as b}from"./app-d0ea65e6.js";const R={class:"grid grid-cols-1 grid-flow-row-dense md:grid-cols-[450px_1fr] gap-4"},H=C({__name:"Identity",setup(j){const d=F(),c=D(()=>d.getUserInfo),{message:_}=M(),{t:s}=O(),a=g({username:c.value.username,password:"",confirmPassword:""}),h={username:[{required:!0,message:s("setting.identity.error.userNameEmpty"),trigger:["input","blur"]}],password:[{required:!0,message:s("setting.identity.error.newPasswordEmpty"),trigger:["input","blur"]}],confirmPassword:[{required:!0,message:s("setting.identity.error.confirmNewPasswordDiff"),trigger:["input","blur"],validator(l,n){return a.value.password!==n?new Error(s("setting.identity.error.confirmNewPasswordDiff")):!0}}]},i=g(null);async function P(){if(await i.value?.validate()){await b({username:a.value.username,password:a.value.password}),_.warning(s("setting.identity.message.msgOk"));try{setTimeout(()=>{d.logout(!0)},2e3)}catch{}}}async function f(l){switch(l){case"update":if(await i.value?.validate()){await b({username:a.value.username,password:a.value.password}),_.warning(s("setting.identity.message.msgOk"));try{setTimeout(()=>{d.logout(!0)},2e3)}catch{}}break;case"reset":a.value={username:c.value.username,password:"",confirmPassword:""},i.value?.restoreValidation();break}}return(l,n)=>{const p=E,m=I,u=T,w=q,k=V,x=$,N=z;return S(),U("div",R,[e(N,{ref_key:"formRef",ref:i,model:t(a),rules:h,"label-placement":"top","label-width":80,onSubmit:B(P,["prevent"])},{default:r(()=>[e(x,{cols:3,"x-gap":6},{default:r(()=>[e(u,{span:2},{default:r(()=>[e(m,{label:t(s)("setting.identity.username"),path:"username"},{default:r(()=>[e(p,{value:t(a).username,"onUpdate:value":n[0]||(n[0]=o=>t(a).username=o),placeholder:t(s)("setting.identity.placeholder.userName")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),e(u,{span:2},{default:r(()=>[e(m,{label:t(s)("setting.identity.newPassword"),path:"password"},{default:r(()=>[e(p,{value:t(a).password,"onUpdate:value":n[1]||(n[1]=o=>t(a).password=o),type:"password","show-password-on":"click",placeholder:t(s)("setting.identity.placeholder.newPassword")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),e(u,{span:2},{default:r(()=>[e(m,{label:t(s)("setting.identity.confirmNewPassword"),path:"confirmPassword"},{default:r(()=>[e(p,{value:t(a).confirmPassword,"onUpdate:value":n[2]||(n[2]=o=>t(a).confirmPassword=o),type:"password","show-password-on":"click",placeholder:t(s)("setting.identity.placeholder.confirmNewPassword")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),e(u,{span:2},{default:r(()=>[e(k,null,{default:r(()=>[e(w,{type:"primary",onClick:n[3]||(n[3]=o=>f("update"))},{default:r(()=>[v(y(t(s)("setting.identity.button.confirm")),1)]),_:1}),e(w,{onClick:n[4]||(n[4]=o=>f("reset"))},{default:r(()=>[v(y(t(s)("common.resetText")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}});export{H as _};
