import{_ as ce}from"./app-564c9d98.js";import{b as pe,d as fe,_ as _e}from"./app-dbd4b5f0.js";import{_ as me}from"./app-78be3a52.js";import{_ as ve}from"./app-7684c51a.js";import{_ as ge}from"./app-66f89c3b.js";import{az as J,aq as ee,T as m,a5 as C,G as he,A as d,y as Q,aC as ye,aD as be,S as h,V as a,W as n,ax as ke,F as e,ar as xe,ab as X,aK as we,aw as ze,aX as Ce,a3 as De,av as Fe,ak as Oe,aY as Se,aL as Ve,as as S,aN as Te,a4 as Pe,aQ as $e,aZ as Ee,at as V}from"./vendor-ca0e89fa.js";import{_ as Ie,a as Ne}from"./app-64262975.js";import{_ as Be,C as Y,a as Me}from"./app-3a6dce02.js";import{a as Le,b as Ue,c as je,f as Re,I as He,s as Ae,g as qe}from"./app-2733701f.js";import{u as T,h as P}from"./app-67d12428.js";import{u as We}from"./app-40fcbbd5.js";import{F as Ze}from"./app-f44d7ba5.js";import"./app-240cd649.js";import"./vendor-6c6d1442.js";import"./app-80666950.js";import"./app-f0aa7dbe.js";import"./app-c16619b4.js";import"./app-a04700e8.js";import"./app-52337bf4.js";const Ge={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ke(L,p){return m(),ee("svg",Ge,p[0]||(p[0]=[C("path",{fill:"currentColor",d:"m17 15l-3-3v2h-4v-2l-3 3l3 3v-2h4v2m0-16H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8zm4 18H6V4h7v5h5Z"},null,-1)]))}const Qe=J({name:"mdi-file-swap-outline",render:Ke}),Xe={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ye(L,p){return m(),ee("svg",Xe,p[0]||(p[0]=[C("path",{fill:"currentColor",d:"M10 18H6v-2h4zm0-4H6v-2h4zm0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1zm10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2zm-4 6h-2v-2h2zm0 4h-2v-2h2z"},null,-1)]))}const Je=J({name:"mdi-file-compare",render:Ye}),bn=he({__name:"index",setup(L){const{getIsMobile:p}=We(),{t:f}=pe(),{message:U}=fe(),$=d([]),E=d([]),k=d(),x=d(),s=d(""),u=d(""),c=d(),w=d({content:"",language:"plaintext"}),z=d(""),ne=d(14),D=d(!1),I=d(!1),b=d(!1);async function v(l){switch(l){case"save":if(!c.value)break;D.value=!0;const t=c.value.getValue();try{await Ae({content:t,path:s.value}),U.success(f("editor.main.savedSuccess"))}finally{D.value=!1}break;case"prev":if(!c.value)break;c.value.goToPreviousDiff();break;case"next":if(!c.value)break;c.value.goToNextDiff();break;case"swapDiffSides":if(!c.value||!s.value||!s.value)break;const r=Object.assign({},e(k.value));k.value=Object.assign({},e(x.value)),x.value=r;const g=e(s.value);s.value=e(u.value),u.value=g,w.value={content:z.value,language:k.value?.language},await N(x.value,!0);break}}async function ae(){b.value=!0;const l=await Le({}),t=te(l);$.value=t,E.value=t,b.value=!1}function te(l){const t=g=>{g.length&&g.forEach(o=>{if(o.type===Ze.FOLDER)Object.assign(o,{key:o.path,label:o.title,disabled:!1,is_dir:!0,prefix:()=>Ue(o.title)}),!o.children.length||o.children.length===0?(Object.assign(o,{children:null}),o.prefix=()=>je()):t(o.children);else{const y=o.name;if(y){const F=y.substring(y.lastIndexOf(".")+1),_=Re[F]||{};Object.assign(o,{key:o.path,label:y,language:_.language||"plaintext",disabled:_.disabled||!1,is_dir:!1,prefix:()=>_.icon||He()})}}})};t(l);const r=g=>g.filter(o=>o.children?(o.children=r(o.children),!0):!o.disabled);return l=r(l),l}async function N(l,t=!1){I.value=!0;const r=await qe({path:encodeURIComponent(l.key)});r?t?z.value=r:w.value={content:r,language:l.language}:(t?z.value="":w.value={content:"",language:"plaintext"},U.info(f("page.code.fileContentIsEmptyMsg"))),I.value=!1}function j({option:l}){return{async onClick(){!l.children&&!l.disabled&&(k.value=l,await N(l,!1))}}}function R(l,t,r){["clear"].includes(r.action)&&(k.value=void 0)}function H({option:l}){return{async onClick(){!l.children&&!l.disabled&&(x.value=l,await N(l,!0))}}}function A(l,t,r){["clear"].includes(r.action)&&(x.value=void 0)}return Q(s,l=>{l||(w.value={content:"",language:"plaintext"})}),Q(u,l=>{l||(z.value="")}),ye(async()=>{await ae()}),be(()=>{c.value&&c.value.dispose()}),(l,t)=>{const r=Ee,g=Je,o=ze,y=$e,F=Me,_=Oe,q=Ie,B=Ve,W=Ne,Z=Qe,oe=Se,G=ge,K=Fe,le=ve,ie=we,se=me,O=Ce,re=_e,de=ke,ue=ce;return m(),h(ue,{"content-full":"","no-header":""},{default:a(()=>[n(de,{bordered:!e(p),style:{height:"100%","word-break":"unset"},segmented:{content:!0},"header-style":"padding: 10px; font-weight: unset","content-style":"padding: 0"},{header:a(()=>[e(p)?(m(),h(y,{key:1,vertical:"",style:{"padding-right":"8px"}},{default:a(()=>[n(r,{value:e(u),"onUpdate:value":[t[2]||(t[2]=i=>V(u)?u.value=i:null),A],size:"small",loading:e(b),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(f)("page.code.selectSourceFilePlaceholder"),options:e(E),"override-default-node-click-behavior":e(P),"node-props":H,"on-update:expanded-keys":e(T)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"]),n(r,{value:e(s),"onUpdate:value":[t[3]||(t[3]=i=>V(s)?s.value=i:null),R],size:"small",loading:e(b),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(f)("page.code.selectDestinationFilePlaceholder"),options:e($),"override-default-node-click-behavior":e(P),"node-props":j,"on-update:expanded-keys":e(T)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1})):(m(),h(y,{key:0},{default:a(()=>[n(r,{value:e(u),"onUpdate:value":[t[0]||(t[0]=i=>V(u)?u.value=i:null),A],size:"small",style:{"min-width":"260px",width:"fit-content"},"show-path":"",loading:e(b),"consistent-menu-width":!1,clearable:"",placeholder:e(f)("page.code.selectSourceFilePlaceholder"),options:e(E),"override-default-node-click-behavior":e(P),"node-props":H,"on-update:expanded-keys":e(T)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"]),n(o,{size:24,depth:3},{default:a(()=>[n(g,{style:{"vertical-align":"-0.25em"}})]),_:1}),n(r,{value:e(s),"onUpdate:value":[t[1]||(t[1]=i=>V(s)?s.value=i:null),R],size:"small",style:{"min-width":"260px",width:"fit-content"},"show-path":"",loading:e(b),"consistent-menu-width":!1,clearable:"",placeholder:e(f)("page.code.selectDestinationFilePlaceholder"),options:e($),"override-default-node-click-behavior":e(P),"node-props":j,"on-update:expanded-keys":e(T)},null,8,["value","loading","placeholder","options","override-default-node-click-behavior","on-update:expanded-keys"])]),_:1}))]),"header-extra":a(()=>[De(n(X,{name:"fade",mode:"out-in",appear:""},{default:a(()=>[e(p)?(m(),h(K,{key:1,vertical:""},{default:a(()=>[n(_,{strong:"",secondary:"",size:"small",style:{padding:"6px"},disabled:!e(s),loading:e(D),focusable:!1,onClick:t[8]||(t[8]=i=>v("save"))},{icon:a(()=>[n(G)]),_:1},8,["disabled","loading"]),n(e(Y),{editor:e(c),"diff-mode":""},{trigger:a(({show:i,toggleShow:M})=>[n(_,{strong:"",secondary:"",size:"small",type:i?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:M},{default:a(()=>[n(o,{size:"18"},{default:a(()=>[n(F)]),_:1})]),_:2},1032,["type","onClick"])]),_:1},8,["editor"])]),_:1})):(m(),h(K,{key:0},{default:a(()=>[n(e(Y),{editor:e(c),"diff-mode":""},{trigger:a(({show:i,toggleShow:M})=>[n(_,{strong:"",size:"small",quaternary:!i,tertiary:i,type:i?"primary":"default",style:{padding:"6px"},focusable:!1,onClick:M},{default:a(()=>[n(o,{size:"18"},{default:a(()=>[n(F)]),_:1})]),_:2},1032,["quaternary","tertiary","type","onClick"])]),_:1},8,["editor"]),n(oe,null,{default:a(()=>[n(B,{trigger:"hover",delay:500},{trigger:a(()=>[n(_,{secondary:"",type:"default",strong:"",size:"small",focusable:!1,onClick:t[4]||(t[4]=i=>v("prev"))},{icon:a(()=>[n(o,{size:20},{default:a(()=>[n(q)]),_:1})]),_:1})]),default:a(()=>[C("span",null,S(e(f)("editor.toolbox.previousDiff")),1)]),_:1}),n(B,{trigger:"hover",delay:500},{trigger:a(()=>[n(_,{secondary:"",type:"default",strong:"",size:"small",focusable:!1,onClick:t[5]||(t[5]=i=>v("next"))},{icon:a(()=>[n(o,{size:20},{default:a(()=>[n(W)]),_:1})]),_:1})]),default:a(()=>[C("span",null,S(e(f)("editor.toolbox.nextDiff")),1)]),_:1}),n(B,{trigger:"hover",delay:500},{trigger:a(()=>[n(_,{secondary:"",type:"default",strong:"",size:"small",focusable:!1,onClick:t[6]||(t[6]=i=>v("swapDiffSides"))},{icon:a(()=>[n(o,null,{default:a(()=>[n(Z)]),_:1})]),_:1})]),default:a(()=>[C("span",null,S(e(f)("page.code.swapDiffSides")),1)]),_:1})]),_:1}),n(_,{strong:"",type:"primary",size:"small",disabled:!e(s),loading:e(D),focusable:!1,onClick:t[7]||(t[7]=i=>v("save"))},{icon:a(()=>[n(G)]),default:a(()=>[Te(" "+S(e(f)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1}))]),_:1},512),[[Pe,e(s)&&e(u)]])]),default:a(()=>[n(X,{name:"fade",mode:"out-in",appear:"",style:{"border-bottom-left-radius":"6px","border-bottom-right-radius":"6px"}},{default:a(()=>[e(u)||e(s)?(m(),h(e(Be),{key:0,ref_key:"editorRef",ref:c,value:e(w),"original-value":e(z),"diff-mode":"","inline-view":!e(p),"font-size":e(ne)},null,8,["value","original-value","inline-view","font-size"])):(m(),h(ie,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(f)("common.selectFileEmptyDesc")},{icon:a(()=>[n(o,null,{default:a(()=>[n(le)]),_:1})]),_:1},8,["description"]))]),_:1}),e(p)&&e(u)&&e(s)?(m(),h(O,{key:0,right:20,bottom:76,style:{"z-index":"1000"},"menu-trigger":"click"},{menu:a(()=>[n(O,{onClick:t[9]||(t[9]=i=>v("prev"))},{default:a(()=>[n(o,{size:20},{default:a(()=>[n(q)]),_:1})]),_:1}),n(O,{onClick:t[10]||(t[10]=i=>v("next"))},{default:a(()=>[n(o,{size:20},{default:a(()=>[n(W)]),_:1})]),_:1}),n(O,{onClick:t[11]||(t[11]=i=>v("swapDiffSides"))},{default:a(()=>[n(o,null,{default:a(()=>[n(Z)]),_:1})]),_:1})]),default:a(()=>[n(o,null,{default:a(()=>[n(se)]),_:1})]),_:1})):xe("",!0),n(re,{show:e(I)},null,8,["show"])]),_:1},8,["bordered"])]),_:1})}}});export{bn as default};
