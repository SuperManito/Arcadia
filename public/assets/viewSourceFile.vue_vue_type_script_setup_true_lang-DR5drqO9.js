import{_ as ne}from"./swap-outlined-C6YFrvtc.js";import{a7 as s,aK as oe,av as i,I as te,r as le,K as se,u as n,a8 as a,a9 as e,aa as o,aL as _,b1 as V,aF as P,az as D,aG as H,aS as ae,cs as M,aT as ie,ap as re,b3 as ce,aE as pe,bc as _e,aU as ue,bJ as de,br as ge,an as fe,aM as me,bj as he,b9 as we,bE as ye,bF as ve}from"./vendor-CsvKI2kS.js";import{I as be}from"./Icon-w75mFLja.js";import{_ as xe,a as ke}from"./fullscreen-CDp7Z4mn.js";import{c as ze,a as Ce,e as Le,P as Se}from"./index-hO6mdrNR.js";import{u as $e}from"./useAppInject-BoZf51bk.js";import{c as Fe}from"./index-CYBHNIXZ.js";import{g as Ee}from"./file-h9mNNik_.js";import{f as Ne}from"./fileUnknown-BsScC3-k.js";const Be={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Ie=i("path",{fill:"currentColor",d:"M8 12h8v2H8zm2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4zm-2-2h4.1l.9-.9V16H8zm12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1l-2.1-2.1l1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"},null,-1),We=[Ie];function Te(U,z){return s(),oe("svg",Be,[...We])}const Ve={name:"mdi-file-document-edit-outline",render:Te},Pe=i("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},[i("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[i("g",{fill:"currentColor","fill-rule":"nonzero"},[i("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"})])])],-1),De={style:{"font-family":"var(--app-font-family-mono)"}},He={style:{"vertical-align":"-5px",padding:"0 2px"}},Je=te({__name:"viewSourceFile",setup(U,{expose:z}){const{message:j}=ze(),{t:p}=Ce(),{getIsMobile:A}=$e(),G=Le(),t=le({title:p("page.cron.table.source"),formatTitle:"",path:"",show:!1,loading:!0,code:"",language:"",icon:null,wordWrap:!0,showLineNumbers:!1,showFullScreen:!1}),{title:b,formatTitle:C,path:R,show:u,loading:f,code:y,language:L,icon:S,wordWrap:$,showLineNumbers:x,showFullScreen:v}=se(t),q=async r=>{t.showFullScreen=!1,t.title=r.scriptPath.split("/").pop(),t.formatTitle=t.title.replace(/\.(js|py|ts|sh)$/,""),t.path=r.scriptPath,t.code="",t.language="",t.loading=!0,t.show=!0;try{await K(r.scriptPath)}finally{t.code?t.loading=!1:j.warning(p("page.cron.viewSourceFile.noScriptMsg"))}},K=async r=>{const l=await Ee({path:r}),k=r.substring(r.lastIndexOf(".")+1),h=Fe[k]||{};t.code=l,t.language=h.language||"plaintext",t.icon=h.language?M(h.icon):M(Ne)},m=r=>{switch(r){case"goEdit":t.show=!1,G(`${Se.CODE_EDIT_PAGE}?path=${R.value}`);break;case"changeWrap":t.showLineNumbers=!t.showLineNumbers,t.wordWrap=!t.wordWrap;break;case"fullScreen":t.showFullScreen=!t.showFullScreen;break}};return z({open:q}),(r,l)=>{const k=xe,h=ke,d=ie,g=re,w=ce,O=pe,F=be,E=Ve,N=ne,B=_e,I=ue,W=de,T=ge,J=fe,Z=me,Q=he,X=we,Y=ye,ee=ve;return n(A)?(s(),a(ee,{key:1,show:n(u),"onUpdate:show":l[8]||(l[8]=c=>H(u)?u.value=c:null),height:"calc(var(--vh) * 100)",width:"100vw",placement:"bottom","auto-focus":!1,"mask-closable":!1},{default:e(()=>[o(Y,{"header-style":"height: 60px; padding: 16px 12px","body-content-style":`padding: ${n(x)?"4px 4px":"4px 8px"}; overscroll-behavior: none`,"footer-style":"padding: 16px 24px 24px 24px"},{header:e(()=>[o(I,{style:{gap:"4px"}},{default:e(()=>[n(f)?(s(),a(F,{key:0,icon:"svg-spinners:pulse-2",size:28,color:"var(--app-primary-color)",style:{"vertical-align":"0"}})):(s(),a(d,{key:1,size:28},{default:e(()=>[(s(),a(V(n(S))))]),_:1})),o(X,{style:{height:"100%","max-width":"190px"}},{tooltip:e(()=>[i("span",null,_(n(b)),1)]),default:e(()=>[i("span",He,_(n(C)||n(b)),1)]),_:1}),!n(f)&&n(y)?(s(),a(B,{key:2,style:{"padding-left":"8px"}},{default:e(()=>[o(w,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[5]||(l[5]=c=>m("goEdit"))},{icon:e(()=>[o(d,{size:16},{default:e(()=>[o(E,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[i("span",null,_(n(p)("page.cron.viewSourceFile.goEditBtn")),1)]),_:1}),o(w,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[6]||(l[6]=c=>m("changeWrap"))},{icon:e(()=>[o(d,{size:16},{default:e(()=>[o(N,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[i("span",null,_(n(p)("page.cron.viewSourceFile.wordWrapBtn")),1)]),_:1})]),_:1})):P("",!0)]),_:1})]),default:e(()=>[n(f)?(s(),a(W,{key:0,text:"",repeat:30,height:"16px"})):(s(),a(T,{key:1,code:n(y),language:n(L),"show-line-numbers":n(x),"word-wrap":n($),style:{"font-size":"13px",height:"100%"}},null,8,["code","language","show-line-numbers","word-wrap"]))]),footer:e(()=>[o(g,{block:"",strong:"",secondary:"",type:"primary",focusable:!1,onClick:l[7]||(l[7]=c=>u.value=!1)},{default:e(()=>[ae(_(n(p)("component.modal.close")),1)]),_:1})]),_:1},8,["body-content-style"])]),_:1},8,["show"])):(s(),a(Q,{key:0,show:n(u),"onUpdate:show":l[4]||(l[4]=c=>H(u)?u.value=c:null),preset:"dialog","auto-focus":!1,style:D({width:n(v)?"calc(-20px + 100vw)":"800px"})},{close:e(()=>[o(O,null,{default:e(()=>[o(w,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[o(g,{size:"tiny",quaternary:"",focusable:!1,style:{padding:"4px"},onClick:l[0]||(l[0]=c=>m("fullScreen"))},{icon:e(()=>[o(d,{size:20,depth:2},{default:e(()=>[n(v)?(s(),a(h,{key:1,style:{"vertical-align":"baseline"}})):(s(),a(k,{key:0,style:{"vertical-align":"baseline"}}))]),_:1})]),_:1})]),default:e(()=>[i("span",null,_(n(v)?n(p)("layout.header.tooltipExitFull"):n(p)("layout.header.tooltipEntryFull")),1)]),_:1}),o(g,{size:"tiny",quaternary:"",focusable:!1,style:{padding:"4px"},onClick:l[1]||(l[1]=c=>u.value=!1)},{icon:e(()=>[o(d,{size:18,depth:2},{default:e(()=>[Pe]),_:1})]),_:1})]),_:1})]),icon:e(()=>[n(f)?(s(),a(F,{key:0,icon:"svg-spinners:pulse-2",size:24,style:{"vertical-align":"0"}})):(s(),a(d,{key:1,size:24},{default:e(()=>[(s(),a(V(n(S))))]),_:1}))]),header:e(()=>[o(I,null,{default:e(()=>[i("span",De,_(n(C)||n(b)),1),!n(f)&&n(y)?(s(),a(B,{key:0},{default:e(()=>[o(w,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[2]||(l[2]=c=>m("goEdit"))},{icon:e(()=>[o(d,{size:16},{default:e(()=>[o(E,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[i("span",null,_(n(p)("page.cron.viewSourceFile.goEditBtn")),1)]),_:1}),o(w,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[3]||(l[3]=c=>m("changeWrap"))},{icon:e(()=>[o(d,{size:16},{default:e(()=>[o(N,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[i("span",null,_(n(p)("page.cron.viewSourceFile.wordWrapBtn")),1)]),_:1})]),_:1})):P("",!0)]),_:1})]),default:e(()=>[n(f)?(s(),a(W,{key:0,text:"",repeat:31,height:"18px"})):(s(),a(Z,{key:1,bordered:!1,style:{height:"100%","word-break":"unset"},"content-style":"height: 100%; padding: 1em 0 0 0; "},{default:e(()=>[o(J,{"x-scrollable":"",style:D({height:n(v)?"calc(-120px + 100vh)":"72vh"})},{default:e(()=>[o(T,{code:n(y),language:n(L),"show-line-numbers":n(x),"word-wrap":n($),style:{"font-size":"14px",height:"100%"}},null,8,["code","language","show-line-numbers","word-wrap"])]),_:1},8,["style"])]),_:1}))]),_:1},8,["show","style"]))}}});export{Je as _};
