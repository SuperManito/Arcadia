import{aN as C,a6 as s,aG as E,al as t,G as ne,r as le,J as oe,F as l,a7 as d,a8 as e,a9 as n,aH as u,b3 as T,aI as V,ap as W,aJ as A,aT as te,aU as ae,aA as se,b6 as ie,aL as re,aX as ce,cA as ue,ay as pe,aM as _e,bL as de,ba as ge,bc as fe,bF as me,bG as he}from"./vendor-c495fdf6.js";import{_ as ve,a as ye}from"./app-0713c32c.js";import{g as we,j as be,b as xe}from"./app-c86a1b95.js";import{u as ke}from"./app-25ce29fa.js";import{d as Ce,b as ze,h as Le,i as $e}from"./app-b60428ff.js";const Fe={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Se(F,i){return s(),E("svg",Fe,i[0]||(i[0]=[t("path",{fill:"currentColor",d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8M872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8"},null,-1)]))}const Be=C({name:"ant-design-swap-outlined",render:Se}),Ee={style:{display:"inline-block"},viewBox:"0 0 16 16",width:"1em",height:"1em"};function He(F,i){return s(),E("svg",Ee,i[0]||(i[0]=[t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"m5.75 8.25l-3 3l3 3m7.5-3H2.75m7.5-9.5l3 3l-3 3m-7.5-3h10.5"},null,-1)]))}const Ne=C({name:"charm-swap-horizontal",render:He}),Ie={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Me(F,i){return s(),E("svg",Ie,i[0]||(i[0]=[t("path",{fill:"currentColor",d:"M8 12h8v2H8zm2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4zm-2-2h4.1l.9-.9V16H8zm12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1l-2.1-2.1l1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"},null,-1)]))}const Te=C({name:"mdi-file-document-edit-outline",render:Me}),Ve={style:{"font-family":"var(--app-font-family-mono)"}},We={style:{"vertical-align":"-5px",padding:"0 2px"}},Ue=ne({__name:"viewSourceFile",setup(F,{expose:i}){const{message:D}=Ce(),{t:r}=ze(),{getIsMobile:G}=ke(),j=$e(),q=le({title:r("page.cron.table.source"),formatTitle:"",path:"",show:!1,code:"",language:"",icon:null,wordWrap:!0,showLineNumbers:!1,showFullScreen:!1}),{title:h,formatTitle:z,path:v,show:c,code:g,language:L,icon:S,wordWrap:$,showLineNumbers:w,showFullScreen:f}=oe(q);async function U(a){try{v.value=typeof a.config=="object"&&a.config.source_file?a.config.source_file:a.script_path}catch{}if(v.value){h.value=v.value.split("/").pop(),z.value=h.value.replace(/\.[^/.]+$/,"");try{await R(v.value)}finally{g.value?c.value=!0:D.warning(r("page.cron.viewSourceFile.noScriptMsg"))}}}async function R(a){const o=await we({path:a}),B=a.substring(a.lastIndexOf(".")+1),x=xe[B]||{};g.value=o,L.value=x.language||"plaintext",S.value=x.language?C(x.icon):C(be)}function b(a){switch(a){case"goEdit":c.value=!1,j(`${Le.CODE_EDIT_PAGE}?path=${v.value}`);break;case"changeWrap":w.value=!w.value,$.value=!$.value;break;case"fullScreen":f.value=!f.value;break}}async function y(){c.value=!1,f.value=!1,v.value="",g.value="",L.value="",setTimeout(()=>{h.value="",z.value=""},500)}return i({open:U}),(a,o)=>{const B=ve,x=ye,p=ae,m=se,k=ie,H=re,N=Te,J=Ne,I=ce,M=ue,O=pe,P=_e,X=de,Z=ge,K=Be,Q=fe,Y=me,ee=he;return l(G)?(s(),d(ee,{key:1,show:l(c),"onUpdate:show":o[6]||(o[6]=_=>A(c)?c.value=_:null),height:"calc(var(--vh) * 100)",width:"100vw",placement:"bottom","auto-focus":!1,"mask-closable":!1,onMaskClick:y,onAfterLeave:y},{default:e(()=>[n(Y,{"header-style":"height: 60px; padding: 16px 12px","body-content-style":`padding: ${l(w)?"4px 4px":"4px 8px"}; overscroll-behavior: none`,"footer-style":"padding: 16px 24px 24px 24px"},{header:e(()=>[n(I,{style:{gap:"4px"}},{default:e(()=>[n(p,{size:28},{default:e(()=>[(s(),d(T(l(S))))]),_:1}),n(Z,{style:{height:"100%","max-width":"190px"}},{tooltip:e(()=>[t("span",null,u(l(h)),1)]),default:e(()=>[t("span",We,u(l(z)||l(h)),1)]),_:1}),l(g)?(s(),d(Q,{key:0,style:{"padding-left":"8px"}},{default:e(()=>[n(k,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(m,{secondary:"",size:"small",focusable:!1,onClick:o[4]||(o[4]=_=>b("goEdit"))},{icon:e(()=>[n(p,{size:16},{default:e(()=>[n(N,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[t("span",null,u(l(r)("page.cron.viewSourceFile.goEditBtn")),1)]),_:1}),n(k,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(m,{secondary:"",size:"small",focusable:!1,onClick:o[5]||(o[5]=_=>b("changeWrap"))},{icon:e(()=>[n(p,{size:16},{default:e(()=>[n(K,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[t("span",null,u(l(r)("page.cron.viewSourceFile.wordWrapBtn")),1)]),_:1})]),_:1})):V("",!0)]),_:1})]),default:e(()=>[n(M,{code:l(g),language:l(L),"show-line-numbers":l(w),"word-wrap":l($),style:{"font-size":"13px",height:"100%"}},null,8,["code","language","show-line-numbers","word-wrap"])]),footer:e(()=>[n(m,{block:"",strong:"",secondary:"",type:"primary",focusable:!1,onClick:y},{default:e(()=>[te(u(l(r)("component.modal.close")),1)]),_:1})]),_:1},8,["body-content-style"])]),_:1},8,["show"])):(s(),d(X,{key:0,show:l(c),"onUpdate:show":o[3]||(o[3]=_=>A(c)?c.value=_:null),preset:"dialog","auto-focus":!1,style:W({width:l(f)?"calc(-20px + 100vw)":"800px"}),"on-close":y,"on-mask-click":y},{close:e(()=>[n(H,null,{default:e(()=>[n(k,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(m,{size:"tiny",quaternary:"",focusable:!1,style:{padding:"4px"},onClick:o[0]||(o[0]=_=>b("fullScreen"))},{icon:e(()=>[n(p,{size:20,depth:2},{default:e(()=>[l(f)?(s(),d(x,{key:1,style:{"vertical-align":"baseline"}})):(s(),d(B,{key:0,style:{"vertical-align":"baseline"}}))]),_:1})]),_:1})]),default:e(()=>[t("span",null,u(l(f)?l(r)("layout.header.tooltipExitFull"):l(r)("layout.header.tooltipEntryFull")),1)]),_:1}),n(m,{size:"tiny",quaternary:"",focusable:!1,style:{padding:"4px"},onClick:y},{icon:e(()=>[n(p,{size:18,depth:2},{default:e(()=>o[7]||(o[7]=[t("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},[t("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[t("g",{fill:"currentColor","fill-rule":"nonzero"},[t("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"})])])],-1)])),_:1})]),_:1})]),_:1})]),icon:e(()=>[n(p,{size:26},{default:e(()=>[(s(),d(T(l(S)),{style:{"vertical-align":"-0.1em"}}))]),_:1})]),header:e(()=>[n(I,null,{default:e(()=>[t("span",Ve,u(l(z)||l(h)),1),l(g)?(s(),d(H,{key:0,style:{gap:"0"}},{default:e(()=>[n(k,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(m,{quaternary:"",size:"small",focusable:!1,style:{padding:"6px"},onClick:o[1]||(o[1]=_=>b("goEdit"))},{icon:e(()=>[n(p,{size:16},{default:e(()=>[n(N,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[t("span",null,u(l(r)("page.cron.viewSourceFile.goEditBtn")),1)]),_:1}),n(k,{"show-arrow":!1,trigger:"hover",delay:500},{trigger:e(()=>[n(m,{quaternary:"",size:"small",focusable:!1,style:{padding:"6px"},onClick:o[2]||(o[2]=_=>b("changeWrap"))},{icon:e(()=>[n(p,{size:16},{default:e(()=>[n(J,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[t("span",null,u(l(r)("page.cron.viewSourceFile.wordWrapBtn")),1)]),_:1})]),_:1})):V("",!0)]),_:1})]),default:e(()=>[n(P,{bordered:!1,style:{height:"100%","word-break":"unset"},"content-style":"height: 100%; padding: 1em 0 0 0; "},{default:e(()=>[n(O,{"x-scrollable":"",style:W({height:l(f)?"calc(-120px + 100vh)":"72vh"})},{default:e(()=>[n(M,{code:l(g),language:l(L),"show-line-numbers":l(w),"word-wrap":l($),style:{"font-size":"14px",height:"100%"}},null,8,["code","language","show-line-numbers","word-wrap"])]),_:1},8,["style"])]),_:1})]),_:1},8,["show","style"]))}}});export{Ue as _};
