import{az as D,aq as S,T as c,a5 as f,G as je,bk as Ke,bl as We,A as u,ad as n,aw as r,b7 as R,r as Ge,J as Je,b9 as ue,b8 as de,bm as Qe,W as s,V as o,S as m,ar as G,bu as Xe,ax as Ye,F as t,at as $,a6 as Ze,aN as T,as as g,a3 as et,a4 as tt,ab as pe,av as be,b2 as at,ak as I,aL as lt,bc as nt,b0 as ot,bd as fe,aQ as st,b6 as it,aX as rt,bt as ct,bA as ut,bv as dt,aG as pt,ag as bt,aW as ft}from"./vendor-ca0e89fa.js";import{I as vt,B as mt,a as ve,b as J,e as gt,f as yt,g as _t,_ as ht,h as kt}from"./app-e679d563.js";import{b as U,l as me,m as xt}from"./app-35107225.js";import{I as wt}from"./app-5d8356b8.js";import{a as F}from"./app-a04700e8.js";import{_ as Ct}from"./app-15ced056.js";import{_ as Tt}from"./app-a8b9750a.js";import{a as ge,b as ye,e as _e,h as St}from"./app-7cf80934.js";import{u as It}from"./app-40fcbbd5.js";import{d as Mt,b as $t,e as qt}from"./app-dbd4b5f0.js";import{u as zt}from"./app-29b727ba.js";import{u as Bt}from"./app-8b99cbcc.js";const At={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ot(q,d){return c(),S("svg",At,d[0]||(d[0]=[f("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[f("path",{d:"M4.675 4.68C2.505 9.456 2.613 14.272 5 20M19 4c1.959 3.917 2.383 7.834 1.272 12.232m-.983 3.051q-.14.357-.289.717m-7.304-8.304q.141.385.32.831C13 15 13 16 14 16h1"}),f("path",{d:"M8 16c1.5 0 3-2 4-3.5m2.022-2.514C14.651 9.404 15.326 9 16 9M3 3l18 18"})],-1)]))}const P=D({name:"tabler-variable-off",render:Ot}),Rt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Dt(q,d){return c(),S("svg",Rt,d[0]||(d[0]=[f("path",{fill:"currentColor",d:"m20.68 9.27l.01-.06A.96.96 0 0 0 19.76 8H17l.7-2.79A.972.972 0 0 0 16.76 4c-.45 0-.83.3-.94.73L15 8h-4l.7-2.79A.972.972 0 0 0 10.76 4c-.45 0-.83.3-.94.73L9 8H5.76c-.45 0-.84.3-.94.73l-.02.06c-.15.62.31 1.21.94 1.21H8.5l-1 4H4.26c-.45 0-.83.3-.94.73l-.02.06c-.15.62.31 1.21.94 1.21H7l-.7 2.79c-.15.62.31 1.21.94 1.21c.45 0 .83-.3.94-.73L9 16h4l-.7 2.79c-.15.62.31 1.21.94 1.21c.45 0 .83-.3.94-.73L15 16h3.24c.45 0 .83-.3.94-.73l.01-.06a.976.976 0 0 0-.94-1.21H15.5l1-4h3.24c.45 0 .84-.3.94-.73M13.5 14h-4l1-4h4z"},null,-1)]))}const he=D({name:"ic-round-numbers",render:Dt}),Nt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Vt(q,d){return c(),S("svg",Nt,d[0]||(d[0]=[f("path",{fill:"currentColor",d:"m7.825 13l4.9 4.9q.3.3.288.7t-.313.7q-.3.275-.7.288t-.7-.288l-6.6-6.6q-.15-.15-.213-.325T4.426 12t.063-.375t.212-.325l6.6-6.6q.275-.275.688-.275t.712.275q.3.3.3.713t-.3.712L7.825 11H19q.425 0 .713.288T20 12t-.288.713T19 13z"},null,-1)]))}const Lt=D({name:"material-symbols-arrow-back-rounded",render:Vt}),Et={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ut(q,d){return c(),S("svg",Et,d[0]||(d[0]=[f("path",{fill:"currentColor",d:"m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z"},null,-1)]))}const Ft=D({name:"material-symbols-chevron-left-rounded",render:Ut}),Pt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"};function Ht(q,d){return c(),S("svg",Pt,d[0]||(d[0]=[f("path",{fill:"currentColor",d:"M4 5q-.425 0-.712-.288T3 4t.288-.712T4 3h16q.425 0 .713.288T21 4t-.288.713T20 5zm7.3 11.3l-2.6-2.6q-.275-.275-.287-.687T8.7 12.3q.275-.275.7-.275t.7.275l.9.875V8q0-.425.288-.712T12 7t.713.288T13 8v5.175l.9-.9q.275-.275.688-.275t.712.3q.275.275.275.7t-.275.7l-2.6 2.6q-.3.3-.7.3t-.7-.3M4 21q-.425 0-.712-.288T3 20t.288-.712T4 19h16q.425 0 .713.288T21 20t-.288.713T20 21z"},null,-1)]))}const jt=D({name:"material-symbols-text-select-move-down-rounded",render:Ht}),Kt={key:1,style:{"text-align":"center","font-weight":"600"}},Wt={style:{"vertical-align":"-5px",padding:"0 2px"}},Gt={style:{"text-align":"center","font-weight":"600"}},Jt={key:3},Qt={class:"table-toolbar-right-icon"},Xt={style:{color:"var(--app-primary-color)"}},Yt=je({__name:"manageValue",emits:["ok"],setup(q,{expose:d,emit:ke}){const xe=ke,{getIsMobile:p}=It(),{getLocale:Q}=Bt(),we=Q.value==="zh_CN"?Ke:We,{message:v,confirm:H}=Mt(),{t:l}=$t(),X=u("fade-slide");zt(X);const j=u(),Y=u(),Z=u(),ee=u([]),k=u([]),te=u(!1),z=u(!1),y=u(""),ae=u(),N=u([]),V=u("sort"),x=u("0"),B=u(!1),w=u(null),L=u(null),le={padding:"2px",borderRadius:"3px",lineHeight:"1",color:"var(--app-foreground-color)",background:"var(--app-primary-color)"},Ce=u([{label:()=>n(R,{style:{color:"var(--app-info-color)"}},{default:()=>l("page.env.table.action.enable.button")}),key:"enable",icon:()=>n(r,{color:"var(--app-info-color)"},{default:()=>n(F)}),props:{onClick:()=>{re(!0)}}},{label:l("page.env.table.action.disable.button"),key:"disable",icon:()=>n(r,null,{default:()=>n(P)}),props:{onClick:()=>{re(!1)}}},{label:()=>n(R,{style:{color:"var(--app-error-color)"}},{default:()=>l("page.env.table.action.delete.button")}),key:"delete",icon:()=>U({color:"var(--app-error-color)"}),props:{onClick:()=>{ze()}}}]),_=Ge({title:"",show:!1,model:{}}),{show:E,title:K}=Je(_),Te=[{type:"selection",key:"selection",width:46},{title:l("page.env.table.title.sort"),key:"sort",align:"center",titleAlign:"center",width:88,sorter:!0,defaultSortOrder:!1,render(e){return n(ue,{size:"small",bordered:!1,style:"font-weight: 600"},{default:()=>e.sort})}},{title:l("page.env.table.title.value"),key:"value",resizable:!0,render(e){return n(de,{patterns:N.value,highlightStyle:le,text:e.value,style:{fontFamily:"var(--app-font-family-mono)"}})}},{title:l("page.env.table.title.remark"),key:"remark",resizable:!0,width:200,render(e){return n(de,{patterns:N.value,highlightStyle:le,text:e.remark})}},{title:l("page.env.table.title.update_time"),key:"update_time",align:"center",width:170,render(e){return e.update_time?Date.now()-new Date(e.update_time).getTime()<1e3*60*60?Qe(new Date(e.update_time),{addSuffix:!0,locale:we}):e.update_time:l("page.env.table.update_time.never")},sorter:!0,defaultSortOrder:!1},{title:l("page.env.table.title.enable"),key:"enable",align:"center",width:120,fixed:p.value?void 0:"right",renderFilterIcon:()=>n(r,null,{default:()=>n(vt)}),render(e){return n(ue,{type:e.enable===1?"success":"error",bordered:!1,style:Q.value==="zh_CN"?"":"width: 66px; line-height: 28px; display: block; text-align: center"},{default:()=>e.enable===1?l("common.active"):l("common.inactive")})},defaultFilterOptionValues:[],filterOptions:[{label:l("common.active"),value:1},{label:l("common.inactive"),value:0}],filter(){}}];function ne(e,a){switch(e){case"edit":return{icon:n(r,{size:20},{default:()=>n(me)}),tooltip:l("page.env.table.action.edit"),quaternary:!0,focusable:!1,onClick:oe.bind(null,a)};case"changeStatus":return{icon:n(r,{size:20},{default:()=>n(a.enable===1?P:F)}),tooltip:a.enable===1?l("page.env.table.action.disable.button"):l("page.env.table.action.enable.button"),quaternary:!0,focusable:!1,onClick:se.bind(null,a)}}}const Se={title:l("page.env.table.title.action"),key:"action",titleAlign:p.value?"center":"left",width:p.value?68:140,fixed:"right",render(e){const a={edit:{label:l("page.env.table.action.edit"),key:"edit",icon:()=>n(r,{size:20},{default:()=>n(me)}),props:{onClick:oe.bind(null,e)}},delete:{label:()=>n(R,{style:{color:"var(--app-error-color)"}},{default:()=>l("page.env.table.action.delete.button")}),key:"delete",icon:()=>U({color:"var(--app-error-color)"}),props:{onClick:Ie.bind(null,e)}},changeStatus:{label:e.enable===1?l("page.env.table.action.disable.button"):l("page.env.table.action.enable.button"),key:"changeStatus",icon:()=>n(r,null,{default:()=>n(e.enable===1?P:F)}),props:{onClick:se.bind(null,e)}},sort:{label:l("page.env.table.action.sort.title"),key:"sort",icon:()=>n(r,null,{default:()=>n(kt)}),children:[{label:l("page.env.table.action.sort.moveUp"),key:"sortMoveUp",icon:()=>n(r,null,{default:()=>n(gt)}),props:{onClick:A.bind(null,e,"up")}},{label:l("page.env.table.action.sort.moveDown"),key:"sortMoveDown",icon:()=>n(r,null,{default:()=>n(yt)}),props:{onClick:A.bind(null,e,"down")}},{label:l("page.env.table.action.sort.moveTop"),key:"sortMoveTop",icon:()=>n(r,null,{default:()=>n(_t)}),props:{onClick:A.bind(null,e,"top")}},{label:l("page.env.table.action.sort.moveBottom"),key:"sortMoveBottom",icon:()=>n(r,null,{default:()=>n(jt)}),props:{onClick:A.bind(null,e,"bottom")}},{label:l("page.env.table.action.sort.moveSpecify"),key:"sortMoveSpecify",icon:()=>n(r,null,{default:()=>n(he)}),props:{onClick:A.bind(null,e,"specify")}}]},export:{label:l("page.env.table.action.export"),key:"export",icon:()=>n(r,{size:"16"},{default:()=>n(xt)}),props:{onClick:Me.bind(null,e)}}};let b;return p.value?b={style:"button",actions:[],dropDownActions:[a.edit,a.changeStatus,a.export,a.sort,a.delete]}:b={style:"button",actions:[ne("edit",e),ne("changeStatus",e)],dropDownActions:[a.export,a.sort,a.delete]},n(ht,b)}};async function oe(e){j.value?.open("composite_value",e)}function Ie(e){H.error({title:l("page.env.table.action.delete.title"),content:l("page.env.table.action.delete.confirm"),icon:()=>U(),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:l("page.env.table.action.delete.button"),onPositiveClick:async()=>{try{await ge({id:e.id}),v.success(l("page.env.table.message.delete.ok"))}catch{v.error(l("page.env.table.message.delete.fail"))}finally{h()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}async function se(e){try{const a={id:e.id,enable:e.enable===0?1:0};await ye(a),v.success(e.enable===1?l("page.env.table.message.disable.ok"):l("page.env.table.message.enable.ok"),{duration:1500}),e.enable=e.enable===0?1:0}catch{v.error(e.enable===1?l("page.env.table.message.disable.fail"):l("page.env.table.message.enable.fail"))}}async function A(e,a){const{id:b,sort:O}=e;try{let C;switch(a){case"up":C={id:b,order:O+(x.value==="0"?-1:1)};break;case"down":C={id:b,order:O+(x.value==="0"?1:-1)};break;case"top":C=Object.assign({id:b},x.value==="0"?{order:1}:{moveToEnd:!0});break;case"bottom":C=Object.assign({id:b},x.value==="0"?{moveToEnd:!0}:{order:1});break;case"specify":B.value=!0,L.value=b,w.value=O;return;default:return}await _e(C),v.success(l("page.env.table.message.sort.ok")),h()}catch{}}async function Me(e){v.info(`export ${_.title}="${e.value}"`,{keepAliveOnHover:!0,duration:3e3})}function $e(){return n(r,null,{default:()=>n(he)})}async function qe(){try{await _e({id:L.value,order:w.value}),v.success(l("page.env.table.message.sort.ok")),h()}catch{}finally{L.value=null,w.value=null}}function ie(){B.value=!1,w.value=null,L.value=null}function ze(){H.error({title:l("page.env.table.action.delete.batchTitle"),content:l("page.env.table.action.delete.batchConfirm"),icon:()=>U({size:24}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{const e=k.value.map(a=>Number(a));await ge({id:e}),v.success(l("page.env.table.message.delete.ok"))}catch{v.error(l("page.env.table.message.delete.fail"))}finally{h()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function re(e){H.info({title:l(`page.env.table.action.${e?"enable":"disable"}.batchTitle`),content:l(`page.env.table.action.${e?"enable":"disable"}.batchConfirm`),icon:()=>n(r,{size:24},{default:()=>n(e?F:P)}),closable:!1,maskClosable:!1,autoFocus:!1,onPositiveClick:async()=>{try{await ye({id:k.value.map(a=>Number(a)),enable:e?1:0}),v.success(l(`page.env.table.message.${e?"enable":"disable"}.ok`))}catch{v.error(l(`page.env.table.message.${e?"enable":"disable"}.fail`))}finally{h()}},negativeButtonProps:{ghost:!1,tertiary:!0}})}function h(){setTimeout(()=>{Z.value?.reload()},250),k.value=[]}function W(){z.value=!0,h(),z.value=!1}function ce(){y.value="",N.value=[],h()}function Be(e){ee.value=e.enable}async function Ae(e){switch(e.order){case"ascend":V.value=e.columnKey,x.value="0";break;case"descend":V.value=e.columnKey,x.value="1";break;case!1:V.value="sort",x.value="0";break}h()}async function Oe(e){const a={page:e.page,size:e.size,group_id:_.model.id,search:y.value||"",enable:ee.value.join(","),orderBy:V.value,order:x.value},b=await St(a);return y.value&&(N.value=[String(y.value)]),b}function Re(e={}){const a={id:null,type:"",description:"",tag_list:"",enable:1,separator:"",envs:0};_.model=bt(a),Object.assign(_.model,e),_.title=_.model.type||"未知变量名",_.show=!0}async function M(e){switch(e){case"createValue":j.value?.open("composite_value",null,_.model.id);break;case"importEnv":Y.value?.open(_.model.id);break;case"backEnvTable":E.value=!1,xe("ok");break;case"showSearchBar":te.value=!0,ft().then(()=>{ae.value?.focus()});break}}return d({open:Re}),(e,a)=>{const b=it,O=st,C=ot,De=nt,Ne=lt,Ve=at,Le=Ye,Ee=Xe,Ue=rt,Fe=ct,Pe=ut,He=dt;return c(),S(pt,null,[s(Fe,{show:t(E),"onUpdate:show":a[9]||(a[9]=i=>$(E)?E.value=i:null),height:"calc(var(--vh) * 100)",width:"100%",placement:"right",to:"#env-table-drawer-target","trap-focus":!1,"block-scroll":!1,"auto-focus":!1,"mask-closable":!1},{default:o(()=>[s(Ee,{closable:!1,"header-style":"display: none","body-content-style":"padding: 0"},{header:o(()=>a[14]||(a[14]=[])),default:o(()=>[s(Le,{bordered:!1,style:{height:"100%","background-color":"var(--app-background)"},"header-style":{padding:t(p)?"0 10px":"20px 24px 20px 24px"},"content-style":{height:"100%",padding:t(p)?"10px":"0 24px 20px 24px"}},{header:o(()=>[s(O,{style:{"align-items":"center"}},{default:o(()=>[t(p)?G("",!0):(c(),m(t(I),{key:0,strong:"",secondary:"",focusable:!1,style:{padding:"0 8px"},onClick:a[0]||(a[0]=i=>M("backEnvTable"))},{icon:o(()=>[s(t(r),{size:28},{default:o(()=>[s(t(Ft))]),_:1})]),_:1})),t(p)?(c(),m(b,{key:2,style:{height:"100%","max-width":"190px"}},{tooltip:o(()=>[f("span",Gt,g(t(K)),1)]),default:o(()=>[f("span",Wt,g(t(K)),1)]),_:1})):(c(),S("span",Kt,g(t(K)),1))]),_:1})]),default:o(()=>[s(t(mt),{ref_key:"tableRef",ref:Z,"checked-row-keys":t(k),"onUpdate:checkedRowKeys":a[7]||(a[7]=i=>$(k)?k.value=i:null),class:"env-sub-table","table-id":"ENV_SUB","pagination-behavior-on-filter":"first",columns:Te,request:Oe,"row-key":i=>`${i.id}`,"action-column":Se,"onUpdate:filters":Be,"onUpdate:sorter":Ae},Ze({tableTitle:o(()=>[s(t(be),{wrap:!1},{default:o(()=>[t(p)?(c(),m(t(I),{key:1,secondary:"",type:"primary",size:"small",style:{padding:"0 5px"},focusable:!1,onClick:a[2]||(a[2]=i=>M("createValue"))},{icon:o(()=>[s(t(wt))]),_:1})):(c(),m(t(I),{key:0,type:"primary",focusable:!1,onClick:a[1]||(a[1]=i=>M("createValue"))},{default:o(()=>[T(g(t(l)("page.env.table.newValue")),1)]),_:1})),t(p)?G("",!0):(c(),m(t(I),{key:2,secondary:"",focusable:!1,onClick:a[3]||(a[3]=i=>M("importEnv"))},{default:o(()=>[T(g(t(l)("page.env.table.batchImport")),1)]),_:1})),t(p)?(c(),m(C,{key:4,value:t(y),"onUpdate:value":a[6]||(a[6]=i=>$(y)?y.value=i:null),loading:t(z)||void 0,size:"small",clearable:"",placeholder:t(l)("page.env.table.search.placeholder"),"on-clear":ce,onKeyup:fe(W,["enter"])},{prefix:o(()=>[s(t(J))]),_:1},8,["value","loading","placeholder"])):(c(),S("div",Jt,[t(te)?(c(),m(pe,{key:1,name:t(X),mode:"default",appear:""},{default:o(()=>[s(De,null,{default:o(()=>[s(C,{ref_key:"searchBarInputRef",ref:ae,value:t(y),"onUpdate:value":a[5]||(a[5]=i=>$(y)?y.value=i:null),disabled:t(z),loading:t(z)||void 0,clearable:"",placeholder:t(l)("page.env.table.search.placeholder"),"on-clear":ce,onKeyup:fe(W,["enter"])},{prefix:o(()=>[s(t(J))]),_:1},8,["value","disabled","loading","placeholder"]),s(t(I),{strong:"",secondary:"",type:"primary",onClick:W},{default:o(()=>[T(g(t(l)("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["name"])):(c(),m(t(I),{key:0,strong:"",secondary:"",style:{padding:"0 8px"},focusable:!1,onClick:a[4]||(a[4]=i=>M("showSearchBar"))},{icon:o(()=>[s(t(J))]),_:1}))]))]),_:1})]),toolbar:o(()=>[et(s(pe,{name:"fade-slide-left",mode:"out-in",appear:""},{default:o(()=>[s(t(be),{wrap:!1},{default:o(()=>[s(Ve,{size:"small",trigger:"click",options:t(Ce)},{default:o(()=>[t(p)?(c(),m(Ne,{key:1,trigger:"hover"},{trigger:o(()=>[f("div",Qt,[s(t(r),{size:20},{default:o(()=>[s(t(ve))]),_:1})])]),default:o(()=>[f("span",null,g(t(l)("page.env.table.action.batchAction")),1)]),_:1})):(c(),m(t(I),{key:0,strong:"",secondary:"",size:"small",type:"primary",style:{padding:"0 8px"},focusable:!1},{icon:o(()=>[s(t(ve))]),default:o(()=>[T(" "+g(t(l)("page.env.table.action.batchAction")),1)]),_:1}))]),_:1},8,["options"])]),_:1})]),_:1},512),[[tt,t(k).length]])]),_:2},[t(k).length&&!t(p)?{name:"info",fn:o(()=>[s(t(R),null,{default:o(()=>[T(g(t(l)("common.selected")),1)]),_:1}),a[15]||(a[15]=T("  ")),f("span",Xt,g(t(k).length),1),a[16]||(a[16]=T("  ")),s(t(R),null,{default:o(()=>[T(g(t(l)("common.item")),1)]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","row-key"])]),_:1},8,["header-style","content-style"])]),_:1}),t(p)?(c(),m(Ue,{key:0,left:20,bottom:20,onClick:a[8]||(a[8]=i=>M("backEnvTable"))},{default:o(()=>[s(t(r),null,{default:o(()=>[s(t(Lt))]),_:1})]),_:1})):G("",!0)]),_:1},8,["show"]),s(He,{show:t(B),"onUpdate:show":a[11]||(a[11]=i=>$(B)?B.value=i:null),preset:"dialog",style:{width:"360px"},"auto-focus":!1,"mask-closable":!1,icon:$e,title:t(l)("page.env.table.action.sort.moveSpecifyTitle"),"positive-text":t(l)("common.okText"),"negative-text":t(l)("common.cancelText"),"on-close":ie,"positive-button-props":{disabled:!t(w)},"negative-button-props":{ghost:!1,tertiary:!0},onNegativeClick:a[12]||(a[12]=i=>ie()),onPositiveClick:a[13]||(a[13]=i=>qe())},{default:o(()=>[s(Pe,{value:t(w),"onUpdate:value":a[10]||(a[10]=i=>$(w)?w.value=i:null),clearable:"",min:1,max:99999,style:{"margin-top":"5px"}},null,8,["value"])]),_:1},8,["show","title","positive-text","negative-text","positive-button-props"]),s(Ct,{ref_key:"editEnv",ref:j,onOk:h},null,512),s(Tt,{ref_key:"importEnv",ref:Y,onOk:h},null,512)],64)}}}),Zt=qt(Yt,[["__scopeId","data-v-f8c10bd8"]]),pa=Object.freeze(Object.defineProperty({__proto__:null,default:Zt},Symbol.toStringTag,{value:"Module"}));export{P as I,Zt as M,pa as m};
